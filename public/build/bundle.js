!function(g){function t(n){if(I[n])return I[n].exports;var C=I[n]={i:n,l:!1,exports:{}};return g[n].call(C.exports,C,C.exports,t),C.l=!0,C.exports}var I={};t.m=g,t.c=I,t.d=function(g,I,n){t.o(g,I)||Object.defineProperty(g,I,{configurable:!1,enumerable:!0,get:n})},t.n=function(g){var I=g&&g.__esModule?function(){return g.default}:function(){return g};return t.d(I,"a",I),I},t.o=function(g,t){return Object.prototype.hasOwnProperty.call(g,t)},t.p="",t(t.s=0)}([function(g,t,I){g.exports=I(1)},function(module,exports,__webpack_require__){"use strict";eval("\n\n__webpack_require__(2);\n\n__webpack_require__(3);\n\n__webpack_require__(4);\n\n__webpack_require__(5);\n\nconsole.log('im wide awake - its morning');\n\n//THIS WONT RELOAD THE PAGE - GOTTA USE THE get method override hack for that\n// $(document).ready(function () {\n\n//     $( '.search' ).on( 'click', function( e ){\n//         e.preventDefault();\n\n//         let tempQuery = $('.query').val()\n\n//         $.post({\n//             url: '/search',\n//             data: { query: tempQuery }\n//         });\n//     })\n// })\n\nif (false) {\n    module.hot.accept();\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3ByaXZhdGUvanMvbWFpbi5qcz9mNjJjIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxucmVxdWlyZSgnLi4vc2Fzcy9zdHlsZS5zYXNzJyk7XG5cbnJlcXVpcmUoJy4uLy4uL25vZGVfbW9kdWxlcy9ob2xkZXJqcy9ob2xkZXIuanMnKTtcblxucmVxdWlyZSgnLi9zZWFyY2guanMnKTtcblxucmVxdWlyZSgnLi9kYXNoYm9hcmQuanMnKTtcblxuY29uc29sZS5sb2coJ2ltIHdpZGUgYXdha2UgLSBpdHMgbW9ybmluZycpO1xuXG4vL1RISVMgV09OVCBSRUxPQUQgVEhFIFBBR0UgLSBHT1RUQSBVU0UgVEhFIGdldCBtZXRob2Qgb3ZlcnJpZGUgaGFjayBmb3IgdGhhdFxuLy8gJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xuXG4vLyAgICAgJCggJy5zZWFyY2gnICkub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICl7XG4vLyAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuLy8gICAgICAgICBsZXQgdGVtcFF1ZXJ5ID0gJCgnLnF1ZXJ5JykudmFsKClcblxuLy8gICAgICAgICAkLnBvc3Qoe1xuLy8gICAgICAgICAgICAgdXJsOiAnL3NlYXJjaCcsXG4vLyAgICAgICAgICAgICBkYXRhOiB7IHF1ZXJ5OiB0ZW1wUXVlcnkgfVxuLy8gICAgICAgICB9KTtcbi8vICAgICB9KVxuLy8gfSlcblxuaWYgKG1vZHVsZS5ob3QpIHtcbiAgICBtb2R1bGUuaG90LmFjY2VwdCgpO1xufVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vcHJpdmF0ZS9qcy9tYWluLmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///1\n")},function(module,exports){eval("// removed by extract-text-webpack-plugin//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3ByaXZhdGUvc2Fzcy9zdHlsZS5zYXNzP2I3YzQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcmVtb3ZlZCBieSBleHRyYWN0LXRleHQtd2VicGFjay1wbHVnaW5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3ByaXZhdGUvc2Fzcy9zdHlsZS5zYXNzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///2\n")},function(module,exports,__webpack_require__){eval("/*!\n\nHolder - client side image placeholders\nVersion 2.9.4+cabil\nÂ© 2016 Ivan Malopinsky - http://imsky.co\n\nSite:     http://holderjs.com\nIssues:   https://github.com/imsky/holder/issues\nLicense:  MIT\n\n*/\n(function (window) {\n  if (!window.document) return;\n  var document = window.document;\n\n  //https://github.com/inexorabletash/polyfill/blob/master/web.js\n    if (!document.querySelectorAll) {\n      document.querySelectorAll = function (selectors) {\n        var style = document.createElement('style'), elements = [], element;\n        document.documentElement.firstChild.appendChild(style);\n        document._qsa = [];\n\n        style.styleSheet.cssText = selectors + '{x-qsa:expression(document._qsa && document._qsa.push(this))}';\n        window.scrollBy(0, 0);\n        style.parentNode.removeChild(style);\n\n        while (document._qsa.length) {\n          element = document._qsa.shift();\n          element.style.removeAttribute('x-qsa');\n          elements.push(element);\n        }\n        document._qsa = null;\n        return elements;\n      };\n    }\n\n    if (!document.querySelector) {\n      document.querySelector = function (selectors) {\n        var elements = document.querySelectorAll(selectors);\n        return (elements.length) ? elements[0] : null;\n      };\n    }\n\n    if (!document.getElementsByClassName) {\n      document.getElementsByClassName = function (classNames) {\n        classNames = String(classNames).replace(/^|\\s+/g, '.');\n        return document.querySelectorAll(classNames);\n      };\n    }\n\n  //https://github.com/inexorabletash/polyfill\n  // ES5 15.2.3.14 Object.keys ( O )\n  // https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys\n  if (!Object.keys) {\n    Object.keys = function (o) {\n      if (o !== Object(o)) { throw TypeError('Object.keys called on non-object'); }\n      var ret = [], p;\n      for (p in o) {\n        if (Object.prototype.hasOwnProperty.call(o, p)) {\n          ret.push(p);\n        }\n      }\n      return ret;\n    };\n  }\n\n  // ES5 15.4.4.18 Array.prototype.forEach ( callbackfn [ , thisArg ] )\n  // From https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach\n  if (!Array.prototype.forEach) {\n    Array.prototype.forEach = function (fun /*, thisp */) {\n      if (this === void 0 || this === null) { throw TypeError(); }\n\n      var t = Object(this);\n      var len = t.length >>> 0;\n      if (typeof fun !== \"function\") { throw TypeError(); }\n\n      var thisp = arguments[1], i;\n      for (i = 0; i < len; i++) {\n        if (i in t) {\n          fun.call(thisp, t[i], i, t);\n        }\n      }\n    };\n  }\n\n  //https://github.com/inexorabletash/polyfill/blob/master/web.js\n  (function (global) {\n    var B64_ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n    global.atob = global.atob || function (input) {\n      input = String(input);\n      var position = 0,\n          output = [],\n          buffer = 0, bits = 0, n;\n\n      input = input.replace(/\\s/g, '');\n      if ((input.length % 4) === 0) { input = input.replace(/=+$/, ''); }\n      if ((input.length % 4) === 1) { throw Error('InvalidCharacterError'); }\n      if (/[^+/0-9A-Za-z]/.test(input)) { throw Error('InvalidCharacterError'); }\n\n      while (position < input.length) {\n        n = B64_ALPHABET.indexOf(input.charAt(position));\n        buffer = (buffer << 6) | n;\n        bits += 6;\n\n        if (bits === 24) {\n          output.push(String.fromCharCode((buffer >> 16) & 0xFF));\n          output.push(String.fromCharCode((buffer >>  8) & 0xFF));\n          output.push(String.fromCharCode(buffer & 0xFF));\n          bits = 0;\n          buffer = 0;\n        }\n        position += 1;\n      }\n\n      if (bits === 12) {\n        buffer = buffer >> 4;\n        output.push(String.fromCharCode(buffer & 0xFF));\n      } else if (bits === 18) {\n        buffer = buffer >> 2;\n        output.push(String.fromCharCode((buffer >> 8) & 0xFF));\n        output.push(String.fromCharCode(buffer & 0xFF));\n      }\n\n      return output.join('');\n    };\n\n    global.btoa = global.btoa || function (input) {\n      input = String(input);\n      var position = 0,\n          out = [],\n          o1, o2, o3,\n          e1, e2, e3, e4;\n\n      if (/[^\\x00-\\xFF]/.test(input)) { throw Error('InvalidCharacterError'); }\n\n      while (position < input.length) {\n        o1 = input.charCodeAt(position++);\n        o2 = input.charCodeAt(position++);\n        o3 = input.charCodeAt(position++);\n\n        // 111111 112222 222233 333333\n        e1 = o1 >> 2;\n        e2 = ((o1 & 0x3) << 4) | (o2 >> 4);\n        e3 = ((o2 & 0xf) << 2) | (o3 >> 6);\n        e4 = o3 & 0x3f;\n\n        if (position === input.length + 2) {\n          e3 = 64; e4 = 64;\n        }\n        else if (position === input.length + 1) {\n          e4 = 64;\n        }\n\n        out.push(B64_ALPHABET.charAt(e1),\n                 B64_ALPHABET.charAt(e2),\n                 B64_ALPHABET.charAt(e3),\n                 B64_ALPHABET.charAt(e4));\n      }\n\n      return out.join('');\n    };\n  }(window));\n\n  //https://gist.github.com/jimeh/332357\n  if (!Object.prototype.hasOwnProperty){\n      /*jshint -W001, -W103 */\n      Object.prototype.hasOwnProperty = function(prop) {\n      var proto = this.__proto__ || this.constructor.prototype;\n      return (prop in this) && (!(prop in proto) || proto[prop] !== this[prop]);\n    };\n      /*jshint +W001, +W103 */\n  }\n\n  // @license http://opensource.org/licenses/MIT\n  // copyright Paul Irish 2015\n\n\n  // Date.now() is supported everywhere except IE8. For IE8 we use the Date.now polyfill\n  //   github.com/Financial-Times/polyfill-service/blob/master/polyfills/Date.now/polyfill.js\n  // as Safari 6 doesn't have support for NavigationTiming, we use a Date.now() timestamp for relative values\n\n  // if you want values similar to what you'd get with real perf.now, place this towards the head of the page\n  // but in reality, you're just getting the delta between now() calls, so it's not terribly important where it's placed\n\n\n  (function(){\n\n    if ('performance' in window === false) {\n        window.performance = {};\n    }\n    \n    Date.now = (Date.now || function () {  // thanks IE8\n      return new Date().getTime();\n    });\n\n    if ('now' in window.performance === false){\n      \n      var nowOffset = Date.now();\n      \n      if (performance.timing && performance.timing.navigationStart){\n        nowOffset = performance.timing.navigationStart;\n      }\n\n      window.performance.now = function now(){\n        return Date.now() - nowOffset;\n      };\n    }\n\n  })();\n\n  //requestAnimationFrame polyfill for older Firefox/Chrome versions\n  if (!window.requestAnimationFrame) {\n    if (window.webkitRequestAnimationFrame && window.webkitCancelAnimationFrame) {\n    //https://github.com/Financial-Times/polyfill-service/blob/master/polyfills/requestAnimationFrame/polyfill-webkit.js\n    (function (global) {\n      global.requestAnimationFrame = function (callback) {\n        return webkitRequestAnimationFrame(function () {\n          callback(global.performance.now());\n        });\n      };\n\n      global.cancelAnimationFrame = global.webkitCancelAnimationFrame;\n    }(window));\n    } else if (window.mozRequestAnimationFrame && window.mozCancelAnimationFrame) {\n      //https://github.com/Financial-Times/polyfill-service/blob/master/polyfills/requestAnimationFrame/polyfill-moz.js\n    (function (global) {\n      global.requestAnimationFrame = function (callback) {\n        return mozRequestAnimationFrame(function () {\n          callback(global.performance.now());\n        });\n      };\n\n      global.cancelAnimationFrame = global.mozCancelAnimationFrame;\n    }(window));\n    } else {\n    (function (global) {\n      global.requestAnimationFrame = function (callback) {\n        return global.setTimeout(callback, 1000 / 60);\n      };\n\n      global.cancelAnimationFrame = global.clearTimeout;\n    })(window);\n    }\n  }\n})(this);\n\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(true)\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Holder\"] = factory();\n\telse\n\t\troot[\"Holder\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*\n\tHolder.js - client side image placeholders\n\t(c) 2012-2015 Ivan Malopinsky - http://imsky.co\n\t*/\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {/*\n\tHolder.js - client side image placeholders\n\t(c) 2012-2016 Ivan Malopinsky - http://imsky.co\n\t*/\n\n\t//Libraries and functions\n\tvar onDomReady = __webpack_require__(2);\n\tvar querystring = __webpack_require__(3);\n\n\tvar SceneGraph = __webpack_require__(6);\n\tvar utils = __webpack_require__(7);\n\tvar SVG = __webpack_require__(8);\n\tvar DOM = __webpack_require__(9);\n\tvar Color = __webpack_require__(10);\n\tvar constants = __webpack_require__(11);\n\n\tvar svgRenderer = __webpack_require__(12);\n\tvar sgCanvasRenderer = __webpack_require__(15);\n\n\tvar extend = utils.extend;\n\tvar dimensionCheck = utils.dimensionCheck;\n\n\t//Constants and definitions\n\tvar SVG_NS = constants.svg_ns;\n\n\tvar Holder = {\n\t    version: constants.version,\n\n\t    /**\n\t     * Adds a theme to default settings\n\t     *\n\t     * @param {string} name Theme name\n\t     * @param {Object} theme Theme object, with foreground, background, size, font, and fontweight properties.\n\t     */\n\t    addTheme: function(name, theme) {\n\t        name != null && theme != null && (App.settings.themes[name] = theme);\n\t        delete App.vars.cache.themeKeys;\n\t        return this;\n\t    },\n\n\t    /**\n\t     * Appends a placeholder to an element\n\t     *\n\t     * @param {string} src Placeholder URL string\n\t     * @param el A selector or a reference to a DOM node\n\t     */\n\t    addImage: function(src, el) {\n\t        //todo: use jquery fallback if available for all QSA references\n\t        var nodes = DOM.getNodeArray(el);\n\t        nodes.forEach(function (node) {\n\t            var img = DOM.newEl('img');\n\t            var domProps = {};\n\t            domProps[App.setup.dataAttr] = src;\n\t            DOM.setAttr(img, domProps);\n\t            node.appendChild(img);\n\t        });\n\t        return this;\n\t    },\n\n\t    /**\n\t     * Sets whether or not an image is updated on resize.\n\t     * If an image is set to be updated, it is immediately rendered.\n\t     *\n\t     * @param {Object} el Image DOM element\n\t     * @param {Boolean} value Resizable update flag value\n\t     */\n\t    setResizeUpdate: function(el, value) {\n\t        if (el.holderData) {\n\t            el.holderData.resizeUpdate = !!value;\n\t            if (el.holderData.resizeUpdate) {\n\t                updateResizableElements(el);\n\t            }\n\t        }\n\t    },\n\n\t    /**\n\t     * Runs Holder with options. By default runs Holder on all images with \"holder.js\" in their source attributes.\n\t     *\n\t     * @param {Object} userOptions Options object, can contain domain, themes, images, and bgnodes properties\n\t     */\n\t    run: function(userOptions) {\n\t        //todo: split processing into separate queues\n\t        userOptions = userOptions || {};\n\t        var engineSettings = {};\n\t        var options = extend(App.settings, userOptions);\n\n\t        App.vars.preempted = true;\n\t        App.vars.dataAttr = options.dataAttr || App.setup.dataAttr;\n\n\t        engineSettings.renderer = options.renderer ? options.renderer : App.setup.renderer;\n\t        if (App.setup.renderers.join(',').indexOf(engineSettings.renderer) === -1) {\n\t            engineSettings.renderer = App.setup.supportsSVG ? 'svg' : (App.setup.supportsCanvas ? 'canvas' : 'html');\n\t        }\n\n\t        var images = DOM.getNodeArray(options.images);\n\t        var bgnodes = DOM.getNodeArray(options.bgnodes);\n\t        var stylenodes = DOM.getNodeArray(options.stylenodes);\n\t        var objects = DOM.getNodeArray(options.objects);\n\n\t        engineSettings.stylesheets = [];\n\t        engineSettings.svgXMLStylesheet = true;\n\t        engineSettings.noFontFallback = !!options.noFontFallback;\n\t        engineSettings.noBackgroundSize = !!options.noBackgroundSize;\n\n\t        stylenodes.forEach(function (styleNode) {\n\t            if (styleNode.attributes.rel && styleNode.attributes.href && styleNode.attributes.rel.value == 'stylesheet') {\n\t                var href = styleNode.attributes.href.value;\n\t                //todo: write isomorphic relative-to-absolute URL function\n\t                var proxyLink = DOM.newEl('a');\n\t                proxyLink.href = href;\n\t                var stylesheetURL = proxyLink.protocol + '//' + proxyLink.host + proxyLink.pathname + proxyLink.search;\n\t                engineSettings.stylesheets.push(stylesheetURL);\n\t            }\n\t        });\n\n\t        bgnodes.forEach(function (bgNode) {\n\t            //Skip processing background nodes if getComputedStyle is unavailable, since only modern browsers would be able to use canvas or SVG to render to background\n\t            if (!global.getComputedStyle) return;\n\t            var backgroundImage = global.getComputedStyle(bgNode, null).getPropertyValue('background-image');\n\t            var dataBackgroundImage = bgNode.getAttribute('data-background-src');\n\t            var rawURL = dataBackgroundImage || backgroundImage;\n\n\t            var holderURL = null;\n\t            var holderString = options.domain + '/';\n\t            var holderStringIndex = rawURL.indexOf(holderString);\n\n\t            if (holderStringIndex === 0) {\n\t                holderURL = rawURL;\n\t            } else if (holderStringIndex === 1 && rawURL[0] === '?') {\n\t                holderURL = rawURL.slice(1);\n\t            } else {\n\t                var fragment = rawURL.substr(holderStringIndex).match(/([^\\\"]*)\"?\\)/);\n\t                if (fragment !== null) {\n\t                    holderURL = fragment[1];\n\t                } else if (rawURL.indexOf('url(') === 0) {\n\t                    throw 'Holder: unable to parse background URL: ' + rawURL;\n\t                }\n\t            }\n\n\t            if (holderURL) {\n\t                var holderFlags = parseURL(holderURL, options);\n\t                if (holderFlags) {\n\t                    prepareDOMElement({\n\t                        mode: 'background',\n\t                        el: bgNode,\n\t                        flags: holderFlags,\n\t                        engineSettings: engineSettings\n\t                    });\n\t                }\n\t            }\n\t        });\n\n\t        objects.forEach(function (object) {\n\t            var objectAttr = {};\n\n\t            try {\n\t                objectAttr.data = object.getAttribute('data');\n\t                objectAttr.dataSrc = object.getAttribute(App.vars.dataAttr);\n\t            } catch (e) {}\n\n\t            var objectHasSrcURL = objectAttr.data != null && objectAttr.data.indexOf(options.domain) === 0;\n\t            var objectHasDataSrcURL = objectAttr.dataSrc != null && objectAttr.dataSrc.indexOf(options.domain) === 0;\n\n\t            if (objectHasSrcURL) {\n\t                prepareImageElement(options, engineSettings, objectAttr.data, object);\n\t            } else if (objectHasDataSrcURL) {\n\t                prepareImageElement(options, engineSettings, objectAttr.dataSrc, object);\n\t            }\n\t        });\n\n\t        images.forEach(function (image) {\n\t            var imageAttr = {};\n\n\t            try {\n\t                imageAttr.src = image.getAttribute('src');\n\t                imageAttr.dataSrc = image.getAttribute(App.vars.dataAttr);\n\t                imageAttr.rendered = image.getAttribute('data-holder-rendered');\n\t            } catch (e) {}\n\n\t            var imageHasSrc = imageAttr.src != null;\n\t            var imageHasDataSrcURL = imageAttr.dataSrc != null && imageAttr.dataSrc.indexOf(options.domain) === 0;\n\t            var imageRendered = imageAttr.rendered != null && imageAttr.rendered == 'true';\n\n\t            if (imageHasSrc) {\n\t                if (imageAttr.src.indexOf(options.domain) === 0) {\n\t                    prepareImageElement(options, engineSettings, imageAttr.src, image);\n\t                } else if (imageHasDataSrcURL) {\n\t                    //Image has a valid data-src and an invalid src\n\t                    if (imageRendered) {\n\t                        //If the placeholder has already been render, re-render it\n\t                        prepareImageElement(options, engineSettings, imageAttr.dataSrc, image);\n\t                    } else {\n\t                        //If the placeholder has not been rendered, check if the image exists and render a fallback if it doesn't\n\t                        (function(src, options, engineSettings, dataSrc, image) {\n\t                            utils.imageExists(src, function(exists) {\n\t                                if (!exists) {\n\t                                    prepareImageElement(options, engineSettings, dataSrc, image);\n\t                                }\n\t                            });\n\t                        })(imageAttr.src, options, engineSettings, imageAttr.dataSrc, image);\n\t                    }\n\t                }\n\t            } else if (imageHasDataSrcURL) {\n\t                prepareImageElement(options, engineSettings, imageAttr.dataSrc, image);\n\t            }\n\t        });\n\n\t        return this;\n\t    }\n\t};\n\n\tvar App = {\n\t    settings: {\n\t        domain: 'holder.js',\n\t        images: 'img',\n\t        objects: 'object',\n\t        bgnodes: 'body .holderjs',\n\t        stylenodes: 'head link.holderjs',\n\t        themes: {\n\t            'gray': {\n\t                bg: '#EEEEEE',\n\t                fg: '#AAAAAA'\n\t            },\n\t            'social': {\n\t                bg: '#3a5a97',\n\t                fg: '#FFFFFF'\n\t            },\n\t            'industrial': {\n\t                bg: '#434A52',\n\t                fg: '#C2F200'\n\t            },\n\t            'sky': {\n\t                bg: '#0D8FDB',\n\t                fg: '#FFFFFF'\n\t            },\n\t            'vine': {\n\t                bg: '#39DBAC',\n\t                fg: '#1E292C'\n\t            },\n\t            'lava': {\n\t                bg: '#F8591A',\n\t                fg: '#1C2846'\n\t            }\n\t        }\n\t    },\n\t    defaults: {\n\t        size: 10,\n\t        units: 'pt',\n\t        scale: 1 / 16\n\t    }\n\t};\n\n\t/**\n\t * Processes provided source attribute and sets up the appropriate rendering workflow\n\t *\n\t * @private\n\t * @param options Instance options from Holder.run\n\t * @param renderSettings Instance configuration\n\t * @param src Image URL\n\t * @param el Image DOM element\n\t */\n\tfunction prepareImageElement(options, engineSettings, src, el) {\n\t    var holderFlags = parseURL(src.substr(src.lastIndexOf(options.domain)), options);\n\t    if (holderFlags) {\n\t        prepareDOMElement({\n\t            mode: null,\n\t            el: el,\n\t            flags: holderFlags,\n\t            engineSettings: engineSettings\n\t        });\n\t    }\n\t}\n\n\t/**\n\t * Processes a Holder URL and extracts configuration from query string\n\t *\n\t * @private\n\t * @param url URL\n\t * @param instanceOptions Instance options from Holder.run\n\t */\n\tfunction parseURL(url, instanceOptions) {\n\t    var holder = {\n\t        theme: extend(App.settings.themes.gray, null),\n\t        stylesheets: instanceOptions.stylesheets,\n\t        instanceOptions: instanceOptions\n\t    };\n\n\t    var firstQuestionMark = url.indexOf('?');\n\t    var parts = [url];\n\n\t    if (firstQuestionMark !== -1) {\n\t        parts = [url.slice(0, firstQuestionMark), url.slice(firstQuestionMark + 1)];\n\t    }\n\n\t    var basics = parts[0].split('/');\n\n\t    holder.holderURL = url;\n\n\t    var dimensions = basics[1];\n\t    var dimensionData = dimensions.match(/([\\d]+p?)x([\\d]+p?)/);\n\n\t    if (!dimensionData) return false;\n\n\t    holder.fluid = dimensions.indexOf('p') !== -1;\n\n\t    holder.dimensions = {\n\t        width: dimensionData[1].replace('p', '%'),\n\t        height: dimensionData[2].replace('p', '%')\n\t    };\n\n\t    if (parts.length === 2) {\n\t        var options = querystring.parse(parts[1]);\n\n\t        // Dimensions\n\n\t        if (utils.truthy(options.ratio)) {\n\t            holder.fluid = true;\n\t            var ratioWidth = parseFloat(holder.dimensions.width.replace('%', ''));\n\t            var ratioHeight = parseFloat(holder.dimensions.height.replace('%', ''));\n\n\t            ratioHeight = Math.floor(100 * (ratioHeight / ratioWidth));\n\t            ratioWidth = 100;\n\n\t            holder.dimensions.width = ratioWidth + '%';\n\t            holder.dimensions.height = ratioHeight + '%';\n\t        }\n\n\t        holder.auto = utils.truthy(options.auto);\n\n\t        // Colors\n\n\t        if (options.bg) {\n\t            holder.theme.bg = utils.parseColor(options.bg);\n\t        }\n\n\t        if (options.fg) {\n\t            holder.theme.fg = utils.parseColor(options.fg);\n\t        }\n\n\t        //todo: add automatic foreground to themes without foreground\n\t        if (options.bg && !options.fg) {\n\t            holder.autoFg = true;\n\t        }\n\n\t        if (options.theme && holder.instanceOptions.themes.hasOwnProperty(options.theme)) {\n\t            holder.theme = extend(holder.instanceOptions.themes[options.theme], null);\n\t        }\n\n\t        // Text\n\n\t        if (options.text) {\n\t            holder.text = options.text;\n\t        }\n\n\t        if (options.textmode) {\n\t            holder.textmode = options.textmode;\n\t        }\n\n\t        if (options.size) {\n\t            holder.size = options.size;\n\t        }\n\n\t        if (options.font) {\n\t            holder.font = options.font;\n\t        }\n\n\t        if (options.align) {\n\t            holder.align = options.align;\n\t        }\n\n\t        if (options.lineWrap) {\n\t            holder.lineWrap = options.lineWrap;\n\t        }\n\n\t        holder.nowrap = utils.truthy(options.nowrap);\n\n\t        // Miscellaneous\n\n\t        holder.outline = utils.truthy(options.outline);\n\n\t        if (utils.truthy(options.random)) {\n\t            App.vars.cache.themeKeys = App.vars.cache.themeKeys || Object.keys(holder.instanceOptions.themes);\n\t            var _theme = App.vars.cache.themeKeys[0 | Math.random() * App.vars.cache.themeKeys.length];\n\t            holder.theme = extend(holder.instanceOptions.themes[_theme], null);\n\t        }\n\t    }\n\n\t    return holder;\n\t}\n\n\t/**\n\t * Modifies the DOM to fit placeholders and sets up resizable image callbacks (for fluid and automatically sized placeholders)\n\t *\n\t * @private\n\t * @param settings DOM prep settings\n\t */\n\tfunction prepareDOMElement(prepSettings) {\n\t    var mode = prepSettings.mode;\n\t    var el = prepSettings.el;\n\t    var flags = prepSettings.flags;\n\t    var _engineSettings = prepSettings.engineSettings;\n\t    var dimensions = flags.dimensions,\n\t        theme = flags.theme;\n\t    var dimensionsCaption = dimensions.width + 'x' + dimensions.height;\n\t    mode = mode == null ? (flags.fluid ? 'fluid' : 'image') : mode;\n\t    var holderTemplateRe = /holder_([a-z]+)/g;\n\t    var dimensionsInText = false;\n\n\t    if (flags.text != null) {\n\t        theme.text = flags.text;\n\n\t        //<object> SVG embedding doesn't parse Unicode properly\n\t        if (el.nodeName.toLowerCase() === 'object') {\n\t            var textLines = theme.text.split('\\\\n');\n\t            for (var k = 0; k < textLines.length; k++) {\n\t                textLines[k] = utils.encodeHtmlEntity(textLines[k]);\n\t            }\n\t            theme.text = textLines.join('\\\\n');\n\t        }\n\t    }\n\n\t    if (theme.text) {\n\t        var holderTemplateMatches = theme.text.match(holderTemplateRe);\n\n\t        if (holderTemplateMatches !== null) {\n\t            //todo: optimize template replacement\n\t            holderTemplateMatches.forEach(function (match) {\n\t                if (match === 'holder_dimensions') {\n\t                    theme.text = theme.text.replace(match, dimensionsCaption);\n\t                }\n\t            });\n\t        }\n\t    }\n\n\t    var holderURL = flags.holderURL;\n\t    var engineSettings = extend(_engineSettings, null);\n\n\t    if (flags.font) {\n\t        /*\n\t        If external fonts are used in a <img> placeholder rendered with SVG, Holder falls back to canvas.\n\n\t        This is done because Firefox and Chrome disallow embedded SVGs from referencing external assets.\n\t        The workaround is either to change the placeholder tag from <img> to <object> or to use the canvas renderer.\n\t        */\n\t        theme.font = flags.font;\n\t        if (!engineSettings.noFontFallback && el.nodeName.toLowerCase() === 'img' && App.setup.supportsCanvas && engineSettings.renderer === 'svg') {\n\t            engineSettings = extend(engineSettings, {\n\t                renderer: 'canvas'\n\t            });\n\t        }\n\t    }\n\n\t    //Chrome and Opera require a quick 10ms re-render if web fonts are used with canvas\n\t    if (flags.font && engineSettings.renderer == 'canvas') {\n\t        engineSettings.reRender = true;\n\t    }\n\n\t    if (mode == 'background') {\n\t        if (el.getAttribute('data-background-src') == null) {\n\t            DOM.setAttr(el, {\n\t                'data-background-src': holderURL\n\t            });\n\t        }\n\t    } else {\n\t        var domProps = {};\n\t        domProps[App.vars.dataAttr] = holderURL;\n\t        DOM.setAttr(el, domProps);\n\t    }\n\n\t    flags.theme = theme;\n\n\t    //todo consider using all renderSettings in holderData\n\t    el.holderData = {\n\t        flags: flags,\n\t        engineSettings: engineSettings\n\t    };\n\n\t    if (mode == 'image' || mode == 'fluid') {\n\t        DOM.setAttr(el, {\n\t            'alt': theme.text ? (dimensionsInText ? theme.text : theme.text + ' [' + dimensionsCaption + ']') : dimensionsCaption\n\t        });\n\t    }\n\n\t    var renderSettings = {\n\t        mode: mode,\n\t        el: el,\n\t        holderSettings: {\n\t            dimensions: dimensions,\n\t            theme: theme,\n\t            flags: flags\n\t        },\n\t        engineSettings: engineSettings\n\t    };\n\n\t    if (mode == 'image') {\n\t        if (!flags.auto) {\n\t            el.style.width = dimensions.width + 'px';\n\t            el.style.height = dimensions.height + 'px';\n\t        }\n\n\t        if (engineSettings.renderer == 'html') {\n\t            el.style.backgroundColor = theme.bg;\n\t        } else {\n\t            render(renderSettings);\n\n\t            if (flags.textmode == 'exact') {\n\t                el.holderData.resizeUpdate = true;\n\t                App.vars.resizableImages.push(el);\n\t                updateResizableElements(el);\n\t            }\n\t        }\n\t    } else if (mode == 'background' && engineSettings.renderer != 'html') {\n\t        render(renderSettings);\n\t    } else if (mode == 'fluid') {\n\t        el.holderData.resizeUpdate = true;\n\n\t        if (dimensions.height.slice(-1) == '%') {\n\t            el.style.height = dimensions.height;\n\t        } else if (flags.auto == null || !flags.auto) {\n\t            el.style.height = dimensions.height + 'px';\n\t        }\n\t        if (dimensions.width.slice(-1) == '%') {\n\t            el.style.width = dimensions.width;\n\t        } else if (flags.auto == null || !flags.auto) {\n\t            el.style.width = dimensions.width + 'px';\n\t        }\n\t        if (el.style.display == 'inline' || el.style.display === '' || el.style.display == 'none') {\n\t            el.style.display = 'block';\n\t        }\n\n\t        setInitialDimensions(el);\n\n\t        if (engineSettings.renderer == 'html') {\n\t            el.style.backgroundColor = theme.bg;\n\t        } else {\n\t            App.vars.resizableImages.push(el);\n\t            updateResizableElements(el);\n\t        }\n\t    }\n\t}\n\n\t/**\n\t * Core function that takes output from renderers and sets it as the source or background-image of the target element\n\t *\n\t * @private\n\t * @param renderSettings Renderer settings\n\t */\n\tfunction render(renderSettings) {\n\t    var image = null;\n\t    var mode = renderSettings.mode;\n\t    var el = renderSettings.el;\n\t    var holderSettings = renderSettings.holderSettings;\n\t    var engineSettings = renderSettings.engineSettings;\n\n\t    switch (engineSettings.renderer) {\n\t        case 'svg':\n\t            if (!App.setup.supportsSVG) return;\n\t            break;\n\t        case 'canvas':\n\t            if (!App.setup.supportsCanvas) return;\n\t            break;\n\t        default:\n\t            return;\n\t    }\n\n\t    //todo: move generation of scene up to flag generation to reduce extra object creation\n\t    var scene = {\n\t        width: holderSettings.dimensions.width,\n\t        height: holderSettings.dimensions.height,\n\t        theme: holderSettings.theme,\n\t        flags: holderSettings.flags\n\t    };\n\n\t    var sceneGraph = buildSceneGraph(scene);\n\n\t    function getRenderedImage() {\n\t        var image = null;\n\t        switch (engineSettings.renderer) {\n\t            case 'canvas':\n\t                image = sgCanvasRenderer(sceneGraph, renderSettings);\n\t                break;\n\t            case 'svg':\n\t                image = svgRenderer(sceneGraph, renderSettings);\n\t                break;\n\t            default:\n\t                throw 'Holder: invalid renderer: ' + engineSettings.renderer;\n\t        }\n\n\t        return image;\n\t    }\n\n\t    image = getRenderedImage();\n\n\t    if (image == null) {\n\t        throw 'Holder: couldn\\'t render placeholder';\n\t    }\n\n\t    //todo: add <object> canvas rendering\n\t    if (mode == 'background') {\n\t        el.style.backgroundImage = 'url(' + image + ')';\n\n\t        if (!engineSettings.noBackgroundSize) {\n\t            el.style.backgroundSize = scene.width + 'px ' + scene.height + 'px';\n\t        }\n\t    } else {\n\t        if (el.nodeName.toLowerCase() === 'img') {\n\t            DOM.setAttr(el, {\n\t                'src': image\n\t            });\n\t        } else if (el.nodeName.toLowerCase() === 'object') {\n\t            DOM.setAttr(el, {\n\t                'data': image,\n\t                'type': 'image/svg+xml'\n\t            });\n\t        }\n\t        if (engineSettings.reRender) {\n\t            global.setTimeout(function () {\n\t                var image = getRenderedImage();\n\t                if (image == null) {\n\t                    throw 'Holder: couldn\\'t render placeholder';\n\t                }\n\t                //todo: refactor this code into a function\n\t                if (el.nodeName.toLowerCase() === 'img') {\n\t                    DOM.setAttr(el, {\n\t                        'src': image\n\t                    });\n\t                } else if (el.nodeName.toLowerCase() === 'object') {\n\t                    DOM.setAttr(el, {\n\t                        'data': image,\n\t                        'type': 'image/svg+xml'\n\t                    });\n\t                }\n\t            }, 150);\n\t        }\n\t    }\n\t    //todo: account for re-rendering\n\t    DOM.setAttr(el, {\n\t        'data-holder-rendered': true\n\t    });\n\t}\n\n\t/**\n\t * Core function that takes a Holder scene description and builds a scene graph\n\t *\n\t * @private\n\t * @param scene Holder scene object\n\t */\n\t//todo: make this function reusable\n\t//todo: merge app defaults and setup properties into the scene argument\n\tfunction buildSceneGraph(scene) {\n\t    var fontSize = App.defaults.size;\n\t    if (parseFloat(scene.theme.size)) {\n\t        fontSize = scene.theme.size;\n\t    } else if (parseFloat(scene.flags.size)) {\n\t        fontSize = scene.flags.size;\n\t    }\n\n\t    scene.font = {\n\t        family: scene.theme.font ? scene.theme.font : 'Arial, Helvetica, Open Sans, sans-serif',\n\t        size: textSize(scene.width, scene.height, fontSize, App.defaults.scale),\n\t        units: scene.theme.units ? scene.theme.units : App.defaults.units,\n\t        weight: scene.theme.fontweight ? scene.theme.fontweight : 'bold'\n\t    };\n\n\t    scene.text = scene.theme.text || Math.floor(scene.width) + 'x' + Math.floor(scene.height);\n\n\t    scene.noWrap = scene.theme.nowrap || scene.flags.nowrap;\n\n\t    scene.align = scene.theme.align || scene.flags.align || 'center';\n\n\t    switch (scene.flags.textmode) {\n\t        case 'literal':\n\t            scene.text = scene.flags.dimensions.width + 'x' + scene.flags.dimensions.height;\n\t            break;\n\t        case 'exact':\n\t            if (!scene.flags.exactDimensions) break;\n\t            scene.text = Math.floor(scene.flags.exactDimensions.width) + 'x' + Math.floor(scene.flags.exactDimensions.height);\n\t            break;\n\t    }\n\n\t    var lineWrap = scene.flags.lineWrap || App.setup.lineWrapRatio;\n\t    var sceneMargin = scene.width * lineWrap;\n\t    var maxLineWidth = sceneMargin;\n\n\t    var sceneGraph = new SceneGraph({\n\t        width: scene.width,\n\t        height: scene.height\n\t    });\n\n\t    var Shape = sceneGraph.Shape;\n\n\t    var holderBg = new Shape.Rect('holderBg', {\n\t        fill: scene.theme.bg\n\t    });\n\n\t    holderBg.resize(scene.width, scene.height);\n\t    sceneGraph.root.add(holderBg);\n\n\t    if (scene.flags.outline) {\n\t        var outlineColor = new Color(holderBg.properties.fill);\n\t        outlineColor = outlineColor.lighten(outlineColor.lighterThan('7f7f7f') ? -0.1 : 0.1);\n\t        holderBg.properties.outline = {\n\t            fill: outlineColor.toHex(true),\n\t            width: 2\n\t        };\n\t    }\n\n\t    var holderTextColor = scene.theme.fg;\n\n\t    if (scene.flags.autoFg) {\n\t        var holderBgColor = new Color(holderBg.properties.fill);\n\t        var lightColor = new Color('fff');\n\t        var darkColor = new Color('000', {\n\t            'alpha': 0.285714\n\t        });\n\n\t        holderTextColor = holderBgColor.blendAlpha(holderBgColor.lighterThan('7f7f7f') ? darkColor : lightColor).toHex(true);\n\t    }\n\n\t    var holderTextGroup = new Shape.Group('holderTextGroup', {\n\t        text: scene.text,\n\t        align: scene.align,\n\t        font: scene.font,\n\t        fill: holderTextColor\n\t    });\n\n\t    holderTextGroup.moveTo(null, null, 1);\n\t    sceneGraph.root.add(holderTextGroup);\n\n\t    var tpdata = holderTextGroup.textPositionData = stagingRenderer(sceneGraph);\n\t    if (!tpdata) {\n\t        throw 'Holder: staging fallback not supported yet.';\n\t    }\n\t    holderTextGroup.properties.leading = tpdata.boundingBox.height;\n\n\t    var textNode = null;\n\t    var line = null;\n\n\t    function finalizeLine(parent, line, width, height) {\n\t        line.width = width;\n\t        line.height = height;\n\t        parent.width = Math.max(parent.width, line.width);\n\t        parent.height += line.height;\n\t    }\n\n\t    if (tpdata.lineCount > 1) {\n\t        var offsetX = 0;\n\t        var offsetY = 0;\n\t        var lineIndex = 0;\n\t        var lineKey;\n\t        line = new Shape.Group('line' + lineIndex);\n\n\t        //Double margin so that left/right-aligned next is not flush with edge of image\n\t        if (scene.align === 'left' || scene.align === 'right') {\n\t            maxLineWidth = scene.width * (1 - (1 - lineWrap) * 2);\n\t        }\n\n\t        for (var i = 0; i < tpdata.words.length; i++) {\n\t            var word = tpdata.words[i];\n\t            textNode = new Shape.Text(word.text);\n\t            var newline = word.text == '\\\\n';\n\t            if (!scene.noWrap && (offsetX + word.width >= maxLineWidth || newline === true)) {\n\t                finalizeLine(holderTextGroup, line, offsetX, holderTextGroup.properties.leading);\n\t                holderTextGroup.add(line);\n\t                offsetX = 0;\n\t                offsetY += holderTextGroup.properties.leading;\n\t                lineIndex += 1;\n\t                line = new Shape.Group('line' + lineIndex);\n\t                line.y = offsetY;\n\t            }\n\t            if (newline === true) {\n\t                continue;\n\t            }\n\t            textNode.moveTo(offsetX, 0);\n\t            offsetX += tpdata.spaceWidth + word.width;\n\t            line.add(textNode);\n\t        }\n\n\t        finalizeLine(holderTextGroup, line, offsetX, holderTextGroup.properties.leading);\n\t        holderTextGroup.add(line);\n\n\t        if (scene.align === 'left') {\n\t            holderTextGroup.moveTo(scene.width - sceneMargin, null, null);\n\t        } else if (scene.align === 'right') {\n\t            for (lineKey in holderTextGroup.children) {\n\t                line = holderTextGroup.children[lineKey];\n\t                line.moveTo(scene.width - line.width, null, null);\n\t            }\n\n\t            holderTextGroup.moveTo(0 - (scene.width - sceneMargin), null, null);\n\t        } else {\n\t            for (lineKey in holderTextGroup.children) {\n\t                line = holderTextGroup.children[lineKey];\n\t                line.moveTo((holderTextGroup.width - line.width) / 2, null, null);\n\t            }\n\n\t            holderTextGroup.moveTo((scene.width - holderTextGroup.width) / 2, null, null);\n\t        }\n\n\t        holderTextGroup.moveTo(null, (scene.height - holderTextGroup.height) / 2, null);\n\n\t        //If the text exceeds vertical space, move it down so the first line is visible\n\t        if ((scene.height - holderTextGroup.height) / 2 < 0) {\n\t            holderTextGroup.moveTo(null, 0, null);\n\t        }\n\t    } else {\n\t        textNode = new Shape.Text(scene.text);\n\t        line = new Shape.Group('line0');\n\t        line.add(textNode);\n\t        holderTextGroup.add(line);\n\n\t        if (scene.align === 'left') {\n\t            holderTextGroup.moveTo(scene.width - sceneMargin, null, null);\n\t        } else if (scene.align === 'right') {\n\t            holderTextGroup.moveTo(0 - (scene.width - sceneMargin), null, null);\n\t        } else {\n\t            holderTextGroup.moveTo((scene.width - tpdata.boundingBox.width) / 2, null, null);\n\t        }\n\n\t        holderTextGroup.moveTo(null, (scene.height - tpdata.boundingBox.height) / 2, null);\n\t    }\n\n\t    //todo: renderlist\n\t    return sceneGraph;\n\t}\n\n\t/**\n\t * Adaptive text sizing function\n\t *\n\t * @private\n\t * @param width Parent width\n\t * @param height Parent height\n\t * @param fontSize Requested text size\n\t * @param scale Proportional scale of text\n\t */\n\tfunction textSize(width, height, fontSize, scale) {\n\t    var stageWidth = parseInt(width, 10);\n\t    var stageHeight = parseInt(height, 10);\n\n\t    var bigSide = Math.max(stageWidth, stageHeight);\n\t    var smallSide = Math.min(stageWidth, stageHeight);\n\n\t    var newHeight = 0.8 * Math.min(smallSide, bigSide * scale);\n\t    return Math.round(Math.max(fontSize, newHeight));\n\t}\n\n\t/**\n\t * Iterates over resizable (fluid or auto) placeholders and renders them\n\t *\n\t * @private\n\t * @param element Optional element selector, specified only if a specific element needs to be re-rendered\n\t */\n\tfunction updateResizableElements(element) {\n\t    var images;\n\t    if (element == null || element.nodeType == null) {\n\t        images = App.vars.resizableImages;\n\t    } else {\n\t        images = [element];\n\t    }\n\t    for (var i = 0, l = images.length; i < l; i++) {\n\t        var el = images[i];\n\t        if (el.holderData) {\n\t            var flags = el.holderData.flags;\n\t            var dimensions = dimensionCheck(el);\n\t            if (dimensions) {\n\t                if (!el.holderData.resizeUpdate) {\n\t                    continue;\n\t                }\n\n\t                if (flags.fluid && flags.auto) {\n\t                    var fluidConfig = el.holderData.fluidConfig;\n\t                    switch (fluidConfig.mode) {\n\t                        case 'width':\n\t                            dimensions.height = dimensions.width / fluidConfig.ratio;\n\t                            break;\n\t                        case 'height':\n\t                            dimensions.width = dimensions.height * fluidConfig.ratio;\n\t                            break;\n\t                    }\n\t                }\n\n\t                var settings = {\n\t                    mode: 'image',\n\t                    holderSettings: {\n\t                        dimensions: dimensions,\n\t                        theme: flags.theme,\n\t                        flags: flags\n\t                    },\n\t                    el: el,\n\t                    engineSettings: el.holderData.engineSettings\n\t                };\n\n\t                if (flags.textmode == 'exact') {\n\t                    flags.exactDimensions = dimensions;\n\t                    settings.holderSettings.dimensions = flags.dimensions;\n\t                }\n\n\t                render(settings);\n\t            } else {\n\t                setInvisible(el);\n\t            }\n\t        }\n\t    }\n\t}\n\n\t/**\n\t * Sets up aspect ratio metadata for fluid placeholders, in order to preserve proportions when resizing\n\t *\n\t * @private\n\t * @param el Image DOM element\n\t */\n\tfunction setInitialDimensions(el) {\n\t    if (el.holderData) {\n\t        var dimensions = dimensionCheck(el);\n\t        if (dimensions) {\n\t            var flags = el.holderData.flags;\n\n\t            var fluidConfig = {\n\t                fluidHeight: flags.dimensions.height.slice(-1) == '%',\n\t                fluidWidth: flags.dimensions.width.slice(-1) == '%',\n\t                mode: null,\n\t                initialDimensions: dimensions\n\t            };\n\n\t            if (fluidConfig.fluidWidth && !fluidConfig.fluidHeight) {\n\t                fluidConfig.mode = 'width';\n\t                fluidConfig.ratio = fluidConfig.initialDimensions.width / parseFloat(flags.dimensions.height);\n\t            } else if (!fluidConfig.fluidWidth && fluidConfig.fluidHeight) {\n\t                fluidConfig.mode = 'height';\n\t                fluidConfig.ratio = parseFloat(flags.dimensions.width) / fluidConfig.initialDimensions.height;\n\t            }\n\n\t            el.holderData.fluidConfig = fluidConfig;\n\t        } else {\n\t            setInvisible(el);\n\t        }\n\t    }\n\t}\n\n\t/**\n\t * Iterates through all current invisible images, and if they're visible, renders them and removes them from further checks. Runs every animation frame.\n\t *\n\t * @private\n\t */\n\tfunction visibilityCheck() {\n\t    var renderableImages = [];\n\t    var keys = Object.keys(App.vars.invisibleImages);\n\t    var el;\n\n\t    keys.forEach(function (key) {\n\t        el = App.vars.invisibleImages[key];\n\t        if (dimensionCheck(el) && el.nodeName.toLowerCase() == 'img') {\n\t            renderableImages.push(el);\n\t            delete App.vars.invisibleImages[key];\n\t        }\n\t    });\n\n\t    if (renderableImages.length) {\n\t        Holder.run({\n\t            images: renderableImages\n\t        });\n\t    }\n\n\t    // Done to prevent 100% CPU usage via aggressive calling of requestAnimationFrame\n\t    setTimeout(function () {\n\t        global.requestAnimationFrame(visibilityCheck);\n\t    }, 10);\n\t}\n\n\t/**\n\t * Starts checking for invisible placeholders if not doing so yet. Does nothing otherwise.\n\t *\n\t * @private\n\t */\n\tfunction startVisibilityCheck() {\n\t    if (!App.vars.visibilityCheckStarted) {\n\t        global.requestAnimationFrame(visibilityCheck);\n\t        App.vars.visibilityCheckStarted = true;\n\t    }\n\t}\n\n\t/**\n\t * Sets a unique ID for an image detected to be invisible and adds it to the map of invisible images checked by visibilityCheck\n\t *\n\t * @private\n\t * @param el Invisible DOM element\n\t */\n\tfunction setInvisible(el) {\n\t    if (!el.holderData.invisibleId) {\n\t        App.vars.invisibleId += 1;\n\t        App.vars.invisibleImages['i' + App.vars.invisibleId] = el;\n\t        el.holderData.invisibleId = App.vars.invisibleId;\n\t    }\n\t}\n\n\t//todo: see if possible to convert stagingRenderer to use HTML only\n\tvar stagingRenderer = (function() {\n\t    var svg = null,\n\t        stagingText = null,\n\t        stagingTextNode = null;\n\t    return function(graph) {\n\t        var rootNode = graph.root;\n\t        if (App.setup.supportsSVG) {\n\t            var firstTimeSetup = false;\n\t            var tnode = function(text) {\n\t                return document.createTextNode(text);\n\t            };\n\t            if (svg == null || svg.parentNode !== document.body) {\n\t                firstTimeSetup = true;\n\t            }\n\n\t            svg = SVG.initSVG(svg, rootNode.properties.width, rootNode.properties.height);\n\t            //Show staging element before staging\n\t            svg.style.display = 'block';\n\n\t            if (firstTimeSetup) {\n\t                stagingText = DOM.newEl('text', SVG_NS);\n\t                stagingTextNode = tnode(null);\n\t                DOM.setAttr(stagingText, {\n\t                    x: 0\n\t                });\n\t                stagingText.appendChild(stagingTextNode);\n\t                svg.appendChild(stagingText);\n\t                document.body.appendChild(svg);\n\t                svg.style.visibility = 'hidden';\n\t                svg.style.position = 'absolute';\n\t                svg.style.top = '-100%';\n\t                svg.style.left = '-100%';\n\t                //todo: workaround for zero-dimension <svg> tag in Opera 12\n\t                //svg.setAttribute('width', 0);\n\t                //svg.setAttribute('height', 0);\n\t            }\n\n\t            var holderTextGroup = rootNode.children.holderTextGroup;\n\t            var htgProps = holderTextGroup.properties;\n\t            DOM.setAttr(stagingText, {\n\t                'y': htgProps.font.size,\n\t                'style': utils.cssProps({\n\t                    'font-weight': htgProps.font.weight,\n\t                    'font-size': htgProps.font.size + htgProps.font.units,\n\t                    'font-family': htgProps.font.family\n\t                })\n\t            });\n\n\t            //Get bounding box for the whole string (total width and height)\n\t            stagingTextNode.nodeValue = htgProps.text;\n\t            var stagingTextBBox = stagingText.getBBox();\n\n\t            //Get line count and split the string into words\n\t            var lineCount = Math.ceil(stagingTextBBox.width / rootNode.properties.width);\n\t            var words = htgProps.text.split(' ');\n\t            var newlines = htgProps.text.match(/\\\\n/g);\n\t            lineCount += newlines == null ? 0 : newlines.length;\n\n\t            //Get bounding box for the string with spaces removed\n\t            stagingTextNode.nodeValue = htgProps.text.replace(/[ ]+/g, '');\n\t            var computedNoSpaceLength = stagingText.getComputedTextLength();\n\n\t            //Compute average space width\n\t            var diffLength = stagingTextBBox.width - computedNoSpaceLength;\n\t            var spaceWidth = Math.round(diffLength / Math.max(1, words.length - 1));\n\n\t            //Get widths for every word with space only if there is more than one line\n\t            var wordWidths = [];\n\t            if (lineCount > 1) {\n\t                stagingTextNode.nodeValue = '';\n\t                for (var i = 0; i < words.length; i++) {\n\t                    if (words[i].length === 0) continue;\n\t                    stagingTextNode.nodeValue = utils.decodeHtmlEntity(words[i]);\n\t                    var bbox = stagingText.getBBox();\n\t                    wordWidths.push({\n\t                        text: words[i],\n\t                        width: bbox.width\n\t                    });\n\t                }\n\t            }\n\n\t            //Hide staging element after staging\n\t            svg.style.display = 'none';\n\n\t            return {\n\t                spaceWidth: spaceWidth,\n\t                lineCount: lineCount,\n\t                boundingBox: stagingTextBBox,\n\t                words: wordWidths\n\t            };\n\t        } else {\n\t            //todo: canvas fallback for measuring text on android 2.3\n\t            return false;\n\t        }\n\t    };\n\t})();\n\n\t//Helpers\n\n\t/**\n\t * Prevents a function from being called too often, waits until a timer elapses to call it again\n\t *\n\t * @param fn Function to call\n\t */\n\tfunction debounce(fn) {\n\t    if (!App.vars.debounceTimer) fn.call(this);\n\t    if (App.vars.debounceTimer) global.clearTimeout(App.vars.debounceTimer);\n\t    App.vars.debounceTimer = global.setTimeout(function() {\n\t        App.vars.debounceTimer = null;\n\t        fn.call(this);\n\t    }, App.setup.debounce);\n\t}\n\n\t/**\n\t * Holder-specific resize/orientation change callback, debounced to prevent excessive execution\n\t */\n\tfunction resizeEvent() {\n\t    debounce(function() {\n\t        updateResizableElements(null);\n\t    });\n\t}\n\n\t//Set up flags\n\n\tfor (var flag in App.flags) {\n\t    if (!App.flags.hasOwnProperty(flag)) continue;\n\t    App.flags[flag].match = function(val) {\n\t        return val.match(this.regex);\n\t    };\n\t}\n\n\t//Properties set once on setup\n\n\tApp.setup = {\n\t    renderer: 'html',\n\t    debounce: 100,\n\t    ratio: 1,\n\t    supportsCanvas: false,\n\t    supportsSVG: false,\n\t    lineWrapRatio: 0.9,\n\t    dataAttr: 'data-src',\n\t    renderers: ['html', 'canvas', 'svg']\n\t};\n\n\t//Properties modified during runtime\n\n\tApp.vars = {\n\t    preempted: false,\n\t    resizableImages: [],\n\t    invisibleImages: {},\n\t    invisibleId: 0,\n\t    visibilityCheckStarted: false,\n\t    debounceTimer: null,\n\t    cache: {}\n\t};\n\n\t//Pre-flight\n\n\t(function() {\n\t    var canvas = DOM.newEl('canvas');\n\n\t    if (canvas.getContext) {\n\t        if (canvas.toDataURL('image/png').indexOf('data:image/png') != -1) {\n\t            App.setup.renderer = 'canvas';\n\t            App.setup.supportsCanvas = true;\n\t        }\n\t    }\n\n\t    if (!!document.createElementNS && !!document.createElementNS(SVG_NS, 'svg').createSVGRect) {\n\t        App.setup.renderer = 'svg';\n\t        App.setup.supportsSVG = true;\n\t    }\n\t})();\n\n\t//Starts checking for invisible placeholders\n\tstartVisibilityCheck();\n\n\tif (onDomReady) {\n\t    onDomReady(function() {\n\t        if (!App.vars.preempted) {\n\t            Holder.run();\n\t        }\n\t        if (global.addEventListener) {\n\t            global.addEventListener('resize', resizeEvent, false);\n\t            global.addEventListener('orientationchange', resizeEvent, false);\n\t        } else {\n\t            global.attachEvent('onresize', resizeEvent);\n\t        }\n\n\t        if (typeof global.Turbolinks == 'object') {\n\t            global.document.addEventListener('page:change', function() {\n\t                Holder.run();\n\t            });\n\t        }\n\t    });\n\t}\n\n\tmodule.exports = Holder;\n\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t/*!\n\t * onDomReady.js 1.4.0 (c) 2013 Tubal Martin - MIT license\n\t *\n\t * Specially modified to work with Holder.js\n\t */\n\n\tfunction _onDomReady(win) {\n\t    //Lazy loading fix for Firefox < 3.6\n\t    //http://webreflection.blogspot.com/2009/11/195-chars-to-help-lazy-loading.html\n\t    if (document.readyState == null && document.addEventListener) {\n\t        document.addEventListener(\"DOMContentLoaded\", function DOMContentLoaded() {\n\t            document.removeEventListener(\"DOMContentLoaded\", DOMContentLoaded, false);\n\t            document.readyState = \"complete\";\n\t        }, false);\n\t        document.readyState = \"loading\";\n\t    }\n\t    \n\t    var doc = win.document,\n\t        docElem = doc.documentElement,\n\t    \n\t        LOAD = \"load\",\n\t        FALSE = false,\n\t        ONLOAD = \"on\"+LOAD,\n\t        COMPLETE = \"complete\",\n\t        READYSTATE = \"readyState\",\n\t        ATTACHEVENT = \"attachEvent\",\n\t        DETACHEVENT = \"detachEvent\",\n\t        ADDEVENTLISTENER = \"addEventListener\",\n\t        DOMCONTENTLOADED = \"DOMContentLoaded\",\n\t        ONREADYSTATECHANGE = \"onreadystatechange\",\n\t        REMOVEEVENTLISTENER = \"removeEventListener\",\n\t    \n\t        // W3C Event model\n\t        w3c = ADDEVENTLISTENER in doc,\n\t        _top = FALSE,\n\t    \n\t        // isReady: Is the DOM ready to be used? Set to true once it occurs.\n\t        isReady = FALSE,\n\t    \n\t        // Callbacks pending execution until DOM is ready\n\t        callbacks = [];\n\t    \n\t    // Handle when the DOM is ready\n\t    function ready( fn ) {\n\t        if ( !isReady ) {\n\t    \n\t            // Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).\n\t            if ( !doc.body ) {\n\t                return defer( ready );\n\t            }\n\t    \n\t            // Remember that the DOM is ready\n\t            isReady = true;\n\t    \n\t            // Execute all callbacks\n\t            while ( fn = callbacks.shift() ) {\n\t                defer( fn );\n\t            }\n\t        }\n\t    }\n\t    \n\t    // The ready event handler\n\t    function completed( event ) {\n\t        // readyState === \"complete\" is good enough for us to call the dom ready in oldIE\n\t        if ( w3c || event.type === LOAD || doc[READYSTATE] === COMPLETE ) {\n\t            detach();\n\t            ready();\n\t        }\n\t    }\n\t    \n\t    // Clean-up method for dom ready events\n\t    function detach() {\n\t        if ( w3c ) {\n\t            doc[REMOVEEVENTLISTENER]( DOMCONTENTLOADED, completed, FALSE );\n\t            win[REMOVEEVENTLISTENER]( LOAD, completed, FALSE );\n\t        } else {\n\t            doc[DETACHEVENT]( ONREADYSTATECHANGE, completed );\n\t            win[DETACHEVENT]( ONLOAD, completed );\n\t        }\n\t    }\n\t    \n\t    // Defers a function, scheduling it to run after the current call stack has cleared.\n\t    function defer( fn, wait ) {\n\t        // Allow 0 to be passed\n\t        setTimeout( fn, +wait >= 0 ? wait : 1 );\n\t    }\n\t    \n\t    // Attach the listeners:\n\t    \n\t    // Catch cases where onDomReady is called after the browser event has already occurred.\n\t    // we once tried to use readyState \"interactive\" here, but it caused issues like the one\n\t    // discovered by ChrisS here: http://bugs.jquery.com/ticket/12282#comment:15\n\t    if ( doc[READYSTATE] === COMPLETE ) {\n\t        // Handle it asynchronously to allow scripts the opportunity to delay ready\n\t        defer( ready );\n\t    \n\t    // Standards-based browsers support DOMContentLoaded\n\t    } else if ( w3c ) {\n\t        // Use the handy event callback\n\t        doc[ADDEVENTLISTENER]( DOMCONTENTLOADED, completed, FALSE );\n\t    \n\t        // A fallback to window.onload, that will always work\n\t        win[ADDEVENTLISTENER]( LOAD, completed, FALSE );\n\t    \n\t    // If IE event model is used\n\t    } else {\n\t        // Ensure firing before onload, maybe late but safe also for iframes\n\t        doc[ATTACHEVENT]( ONREADYSTATECHANGE, completed );\n\t    \n\t        // A fallback to window.onload, that will always work\n\t        win[ATTACHEVENT]( ONLOAD, completed );\n\t    \n\t        // If IE and not a frame\n\t        // continually check to see if the document is ready\n\t        try {\n\t            _top = win.frameElement == null && docElem;\n\t        } catch(e) {}\n\t    \n\t        if ( _top && _top.doScroll ) {\n\t            (function doScrollCheck() {\n\t                if ( !isReady ) {\n\t                    try {\n\t                        // Use the trick by Diego Perini\n\t                        // http://javascript.nwbox.com/IEContentLoaded/\n\t                        _top.doScroll(\"left\");\n\t                    } catch(e) {\n\t                        return defer( doScrollCheck, 50 );\n\t                    }\n\t    \n\t                    // detach all dom ready events\n\t                    detach();\n\t    \n\t                    // and execute any waiting functions\n\t                    ready();\n\t                }\n\t            })();\n\t        }\n\t    }\n\t    \n\t    function onDomReady( fn ) {\n\t        // If DOM is ready, execute the function (async), otherwise wait\n\t        isReady ? defer( fn ) : callbacks.push( fn );\n\t    }\n\t    \n\t    // Add version\n\t    onDomReady.version = \"1.4.0\";\n\t    // Add method to check if DOM is ready\n\t    onDomReady.isReady = function(){\n\t        return isReady;\n\t    };\n\n\t    return onDomReady;\n\t}\n\n\tmodule.exports = typeof window !== \"undefined\" && _onDomReady(window);\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t//Modified version of component/querystring\n\t//Changes: updated dependencies, dot notation parsing, JSHint fixes\n\t//Fork at https://github.com/imsky/querystring\n\n\t/**\n\t * Module dependencies.\n\t */\n\n\tvar encode = encodeURIComponent;\n\tvar decode = decodeURIComponent;\n\tvar trim = __webpack_require__(4);\n\tvar type = __webpack_require__(5);\n\n\tvar arrayRegex = /(\\w+)\\[(\\d+)\\]/;\n\tvar objectRegex = /\\w+\\.\\w+/;\n\n\t/**\n\t * Parse the given query `str`.\n\t *\n\t * @param {String} str\n\t * @return {Object}\n\t * @api public\n\t */\n\n\texports.parse = function(str){\n\t  if ('string' !== typeof str) return {};\n\n\t  str = trim(str);\n\t  if ('' === str) return {};\n\t  if ('?' === str.charAt(0)) str = str.slice(1);\n\n\t  var obj = {};\n\t  var pairs = str.split('&');\n\t  for (var i = 0; i < pairs.length; i++) {\n\t    var parts = pairs[i].split('=');\n\t    var key = decode(parts[0]);\n\t    var m, ctx, prop;\n\n\t    if (m = arrayRegex.exec(key)) {\n\t      obj[m[1]] = obj[m[1]] || [];\n\t      obj[m[1]][m[2]] = decode(parts[1]);\n\t      continue;\n\t    }\n\n\t    if (m = objectRegex.test(key)) {\n\t      m = key.split('.');\n\t      ctx = obj;\n\t      \n\t      while (m.length) {\n\t        prop = m.shift();\n\n\t        if (!prop.length) continue;\n\n\t        if (!ctx[prop]) {\n\t          ctx[prop] = {};\n\t        } else if (ctx[prop] && typeof ctx[prop] !== 'object') {\n\t          break;\n\t        }\n\n\t        if (!m.length) {\n\t          ctx[prop] = decode(parts[1]);\n\t        }\n\n\t        ctx = ctx[prop];\n\t      }\n\n\t      continue;\n\t    }\n\n\t    obj[parts[0]] = null == parts[1] ? '' : decode(parts[1]);\n\t  }\n\n\t  return obj;\n\t};\n\n\t/**\n\t * Stringify the given `obj`.\n\t *\n\t * @param {Object} obj\n\t * @return {String}\n\t * @api public\n\t */\n\n\texports.stringify = function(obj){\n\t  if (!obj) return '';\n\t  var pairs = [];\n\n\t  for (var key in obj) {\n\t    var value = obj[key];\n\n\t    if ('array' == type(value)) {\n\t      for (var i = 0; i < value.length; ++i) {\n\t        pairs.push(encode(key + '[' + i + ']') + '=' + encode(value[i]));\n\t      }\n\t      continue;\n\t    }\n\n\t    pairs.push(encode(key) + '=' + encode(obj[key]));\n\t  }\n\n\t  return pairs.join('&');\n\t};\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\n\texports = module.exports = trim;\n\n\tfunction trim(str){\n\t  return str.replace(/^\\s*|\\s*$/g, '');\n\t}\n\n\texports.left = function(str){\n\t  return str.replace(/^\\s*/, '');\n\t};\n\n\texports.right = function(str){\n\t  return str.replace(/\\s*$/, '');\n\t};\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t/**\n\t * toString ref.\n\t */\n\n\tvar toString = Object.prototype.toString;\n\n\t/**\n\t * Return the type of `val`.\n\t *\n\t * @param {Mixed} val\n\t * @return {String}\n\t * @api public\n\t */\n\n\tmodule.exports = function(val){\n\t  switch (toString.call(val)) {\n\t    case '[object Date]': return 'date';\n\t    case '[object RegExp]': return 'regexp';\n\t    case '[object Arguments]': return 'arguments';\n\t    case '[object Array]': return 'array';\n\t    case '[object Error]': return 'error';\n\t  }\n\n\t  if (val === null) return 'null';\n\t  if (val === undefined) return 'undefined';\n\t  if (val !== val) return 'nan';\n\t  if (val && val.nodeType === 1) return 'element';\n\n\t  if (isBuffer(val)) return 'buffer';\n\n\t  val = val.valueOf\n\t    ? val.valueOf()\n\t    : Object.prototype.valueOf.apply(val);\n\n\t  return typeof val;\n\t};\n\n\t// code borrowed from https://github.com/feross/is-buffer/blob/master/index.js\n\tfunction isBuffer(obj) {\n\t  return !!(obj != null &&\n\t    (obj._isBuffer || // For Safari 5-7 (missing Object.prototype.constructor)\n\t      (obj.constructor &&\n\t      typeof obj.constructor.isBuffer === 'function' &&\n\t      obj.constructor.isBuffer(obj))\n\t    ))\n\t}\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\tvar SceneGraph = function(sceneProperties) {\n\t    var nodeCount = 1;\n\n\t    //todo: move merge to helpers section\n\t    function merge(parent, child) {\n\t        for (var prop in child) {\n\t            parent[prop] = child[prop];\n\t        }\n\t        return parent;\n\t    }\n\n\t    var SceneNode = function(name) {\n\t        nodeCount++;\n\t        this.parent = null;\n\t        this.children = {};\n\t        this.id = nodeCount;\n\t        this.name = 'n' + nodeCount;\n\t        if (typeof name !== 'undefined') {\n\t            this.name = name;\n\t        }\n\t        this.x = this.y = this.z = 0;\n\t        this.width = this.height = 0;\n\t    };\n\n\t    SceneNode.prototype.resize = function(width, height) {\n\t        if (width != null) {\n\t            this.width = width;\n\t        }\n\t        if (height != null) {\n\t            this.height = height;\n\t        }\n\t    };\n\n\t    SceneNode.prototype.moveTo = function(x, y, z) {\n\t        this.x = x != null ? x : this.x;\n\t        this.y = y != null ? y : this.y;\n\t        this.z = z != null ? z : this.z;\n\t    };\n\n\t    SceneNode.prototype.add = function(child) {\n\t        var name = child.name;\n\t        if (typeof this.children[name] === 'undefined') {\n\t            this.children[name] = child;\n\t            child.parent = this;\n\t        } else {\n\t            throw 'SceneGraph: child already exists: ' + name;\n\t        }\n\t    };\n\n\t    var RootNode = function() {\n\t        SceneNode.call(this, 'root');\n\t        this.properties = sceneProperties;\n\t    };\n\n\t    RootNode.prototype = new SceneNode();\n\n\t    var Shape = function(name, props) {\n\t        SceneNode.call(this, name);\n\t        this.properties = {\n\t            'fill': '#000000'\n\t        };\n\t        if (typeof props !== 'undefined') {\n\t            merge(this.properties, props);\n\t        } else if (typeof name !== 'undefined' && typeof name !== 'string') {\n\t            throw 'SceneGraph: invalid node name';\n\t        }\n\t    };\n\n\t    Shape.prototype = new SceneNode();\n\n\t    var Group = function() {\n\t        Shape.apply(this, arguments);\n\t        this.type = 'group';\n\t    };\n\n\t    Group.prototype = new Shape();\n\n\t    var Rect = function() {\n\t        Shape.apply(this, arguments);\n\t        this.type = 'rect';\n\t    };\n\n\t    Rect.prototype = new Shape();\n\n\t    var Text = function(text) {\n\t        Shape.call(this);\n\t        this.type = 'text';\n\t        this.properties.text = text;\n\t    };\n\n\t    Text.prototype = new Shape();\n\n\t    var root = new RootNode();\n\n\t    this.Shape = {\n\t        'Rect': Rect,\n\t        'Text': Text,\n\t        'Group': Group\n\t    };\n\n\t    this.root = root;\n\t    return this;\n\t};\n\n\tmodule.exports = SceneGraph;\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {/**\n\t * Shallow object clone and merge\n\t *\n\t * @param a Object A\n\t * @param b Object B\n\t * @returns {Object} New object with all of A's properties, and all of B's properties, overwriting A's properties\n\t */\n\texports.extend = function(a, b) {\n\t    var c = {};\n\t    for (var x in a) {\n\t        if (a.hasOwnProperty(x)) {\n\t            c[x] = a[x];\n\t        }\n\t    }\n\t    if (b != null) {\n\t        for (var y in b) {\n\t            if (b.hasOwnProperty(y)) {\n\t                c[y] = b[y];\n\t            }\n\t        }\n\t    }\n\t    return c;\n\t};\n\n\t/**\n\t * Takes a k/v list of CSS properties and returns a rule\n\t *\n\t * @param props CSS properties object\n\t */\n\texports.cssProps = function(props) {\n\t    var ret = [];\n\t    for (var p in props) {\n\t        if (props.hasOwnProperty(p)) {\n\t            ret.push(p + ':' + props[p]);\n\t        }\n\t    }\n\t    return ret.join(';');\n\t};\n\n\t/**\n\t * Encodes HTML entities in a string\n\t *\n\t * @param str Input string\n\t */\n\texports.encodeHtmlEntity = function(str) {\n\t    var buf = [];\n\t    var charCode = 0;\n\t    for (var i = str.length - 1; i >= 0; i--) {\n\t        charCode = str.charCodeAt(i);\n\t        if (charCode > 128) {\n\t            buf.unshift(['&#', charCode, ';'].join(''));\n\t        } else {\n\t            buf.unshift(str[i]);\n\t        }\n\t    }\n\t    return buf.join('');\n\t};\n\n\t/**\n\t * Checks if an image exists\n\t *\n\t * @param src URL of image\n\t * @param callback Callback to call once image status has been found\n\t */\n\texports.imageExists = function(src, callback) {\n\t    var image = new Image();\n\t    image.onerror = function() {\n\t        callback.call(this, false);\n\t    };\n\t    image.onload = function() {\n\t        callback.call(this, true);\n\t    };\n\t    image.src = src;\n\t};\n\n\t/**\n\t * Decodes HTML entities in a string\n\t *\n\t * @param str Input string\n\t */\n\texports.decodeHtmlEntity = function(str) {\n\t    return str.replace(/&#(\\d+);/g, function(match, dec) {\n\t        return String.fromCharCode(dec);\n\t    });\n\t};\n\n\n\t/**\n\t * Returns an element's dimensions if it's visible, `false` otherwise.\n\t *\n\t * @param el DOM element\n\t */\n\texports.dimensionCheck = function(el) {\n\t    var dimensions = {\n\t        height: el.clientHeight,\n\t        width: el.clientWidth\n\t    };\n\n\t    if (dimensions.height && dimensions.width) {\n\t        return dimensions;\n\t    } else {\n\t        return false;\n\t    }\n\t};\n\n\n\t/**\n\t * Returns true if value is truthy or if it is \"semantically truthy\"\n\t * @param val\n\t */\n\texports.truthy = function(val) {\n\t    if (typeof val === 'string') {\n\t        return val === 'true' || val === 'yes' || val === '1' || val === 'on' || val === 'â';\n\t    }\n\t    return !!val;\n\t};\n\n\t/**\n\t * Parses input into a well-formed CSS color\n\t * @param val\n\t */\n\texports.parseColor = function(val) {\n\t    var hexre = /(^(?:#?)[0-9a-f]{6}$)|(^(?:#?)[0-9a-f]{3}$)/i;\n\t    var rgbre = /^rgb\\((\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/;\n\t    var rgbare = /^rgba\\((\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(0\\.\\d{1,}|1)\\)$/;\n\n\t    var match = val.match(hexre);\n\t    var retval;\n\n\t    if (match !== null) {\n\t        retval = match[1] || match[2];\n\t        if (retval[0] !== '#') {\n\t            return '#' + retval;\n\t        } else {\n\t            return retval;\n\t        }\n\t    }\n\n\t    match = val.match(rgbre);\n\n\t    if (match !== null) {\n\t        retval = 'rgb(' + match.slice(1).join(',') + ')';\n\t        return retval;\n\t    }\n\n\t    match = val.match(rgbare);\n\n\t    if (match !== null) {\n\t        retval = 'rgba(' + match.slice(1).join(',') + ')';\n\t        return retval;\n\t    }\n\n\t    return null;\n\t};\n\n\t/**\n\t * Provides the correct scaling ratio for canvas drawing operations on HiDPI screens (e.g. Retina displays)\n\t */\n\texports.canvasRatio = function () {\n\t    var devicePixelRatio = 1;\n\t    var backingStoreRatio = 1;\n\n\t    if (global.document) {\n\t        var canvas = global.document.createElement('canvas');\n\t        if (canvas.getContext) {\n\t            var ctx = canvas.getContext('2d');\n\t            devicePixelRatio = global.devicePixelRatio || 1;\n\t            backingStoreRatio = ctx.webkitBackingStorePixelRatio || ctx.mozBackingStorePixelRatio || ctx.msBackingStorePixelRatio || ctx.oBackingStorePixelRatio || ctx.backingStorePixelRatio || 1;\n\t        }\n\t    }\n\n\t    return devicePixelRatio / backingStoreRatio;\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {var DOM = __webpack_require__(9);\n\n\tvar SVG_NS = 'http://www.w3.org/2000/svg';\n\tvar NODE_TYPE_COMMENT = 8;\n\n\t/**\n\t * Generic SVG element creation function\n\t *\n\t * @param svg SVG context, set to null if new\n\t * @param width Document width\n\t * @param height Document height\n\t */\n\texports.initSVG = function(svg, width, height) {\n\t    var defs, style, initialize = false;\n\n\t    if (svg && svg.querySelector) {\n\t        style = svg.querySelector('style');\n\t        if (style === null) {\n\t            initialize = true;\n\t        }\n\t    } else {\n\t        svg = DOM.newEl('svg', SVG_NS);\n\t        initialize = true;\n\t    }\n\n\t    if (initialize) {\n\t        defs = DOM.newEl('defs', SVG_NS);\n\t        style = DOM.newEl('style', SVG_NS);\n\t        DOM.setAttr(style, {\n\t            'type': 'text/css'\n\t        });\n\t        defs.appendChild(style);\n\t        svg.appendChild(defs);\n\t    }\n\n\t    //IE throws an exception if this is set and Chrome requires it to be set\n\t    if (svg.webkitMatchesSelector) {\n\t        svg.setAttribute('xmlns', SVG_NS);\n\t    }\n\n\t    //Remove comment nodes\n\t    for (var i = 0; i < svg.childNodes.length; i++) {\n\t        if (svg.childNodes[i].nodeType === NODE_TYPE_COMMENT) {\n\t            svg.removeChild(svg.childNodes[i]);\n\t        }\n\t    }\n\n\t    //Remove CSS\n\t    while (style.childNodes.length) {\n\t        style.removeChild(style.childNodes[0]);\n\t    }\n\n\t    DOM.setAttr(svg, {\n\t        'width': width,\n\t        'height': height,\n\t        'viewBox': '0 0 ' + width + ' ' + height,\n\t        'preserveAspectRatio': 'none'\n\t    });\n\n\t    return svg;\n\t};\n\n\t/**\n\t * Converts serialized SVG to a string suitable for data URI use\n\t * @param svgString Serialized SVG string\n\t * @param [base64] Use base64 encoding for data URI\n\t */\n\texports.svgStringToDataURI = function() {\n\t    var rawPrefix = 'data:image/svg+xml;charset=UTF-8,';\n\t    var base64Prefix = 'data:image/svg+xml;charset=UTF-8;base64,';\n\n\t    return function(svgString, base64) {\n\t        if (base64) {\n\t            return base64Prefix + btoa(global.unescape(encodeURIComponent(svgString)));\n\t        } else {\n\t            return rawPrefix + encodeURIComponent(svgString);\n\t        }\n\t    };\n\t}();\n\n\t/**\n\t * Returns serialized SVG with XML processing instructions\n\t *\n\t * @param svg SVG context\n\t * @param stylesheets CSS stylesheets to include\n\t */\n\texports.serializeSVG = function(svg, engineSettings) {\n\t    if (!global.XMLSerializer) return;\n\t    var serializer = new XMLSerializer();\n\t    var svgCSS = '';\n\t    var stylesheets = engineSettings.stylesheets;\n\n\t    //External stylesheets: Processing Instruction method\n\t    if (engineSettings.svgXMLStylesheet) {\n\t        var xml = DOM.createXML();\n\t        //Add <?xml-stylesheet ?> directives\n\t        for (var i = stylesheets.length - 1; i >= 0; i--) {\n\t            var csspi = xml.createProcessingInstruction('xml-stylesheet', 'href=\"' + stylesheets[i] + '\" rel=\"stylesheet\"');\n\t            xml.insertBefore(csspi, xml.firstChild);\n\t        }\n\n\t        xml.removeChild(xml.documentElement);\n\t        svgCSS = serializer.serializeToString(xml);\n\t    }\n\n\t    var svgText = serializer.serializeToString(svg);\n\t    svgText = svgText.replace(/\\&amp;(\\#[0-9]{2,}\\;)/g, '&$1');\n\t    return svgCSS + svgText;\n\t};\n\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {/**\n\t * Generic new DOM element function\n\t *\n\t * @param tag Tag to create\n\t * @param namespace Optional namespace value\n\t */\n\texports.newEl = function(tag, namespace) {\n\t    if (!global.document) return;\n\n\t    if (namespace == null) {\n\t        return global.document.createElement(tag);\n\t    } else {\n\t        return global.document.createElementNS(namespace, tag);\n\t    }\n\t};\n\n\t/**\n\t * Generic setAttribute function\n\t *\n\t * @param el Reference to DOM element\n\t * @param attrs Object with attribute keys and values\n\t */\n\texports.setAttr = function (el, attrs) {\n\t    for (var a in attrs) {\n\t        el.setAttribute(a, attrs[a]);\n\t    }\n\t};\n\n\t/**\n\t * Creates a XML document\n\t * @private\n\t */\n\texports.createXML = function() {\n\t    if (!global.DOMParser) return;\n\t    return new DOMParser().parseFromString('<xml />', 'application/xml');\n\t};\n\n\t/**\n\t * Converts a value into an array of DOM nodes\n\t *\n\t * @param val A string, a NodeList, a Node, or an HTMLCollection\n\t */\n\texports.getNodeArray = function(val) {\n\t    var retval = null;\n\t    if (typeof(val) == 'string') {\n\t        retval = document.querySelectorAll(val);\n\t    } else if (global.NodeList && val instanceof global.NodeList) {\n\t        retval = val;\n\t    } else if (global.Node && val instanceof global.Node) {\n\t        retval = [val];\n\t    } else if (global.HTMLCollection && val instanceof global.HTMLCollection) {\n\t        retval = val;\n\t    } else if (val instanceof Array) {\n\t        retval = val;\n\t    } else if (val === null) {\n\t        retval = [];\n\t    }\n\n\t    retval = Array.prototype.slice.call(retval);\n\n\t    return retval;\n\t};\n\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\tvar Color = function(color, options) {\n\t    //todo: support rgba, hsla, and rrggbbaa notation\n\t    //todo: use CIELAB internally\n\t    //todo: add clamp function (with sign)\n\t    if (typeof color !== 'string') return;\n\n\t    this.original = color;\n\n\t    if (color.charAt(0) === '#') {\n\t        color = color.slice(1);\n\t    }\n\n\t    if (/[^a-f0-9]+/i.test(color)) return;\n\n\t    if (color.length === 3) {\n\t        color = color.replace(/./g, '$&$&');\n\t    }\n\n\t    if (color.length !== 6) return;\n\n\t    this.alpha = 1;\n\n\t    if (options && options.alpha) {\n\t        this.alpha = options.alpha;\n\t    }\n\n\t    this.set(parseInt(color, 16));\n\t};\n\n\t//todo: jsdocs\n\tColor.rgb2hex = function(r, g, b) {\n\t    function format (decimal) {\n\t        var hex = (decimal | 0).toString(16);\n\t        if (decimal < 16) {\n\t            hex = '0' + hex;\n\t        }\n\t        return hex;\n\t    }\n\n\t    return [r, g, b].map(format).join('');\n\t};\n\n\t//todo: jsdocs\n\tColor.hsl2rgb = function (h, s, l) {\n\t    var H = h / 60;\n\t    var C = (1 - Math.abs(2 * l - 1)) * s;\n\t    var X = C * (1 - Math.abs(parseInt(H) % 2 - 1));\n\t    var m = l - (C / 2);\n\n\t    var r = 0, g = 0, b = 0;\n\n\t    if (H >= 0 && H < 1) {\n\t        r = C;\n\t        g = X;\n\t    } else if (H >= 1 && H < 2) {\n\t        r = X;\n\t        g = C;\n\t    } else if (H >= 2 && H < 3) {\n\t        g = C;\n\t        b = X;\n\t    } else if (H >= 3 && H < 4) {\n\t        g = X;\n\t        b = C;\n\t    } else if (H >= 4 && H < 5) {\n\t        r = X;\n\t        b = C;\n\t    } else if (H >= 5 && H < 6) {\n\t        r = C;\n\t        b = X;\n\t    }\n\n\t    r += m;\n\t    g += m;\n\t    b += m;\n\n\t    r = parseInt(r * 255);\n\t    g = parseInt(g * 255);\n\t    b = parseInt(b * 255);\n\n\t    return [r, g, b];\n\t};\n\n\t/**\n\t * Sets the color from a raw RGB888 integer\n\t * @param raw RGB888 representation of color\n\t */\n\t//todo: refactor into a static method\n\t//todo: factor out individual color spaces\n\t//todo: add HSL, CIELAB, and CIELUV\n\tColor.prototype.set = function (val) {\n\t    this.raw = val;\n\n\t    var r = (this.raw & 0xFF0000) >> 16;\n\t    var g = (this.raw & 0x00FF00) >> 8;\n\t    var b = (this.raw & 0x0000FF);\n\n\t    // BT.709\n\t    var y = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n\t    var u = -0.09991 * r - 0.33609 * g + 0.436 * b;\n\t    var v = 0.615 * r - 0.55861 * g - 0.05639 * b;\n\n\t    this.rgb = {\n\t        r: r,\n\t        g: g,\n\t        b: b\n\t    };\n\n\t    this.yuv = {\n\t        y: y,\n\t        u: u,\n\t        v: v\n\t    };\n\n\t    return this;\n\t};\n\n\t/**\n\t * Lighten or darken a color\n\t * @param multiplier Amount to lighten or darken (-1 to 1)\n\t */\n\tColor.prototype.lighten = function(multiplier) {\n\t    var cm = Math.min(1, Math.max(0, Math.abs(multiplier))) * (multiplier < 0 ? -1 : 1);\n\t    var bm = (255 * cm) | 0;\n\t    var cr = Math.min(255, Math.max(0, this.rgb.r + bm));\n\t    var cg = Math.min(255, Math.max(0, this.rgb.g + bm));\n\t    var cb = Math.min(255, Math.max(0, this.rgb.b + bm));\n\t    var hex = Color.rgb2hex(cr, cg, cb);\n\t    return new Color(hex);\n\t};\n\n\t/**\n\t * Output color in hex format\n\t * @param addHash Add a hash character to the beginning of the output\n\t */\n\tColor.prototype.toHex = function(addHash) {\n\t    return (addHash ? '#' : '') + this.raw.toString(16);\n\t};\n\n\t/**\n\t * Returns whether or not current color is lighter than another color\n\t * @param color Color to compare against\n\t */\n\tColor.prototype.lighterThan = function(color) {\n\t    if (!(color instanceof Color)) {\n\t        color = new Color(color);\n\t    }\n\n\t    return this.yuv.y > color.yuv.y;\n\t};\n\n\t/**\n\t * Returns the result of mixing current color with another color\n\t * @param color Color to mix with\n\t * @param multiplier How much to mix with the other color\n\t */\n\t/*\n\tColor.prototype.mix = function (color, multiplier) {\n\t    if (!(color instanceof Color)) {\n\t        color = new Color(color);\n\t    }\n\n\t    var r = this.rgb.r;\n\t    var g = this.rgb.g;\n\t    var b = this.rgb.b;\n\t    var a = this.alpha;\n\n\t    var m = typeof multiplier !== 'undefined' ? multiplier : 0.5;\n\n\t    //todo: write a lerp function\n\t    r = r + m * (color.rgb.r - r);\n\t    g = g + m * (color.rgb.g - g);\n\t    b = b + m * (color.rgb.b - b);\n\t    a = a + m * (color.alpha - a);\n\n\t    return new Color(Color.rgbToHex(r, g, b), {\n\t        'alpha': a\n\t    });\n\t};\n\t*/\n\n\t/**\n\t * Returns the result of blending another color on top of current color with alpha\n\t * @param color Color to blend on top of current color, i.e. \"Ca\"\n\t */\n\t//todo: see if .blendAlpha can be merged into .mix\n\tColor.prototype.blendAlpha = function(color) {\n\t    if (!(color instanceof Color)) {\n\t        color = new Color(color);\n\t    }\n\n\t    var Ca = color;\n\t    var Cb = this;\n\n\t    //todo: write alpha blending function\n\t    var r = Ca.alpha * Ca.rgb.r + (1 - Ca.alpha) * Cb.rgb.r;\n\t    var g = Ca.alpha * Ca.rgb.g + (1 - Ca.alpha) * Cb.rgb.g;\n\t    var b = Ca.alpha * Ca.rgb.b + (1 - Ca.alpha) * Cb.rgb.b;\n\n\t    return new Color(Color.rgb2hex(r, g, b));\n\t};\n\n\tmodule.exports = Color;\n\n\n/***/ },\n/* 11 */\n/***/ function(module, exports) {\n\n\tmodule.exports = {\n\t  'version': '2.9.4',\n\t  'svg_ns': 'http://www.w3.org/2000/svg'\n\t};\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar shaven = __webpack_require__(13);\n\n\tvar SVG = __webpack_require__(8);\n\tvar constants = __webpack_require__(11);\n\tvar utils = __webpack_require__(7);\n\n\tvar SVG_NS = constants.svg_ns;\n\n\tvar templates = {\n\t  'element': function (options) {\n\t    var tag = options.tag;\n\t    var content = options.content || '';\n\t    delete options.tag;\n\t    delete options.content;\n\t    return  [tag, content, options];\n\t  }\n\t};\n\n\t//todo: deprecate tag arg, infer tag from shape object\n\tfunction convertShape (shape, tag) {\n\t  return templates.element({\n\t    'tag': tag,\n\t    'width': shape.width,\n\t    'height': shape.height,\n\t    'fill': shape.properties.fill\n\t  });\n\t}\n\n\tfunction textCss (properties) {\n\t  return utils.cssProps({\n\t    'fill': properties.fill,\n\t    'font-weight': properties.font.weight,\n\t    'font-family': properties.font.family + ', monospace',\n\t    'font-size': properties.font.size + properties.font.units\n\t  });\n\t}\n\n\tfunction outlinePath (bgWidth, bgHeight, outlineWidth) {\n\t  var outlineOffsetWidth = outlineWidth / 2;\n\n\t  return [\n\t    'M', outlineOffsetWidth, outlineOffsetWidth,\n\t    'H', bgWidth - outlineOffsetWidth,\n\t    'V', bgHeight - outlineOffsetWidth,\n\t    'H', outlineOffsetWidth,\n\t    'V', 0,\n\t    'M', 0, outlineOffsetWidth,\n\t    'L', bgWidth, bgHeight - outlineOffsetWidth,\n\t    'M', 0, bgHeight - outlineOffsetWidth,\n\t    'L', bgWidth, outlineOffsetWidth\n\t  ].join(' ');\n\t}\n\n\tmodule.exports = function (sceneGraph, renderSettings) {\n\t  var engineSettings = renderSettings.engineSettings;\n\t  var stylesheets = engineSettings.stylesheets;\n\t  var stylesheetXml = stylesheets.map(function (stylesheet) {\n\t    return '<?xml-stylesheet rel=\"stylesheet\" href=\"' + stylesheet + '\"?>';\n\t  }).join('\\n');\n\n\t  var holderId = 'holder_' + Number(new Date()).toString(16);\n\n\t  var root = sceneGraph.root;\n\t  var textGroup = root.children.holderTextGroup;\n\n\t  var css = '#' + holderId + ' text { ' + textCss(textGroup.properties) + ' } ';\n\n\t  // push text down to be equally vertically aligned with canvas renderer\n\t  textGroup.y += textGroup.textPositionData.boundingBox.height * 0.8;\n\n\t  var wordTags = [];\n\n\t  Object.keys(textGroup.children).forEach(function (lineKey) {\n\t    var line = textGroup.children[lineKey];\n\n\t    Object.keys(line.children).forEach(function (wordKey) {\n\t      var word = line.children[wordKey];\n\t      var x = textGroup.x + line.x + word.x;\n\t      var y = textGroup.y + line.y + word.y;\n\n\t      var wordTag = templates.element({\n\t        'tag': 'text',\n\t        'content': word.properties.text,\n\t        'x': x,\n\t        'y': y\n\t      });\n\n\t      wordTags.push(wordTag);\n\t    });\n\t  });\n\n\t  var text = templates.element({\n\t    'tag': 'g',\n\t    'content': wordTags\n\t  });\n\n\t  var outline = null;\n\n\t  if (root.children.holderBg.properties.outline) {\n\t    var outlineProperties = root.children.holderBg.properties.outline;\n\t    outline = templates.element({\n\t      'tag': 'path',\n\t      'd': outlinePath(root.children.holderBg.width, root.children.holderBg.height, outlineProperties.width),\n\t      'stroke-width': outlineProperties.width,\n\t      'stroke': outlineProperties.fill,\n\t      'fill': 'none'\n\t    });\n\t  }\n\n\t  var bg = convertShape(root.children.holderBg, 'rect');\n\n\t  var sceneContent = [];\n\n\t  sceneContent.push(bg);\n\t  if (outlineProperties) {\n\t    sceneContent.push(outline);\n\t  }\n\t  sceneContent.push(text);\n\n\t  var scene = templates.element({\n\t    'tag': 'g',\n\t    'id': holderId,\n\t    'content': sceneContent\n\t  });\n\n\t  var style = templates.element({\n\t    'tag': 'style',\n\t    //todo: figure out how to add CDATA directive\n\t    'content': css,\n\t    'type': 'text/css'\n\t  });\n\n\t  var defs = templates.element({\n\t    'tag': 'defs',\n\t    'content': style\n\t  });\n\n\t  var svg = templates.element({\n\t    'tag': 'svg',\n\t    'content': [defs, scene],\n\t    'width': root.properties.width,\n\t    'height': root.properties.height,\n\t    'xmlns': SVG_NS,\n\t    'viewBox': [0, 0, root.properties.width, root.properties.height].join(' '),\n\t    'preserveAspectRatio': 'none'\n\t  });\n\n\t  var output = shaven(svg);\n\t  \n\t  output = stylesheetXml + output[0];\n\n\t  var svgString = SVG.svgStringToDataURI(output, renderSettings.mode === 'background');\n\t  return svgString;\n\t};\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar escape = __webpack_require__(14)\n\n\t// TODO: remove namespace\n\n\tmodule.exports = function shaven (array, namespace, returnObject) {\n\n\t\t'use strict'\n\n\t\tvar i = 1\n\t\tvar doesEscape = true\n\t\tvar HTMLString\n\t\tvar attributeKey\n\t\tvar callback\n\t\tvar key\n\n\n\t\treturnObject = returnObject || {}\n\n\n\t\tfunction createElement (sugarString) {\n\n\t\t\tvar tags = sugarString.match(/^[\\w-]+/)\n\t\t\tvar element = {\n\t\t\t\ttag: tags ? tags[0] : 'div',\n\t\t\t\tattr: {},\n\t\t\t\tchildren: []\n\t\t\t}\n\t\t\tvar id = sugarString.match(/#([\\w-]+)/)\n\t\t\tvar reference = sugarString.match(/\\$([\\w-]+)/)\n\t\t\tvar classNames = sugarString.match(/\\.[\\w-]+/g)\n\n\n\t\t\t// Assign id if is set\n\t\t\tif (id) {\n\t\t\t\telement.attr.id = id[1]\n\n\t\t\t\t// Add element to the return object\n\t\t\t\treturnObject[id[1]] = element\n\t\t\t}\n\n\t\t\tif (reference)\n\t\t\t\treturnObject[reference[1]] = element\n\n\t\t\tif (classNames)\n\t\t\t\telement.attr.class = classNames.join(' ').replace(/\\./g, '')\n\n\t\t\tif (sugarString.match(/&$/g))\n\t\t\t\tdoesEscape = false\n\n\t\t\treturn element\n\t\t}\n\n\t\tfunction replacer (key, value) {\n\n\t\t\tif (value === null || value === false || value === undefined)\n\t\t\t\treturn\n\n\t\t\tif (typeof value !== 'string' && typeof value !== 'object')\n\t\t\t\treturn String(value)\n\n\t\t\treturn value\n\t\t}\n\n\t\tfunction escapeAttribute (string) {\n\t\t\treturn (string || string === 0) ?\n\t\t\t\tString(string)\n\t\t\t\t\t.replace(/&/g, '&amp;')\n\t\t\t\t\t.replace(/\"/g, '&quot;') :\n\t\t\t\t''\n\t\t}\n\n\t\tfunction escapeHTML (string) {\n\t\t\treturn String(string)\n\t\t\t\t.replace(/&/g, '&amp;')\n\t\t\t\t.replace(/\"/g, '&quot;')\n\t\t\t\t.replace(/'/g, '&apos;')\n\t\t\t\t.replace(/</g, '&lt;')\n\t\t\t\t.replace(/>/g, '&gt;')\n\t\t}\n\n\n\t\tif (typeof array[0] === 'string')\n\t\t\tarray[0] = createElement(array[0])\n\n\t\telse if (Array.isArray(array[0]))\n\t\t\ti = 0\n\n\t\telse\n\t\t\tthrow new Error(\n\t\t\t\t'First element of array must be a string, ' +\n\t\t\t\t'or an array and not ' + JSON.stringify(array[0])\n\t\t\t)\n\n\n\t\tfor (; i < array.length; i++) {\n\n\t\t\t// Don't render element if value is false or null\n\t\t\tif (array[i] === false || array[i] === null) {\n\t\t\t\tarray[0] = false\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\t// Continue with next array value if current value is undefined or true\n\t\t\telse if (array[i] === undefined || array[i] === true) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\telse if (typeof array[i] === 'string') {\n\t\t\t\tif (doesEscape)\n\t\t\t\t\tarray[i] = escapeHTML(array[i])\n\n\t\t\t\tarray[0].children.push(array[i])\n\t\t\t}\n\n\t\t\telse if (typeof array[i] === 'number') {\n\n\t\t\t\tarray[0].children.push(array[i])\n\t\t\t}\n\n\t\t\telse if (Array.isArray(array[i])) {\n\n\t\t\t\tif (Array.isArray(array[i][0])) {\n\t\t\t\t\tarray[i].reverse().forEach(function (subArray) {\n\t\t\t\t\t\tarray.splice(i + 1, 0, subArray)\n\t\t\t\t\t})\n\n\t\t\t\t\tif (i !== 0)\n\t\t\t\t\t\tcontinue\n\t\t\t\t\ti++\n\t\t\t\t}\n\n\t\t\t\tshaven(array[i], namespace, returnObject)\n\n\t\t\t\tif (array[i][0])\n\t\t\t\t\tarray[0].children.push(array[i][0])\n\t\t\t}\n\n\t\t\telse if (typeof array[i] === 'function')\n\t\t\t\tcallback = array[i]\n\n\n\t\t\telse if (typeof array[i] === 'object') {\n\t\t\t\tfor (attributeKey in array[i])\n\t\t\t\t\tif (array[i].hasOwnProperty(attributeKey))\n\t\t\t\t\t\tif (array[i][attributeKey] !== null &&\n\t\t\t\t\t\t\tarray[i][attributeKey] !== false)\n\t\t\t\t\t\t\tif (attributeKey === 'style' &&\n\t\t\t\t\t\t\t\ttypeof array[i][attributeKey] === 'object')\n\t\t\t\t\t\t\t\tarray[0].attr[attributeKey] = JSON\n\t\t\t\t\t\t\t\t\t.stringify(array[i][attributeKey], replacer)\n\t\t\t\t\t\t\t\t\t.slice(2, -2)\n\t\t\t\t\t\t\t\t\t.replace(/\",\"/g, ';')\n\t\t\t\t\t\t\t\t\t.replace(/\":\"/g, ':')\n\t\t\t\t\t\t\t\t\t.replace(/\\\\\"/g, '\\'')\n\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tarray[0].attr[attributeKey] = array[i][attributeKey]\n\t\t\t}\n\n\t\t\telse\n\t\t\t\tthrow new TypeError('\"' + array[i] + '\" is not allowed as a value.')\n\t\t}\n\n\n\t\tif (array[0] !== false) {\n\n\t\t\tHTMLString = '<' + array[0].tag\n\n\t\t\tfor (key in array[0].attr)\n\t\t\t\tif (array[0].attr.hasOwnProperty(key))\n\t\t\t\t\tHTMLString += ' ' + key + '=\"' +\n\t\t\t\t\t\tescapeAttribute(array[0].attr[key]) + '\"'\n\n\t\t\tHTMLString += '>'\n\n\t\t\tarray[0].children.forEach(function (child) {\n\t\t\t\tHTMLString += child\n\t\t\t})\n\n\t\t\tHTMLString += '</' + array[0].tag + '>'\n\n\t\t\tarray[0] = HTMLString\n\t\t}\n\n\t\t// Return root element on index 0\n\t\treturnObject[0] = array[0]\n\n\t\tif (callback)\n\t\t\tcallback(array[0])\n\n\t\t// returns object containing all elements with an id and the root element\n\t\treturn returnObject\n\t}\n\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\t/*!\n\t * escape-html\n\t * Copyright(c) 2012-2013 TJ Holowaychuk\n\t * Copyright(c) 2015 Andreas Lubbe\n\t * Copyright(c) 2015 Tiancheng \"Timothy\" Gu\n\t * MIT Licensed\n\t */\n\n\t'use strict';\n\n\t/**\n\t * Module variables.\n\t * @private\n\t */\n\n\tvar matchHtmlRegExp = /[\"'&<>]/;\n\n\t/**\n\t * Module exports.\n\t * @public\n\t */\n\n\tmodule.exports = escapeHtml;\n\n\t/**\n\t * Escape special characters in the given string of html.\n\t *\n\t * @param  {string} string The string to escape for inserting into HTML\n\t * @return {string}\n\t * @public\n\t */\n\n\tfunction escapeHtml(string) {\n\t  var str = '' + string;\n\t  var match = matchHtmlRegExp.exec(str);\n\n\t  if (!match) {\n\t    return str;\n\t  }\n\n\t  var escape;\n\t  var html = '';\n\t  var index = 0;\n\t  var lastIndex = 0;\n\n\t  for (index = match.index; index < str.length; index++) {\n\t    switch (str.charCodeAt(index)) {\n\t      case 34: // \"\n\t        escape = '&quot;';\n\t        break;\n\t      case 38: // &\n\t        escape = '&amp;';\n\t        break;\n\t      case 39: // '\n\t        escape = '&#39;';\n\t        break;\n\t      case 60: // <\n\t        escape = '&lt;';\n\t        break;\n\t      case 62: // >\n\t        escape = '&gt;';\n\t        break;\n\t      default:\n\t        continue;\n\t    }\n\n\t    if (lastIndex !== index) {\n\t      html += str.substring(lastIndex, index);\n\t    }\n\n\t    lastIndex = index + 1;\n\t    html += escape;\n\t  }\n\n\t  return lastIndex !== index\n\t    ? html + str.substring(lastIndex, index)\n\t    : html;\n\t}\n\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar DOM = __webpack_require__(9);\n\tvar utils = __webpack_require__(7);\n\n\tmodule.exports = (function() {\n\t    var canvas = DOM.newEl('canvas');\n\t    var ctx = null;\n\n\t    return function(sceneGraph) {\n\t        if (ctx == null) {\n\t            ctx = canvas.getContext('2d');\n\t        }\n\n\t        var dpr = utils.canvasRatio();\n\t        var root = sceneGraph.root;\n\t        canvas.width = dpr * root.properties.width;\n\t        canvas.height = dpr * root.properties.height ;\n\t        ctx.textBaseline = 'middle';\n\n\t        var bg = root.children.holderBg;\n\t        var bgWidth = dpr * bg.width;\n\t        var bgHeight = dpr * bg.height;\n\t        //todo: parametrize outline width (e.g. in scene object)\n\t        var outlineWidth = 2;\n\t        var outlineOffsetWidth = outlineWidth / 2;\n\n\t        ctx.fillStyle = bg.properties.fill;\n\t        ctx.fillRect(0, 0, bgWidth, bgHeight);\n\n\t        if (bg.properties.outline) {\n\t            //todo: abstract this into a method\n\t            ctx.strokeStyle = bg.properties.outline.fill;\n\t            ctx.lineWidth = bg.properties.outline.width;\n\t            ctx.moveTo(outlineOffsetWidth, outlineOffsetWidth);\n\t            // TL, TR, BR, BL\n\t            ctx.lineTo(bgWidth - outlineOffsetWidth, outlineOffsetWidth);\n\t            ctx.lineTo(bgWidth - outlineOffsetWidth, bgHeight - outlineOffsetWidth);\n\t            ctx.lineTo(outlineOffsetWidth, bgHeight - outlineOffsetWidth);\n\t            ctx.lineTo(outlineOffsetWidth, outlineOffsetWidth);\n\t            // Diagonals\n\t            ctx.moveTo(0, outlineOffsetWidth);\n\t            ctx.lineTo(bgWidth, bgHeight - outlineOffsetWidth);\n\t            ctx.moveTo(0, bgHeight - outlineOffsetWidth);\n\t            ctx.lineTo(bgWidth, outlineOffsetWidth);\n\t            ctx.stroke();\n\t        }\n\n\t        var textGroup = root.children.holderTextGroup;\n\t        ctx.font = textGroup.properties.font.weight + ' ' + (dpr * textGroup.properties.font.size) + textGroup.properties.font.units + ' ' + textGroup.properties.font.family + ', monospace';\n\t        ctx.fillStyle = textGroup.properties.fill;\n\n\t        for (var lineKey in textGroup.children) {\n\t            var line = textGroup.children[lineKey];\n\t            for (var wordKey in line.children) {\n\t                var word = line.children[wordKey];\n\t                var x = dpr * (textGroup.x + line.x + word.x);\n\t                var y = dpr * (textGroup.y + line.y + word.y + (textGroup.properties.leading / 2));\n\n\t                ctx.fillText(word.properties.text, x, y);\n\t            }\n\t        }\n\n\t        return canvas.toDataURL('image/png');\n\t    };\n\t})();\n\n/***/ }\n/******/ ])\n});\n;\n(function(ctx, isMeteorPackage) {\n    if (isMeteorPackage) {\n        Holder = ctx.Holder;\n    }\n})(this, typeof Meteor !== 'undefined' && typeof Package !== 'undefined');\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9ob2xkZXJqcy9ob2xkZXIuanM/Mjc1MSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcblxuSG9sZGVyIC0gY2xpZW50IHNpZGUgaW1hZ2UgcGxhY2Vob2xkZXJzXG5WZXJzaW9uIDIuOS40K2NhYmlsXG7CqSAyMDE2IEl2YW4gTWFsb3BpbnNreSAtIGh0dHA6Ly9pbXNreS5jb1xuXG5TaXRlOiAgICAgaHR0cDovL2hvbGRlcmpzLmNvbVxuSXNzdWVzOiAgIGh0dHBzOi8vZ2l0aHViLmNvbS9pbXNreS9ob2xkZXIvaXNzdWVzXG5MaWNlbnNlOiAgTUlUXG5cbiovXG4oZnVuY3Rpb24gKHdpbmRvdykge1xuICBpZiAoIXdpbmRvdy5kb2N1bWVudCkgcmV0dXJuO1xuICB2YXIgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQ7XG5cbiAgLy9odHRwczovL2dpdGh1Yi5jb20vaW5leG9yYWJsZXRhc2gvcG9seWZpbGwvYmxvYi9tYXN0ZXIvd2ViLmpzXG4gICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKSB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsID0gZnVuY3Rpb24gKHNlbGVjdG9ycykge1xuICAgICAgICB2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpLCBlbGVtZW50cyA9IFtdLCBlbGVtZW50O1xuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZmlyc3RDaGlsZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gICAgICAgIGRvY3VtZW50Ll9xc2EgPSBbXTtcblxuICAgICAgICBzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSBzZWxlY3RvcnMgKyAne3gtcXNhOmV4cHJlc3Npb24oZG9jdW1lbnQuX3FzYSAmJiBkb2N1bWVudC5fcXNhLnB1c2godGhpcykpfSc7XG4gICAgICAgIHdpbmRvdy5zY3JvbGxCeSgwLCAwKTtcbiAgICAgICAgc3R5bGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZSk7XG5cbiAgICAgICAgd2hpbGUgKGRvY3VtZW50Ll9xc2EubGVuZ3RoKSB7XG4gICAgICAgICAgZWxlbWVudCA9IGRvY3VtZW50Ll9xc2Euc2hpZnQoKTtcbiAgICAgICAgICBlbGVtZW50LnN0eWxlLnJlbW92ZUF0dHJpYnV0ZSgneC1xc2EnKTtcbiAgICAgICAgICBlbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGRvY3VtZW50Ll9xc2EgPSBudWxsO1xuICAgICAgICByZXR1cm4gZWxlbWVudHM7XG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmICghZG9jdW1lbnQucXVlcnlTZWxlY3Rvcikge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvciA9IGZ1bmN0aW9uIChzZWxlY3RvcnMpIHtcbiAgICAgICAgdmFyIGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMpO1xuICAgICAgICByZXR1cm4gKGVsZW1lbnRzLmxlbmd0aCkgPyBlbGVtZW50c1swXSA6IG51bGw7XG4gICAgICB9O1xuICAgIH1cblxuICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSkge1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IGZ1bmN0aW9uIChjbGFzc05hbWVzKSB7XG4gICAgICAgIGNsYXNzTmFtZXMgPSBTdHJpbmcoY2xhc3NOYW1lcykucmVwbGFjZSgvXnxcXHMrL2csICcuJyk7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNsYXNzTmFtZXMpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgLy9odHRwczovL2dpdGh1Yi5jb20vaW5leG9yYWJsZXRhc2gvcG9seWZpbGxcbiAgLy8gRVM1IDE1LjIuMy4xNCBPYmplY3Qua2V5cyAoIE8gKVxuICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3Qva2V5c1xuICBpZiAoIU9iamVjdC5rZXlzKSB7XG4gICAgT2JqZWN0LmtleXMgPSBmdW5jdGlvbiAobykge1xuICAgICAgaWYgKG8gIT09IE9iamVjdChvKSkgeyB0aHJvdyBUeXBlRXJyb3IoJ09iamVjdC5rZXlzIGNhbGxlZCBvbiBub24tb2JqZWN0Jyk7IH1cbiAgICAgIHZhciByZXQgPSBbXSwgcDtcbiAgICAgIGZvciAocCBpbiBvKSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIHtcbiAgICAgICAgICByZXQucHVzaChwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJldDtcbiAgICB9O1xuICB9XG5cbiAgLy8gRVM1IDE1LjQuNC4xOCBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCAoIGNhbGxiYWNrZm4gWyAsIHRoaXNBcmcgXSApXG4gIC8vIEZyb20gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvZm9yRWFjaFxuICBpZiAoIUFycmF5LnByb3RvdHlwZS5mb3JFYWNoKSB7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoZnVuIC8qLCB0aGlzcCAqLykge1xuICAgICAgaWYgKHRoaXMgPT09IHZvaWQgMCB8fCB0aGlzID09PSBudWxsKSB7IHRocm93IFR5cGVFcnJvcigpOyB9XG5cbiAgICAgIHZhciB0ID0gT2JqZWN0KHRoaXMpO1xuICAgICAgdmFyIGxlbiA9IHQubGVuZ3RoID4+PiAwO1xuICAgICAgaWYgKHR5cGVvZiBmdW4gIT09IFwiZnVuY3Rpb25cIikgeyB0aHJvdyBUeXBlRXJyb3IoKTsgfVxuXG4gICAgICB2YXIgdGhpc3AgPSBhcmd1bWVudHNbMV0sIGk7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKGkgaW4gdCkge1xuICAgICAgICAgIGZ1bi5jYWxsKHRoaXNwLCB0W2ldLCBpLCB0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvL2h0dHBzOi8vZ2l0aHViLmNvbS9pbmV4b3JhYmxldGFzaC9wb2x5ZmlsbC9ibG9iL21hc3Rlci93ZWIuanNcbiAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICB2YXIgQjY0X0FMUEhBQkVUID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89JztcbiAgICBnbG9iYWwuYXRvYiA9IGdsb2JhbC5hdG9iIHx8IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgaW5wdXQgPSBTdHJpbmcoaW5wdXQpO1xuICAgICAgdmFyIHBvc2l0aW9uID0gMCxcbiAgICAgICAgICBvdXRwdXQgPSBbXSxcbiAgICAgICAgICBidWZmZXIgPSAwLCBiaXRzID0gMCwgbjtcblxuICAgICAgaW5wdXQgPSBpbnB1dC5yZXBsYWNlKC9cXHMvZywgJycpO1xuICAgICAgaWYgKChpbnB1dC5sZW5ndGggJSA0KSA9PT0gMCkgeyBpbnB1dCA9IGlucHV0LnJlcGxhY2UoLz0rJC8sICcnKTsgfVxuICAgICAgaWYgKChpbnB1dC5sZW5ndGggJSA0KSA9PT0gMSkgeyB0aHJvdyBFcnJvcignSW52YWxpZENoYXJhY3RlckVycm9yJyk7IH1cbiAgICAgIGlmICgvW14rLzAtOUEtWmEtel0vLnRlc3QoaW5wdXQpKSB7IHRocm93IEVycm9yKCdJbnZhbGlkQ2hhcmFjdGVyRXJyb3InKTsgfVxuXG4gICAgICB3aGlsZSAocG9zaXRpb24gPCBpbnB1dC5sZW5ndGgpIHtcbiAgICAgICAgbiA9IEI2NF9BTFBIQUJFVC5pbmRleE9mKGlucHV0LmNoYXJBdChwb3NpdGlvbikpO1xuICAgICAgICBidWZmZXIgPSAoYnVmZmVyIDw8IDYpIHwgbjtcbiAgICAgICAgYml0cyArPSA2O1xuXG4gICAgICAgIGlmIChiaXRzID09PSAyNCkge1xuICAgICAgICAgIG91dHB1dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoKGJ1ZmZlciA+PiAxNikgJiAweEZGKSk7XG4gICAgICAgICAgb3V0cHV0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZSgoYnVmZmVyID4+ICA4KSAmIDB4RkYpKTtcbiAgICAgICAgICBvdXRwdXQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGJ1ZmZlciAmIDB4RkYpKTtcbiAgICAgICAgICBiaXRzID0gMDtcbiAgICAgICAgICBidWZmZXIgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHBvc2l0aW9uICs9IDE7XG4gICAgICB9XG5cbiAgICAgIGlmIChiaXRzID09PSAxMikge1xuICAgICAgICBidWZmZXIgPSBidWZmZXIgPj4gNDtcbiAgICAgICAgb3V0cHV0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShidWZmZXIgJiAweEZGKSk7XG4gICAgICB9IGVsc2UgaWYgKGJpdHMgPT09IDE4KSB7XG4gICAgICAgIGJ1ZmZlciA9IGJ1ZmZlciA+PiAyO1xuICAgICAgICBvdXRwdXQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKChidWZmZXIgPj4gOCkgJiAweEZGKSk7XG4gICAgICAgIG91dHB1dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoYnVmZmVyICYgMHhGRikpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gb3V0cHV0LmpvaW4oJycpO1xuICAgIH07XG5cbiAgICBnbG9iYWwuYnRvYSA9IGdsb2JhbC5idG9hIHx8IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgaW5wdXQgPSBTdHJpbmcoaW5wdXQpO1xuICAgICAgdmFyIHBvc2l0aW9uID0gMCxcbiAgICAgICAgICBvdXQgPSBbXSxcbiAgICAgICAgICBvMSwgbzIsIG8zLFxuICAgICAgICAgIGUxLCBlMiwgZTMsIGU0O1xuXG4gICAgICBpZiAoL1teXFx4MDAtXFx4RkZdLy50ZXN0KGlucHV0KSkgeyB0aHJvdyBFcnJvcignSW52YWxpZENoYXJhY3RlckVycm9yJyk7IH1cblxuICAgICAgd2hpbGUgKHBvc2l0aW9uIDwgaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgIG8xID0gaW5wdXQuY2hhckNvZGVBdChwb3NpdGlvbisrKTtcbiAgICAgICAgbzIgPSBpbnB1dC5jaGFyQ29kZUF0KHBvc2l0aW9uKyspO1xuICAgICAgICBvMyA9IGlucHV0LmNoYXJDb2RlQXQocG9zaXRpb24rKyk7XG5cbiAgICAgICAgLy8gMTExMTExIDExMjIyMiAyMjIyMzMgMzMzMzMzXG4gICAgICAgIGUxID0gbzEgPj4gMjtcbiAgICAgICAgZTIgPSAoKG8xICYgMHgzKSA8PCA0KSB8IChvMiA+PiA0KTtcbiAgICAgICAgZTMgPSAoKG8yICYgMHhmKSA8PCAyKSB8IChvMyA+PiA2KTtcbiAgICAgICAgZTQgPSBvMyAmIDB4M2Y7XG5cbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSBpbnB1dC5sZW5ndGggKyAyKSB7XG4gICAgICAgICAgZTMgPSA2NDsgZTQgPSA2NDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwb3NpdGlvbiA9PT0gaW5wdXQubGVuZ3RoICsgMSkge1xuICAgICAgICAgIGU0ID0gNjQ7XG4gICAgICAgIH1cblxuICAgICAgICBvdXQucHVzaChCNjRfQUxQSEFCRVQuY2hhckF0KGUxKSxcbiAgICAgICAgICAgICAgICAgQjY0X0FMUEhBQkVULmNoYXJBdChlMiksXG4gICAgICAgICAgICAgICAgIEI2NF9BTFBIQUJFVC5jaGFyQXQoZTMpLFxuICAgICAgICAgICAgICAgICBCNjRfQUxQSEFCRVQuY2hhckF0KGU0KSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvdXQuam9pbignJyk7XG4gICAgfTtcbiAgfSh3aW5kb3cpKTtcblxuICAvL2h0dHBzOi8vZ2lzdC5naXRodWIuY29tL2ppbWVoLzMzMjM1N1xuICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkpe1xuICAgICAgLypqc2hpbnQgLVcwMDEsIC1XMTAzICovXG4gICAgICBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5ID0gZnVuY3Rpb24ocHJvcCkge1xuICAgICAgdmFyIHByb3RvID0gdGhpcy5fX3Byb3RvX18gfHwgdGhpcy5jb25zdHJ1Y3Rvci5wcm90b3R5cGU7XG4gICAgICByZXR1cm4gKHByb3AgaW4gdGhpcykgJiYgKCEocHJvcCBpbiBwcm90bykgfHwgcHJvdG9bcHJvcF0gIT09IHRoaXNbcHJvcF0pO1xuICAgIH07XG4gICAgICAvKmpzaGludCArVzAwMSwgK1cxMDMgKi9cbiAgfVxuXG4gIC8vIEBsaWNlbnNlIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcbiAgLy8gY29weXJpZ2h0IFBhdWwgSXJpc2ggMjAxNVxuXG5cbiAgLy8gRGF0ZS5ub3coKSBpcyBzdXBwb3J0ZWQgZXZlcnl3aGVyZSBleGNlcHQgSUU4LiBGb3IgSUU4IHdlIHVzZSB0aGUgRGF0ZS5ub3cgcG9seWZpbGxcbiAgLy8gICBnaXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL2Jsb2IvbWFzdGVyL3BvbHlmaWxscy9EYXRlLm5vdy9wb2x5ZmlsbC5qc1xuICAvLyBhcyBTYWZhcmkgNiBkb2Vzbid0IGhhdmUgc3VwcG9ydCBmb3IgTmF2aWdhdGlvblRpbWluZywgd2UgdXNlIGEgRGF0ZS5ub3coKSB0aW1lc3RhbXAgZm9yIHJlbGF0aXZlIHZhbHVlc1xuXG4gIC8vIGlmIHlvdSB3YW50IHZhbHVlcyBzaW1pbGFyIHRvIHdoYXQgeW91J2QgZ2V0IHdpdGggcmVhbCBwZXJmLm5vdywgcGxhY2UgdGhpcyB0b3dhcmRzIHRoZSBoZWFkIG9mIHRoZSBwYWdlXG4gIC8vIGJ1dCBpbiByZWFsaXR5LCB5b3UncmUganVzdCBnZXR0aW5nIHRoZSBkZWx0YSBiZXR3ZWVuIG5vdygpIGNhbGxzLCBzbyBpdCdzIG5vdCB0ZXJyaWJseSBpbXBvcnRhbnQgd2hlcmUgaXQncyBwbGFjZWRcblxuXG4gIChmdW5jdGlvbigpe1xuXG4gICAgaWYgKCdwZXJmb3JtYW5jZScgaW4gd2luZG93ID09PSBmYWxzZSkge1xuICAgICAgICB3aW5kb3cucGVyZm9ybWFuY2UgPSB7fTtcbiAgICB9XG4gICAgXG4gICAgRGF0ZS5ub3cgPSAoRGF0ZS5ub3cgfHwgZnVuY3Rpb24gKCkgeyAgLy8gdGhhbmtzIElFOFxuICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIH0pO1xuXG4gICAgaWYgKCdub3cnIGluIHdpbmRvdy5wZXJmb3JtYW5jZSA9PT0gZmFsc2Upe1xuICAgICAgXG4gICAgICB2YXIgbm93T2Zmc2V0ID0gRGF0ZS5ub3coKTtcbiAgICAgIFxuICAgICAgaWYgKHBlcmZvcm1hbmNlLnRpbWluZyAmJiBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0KXtcbiAgICAgICAgbm93T2Zmc2V0ID0gcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydDtcbiAgICAgIH1cblxuICAgICAgd2luZG93LnBlcmZvcm1hbmNlLm5vdyA9IGZ1bmN0aW9uIG5vdygpe1xuICAgICAgICByZXR1cm4gRGF0ZS5ub3coKSAtIG5vd09mZnNldDtcbiAgICAgIH07XG4gICAgfVxuXG4gIH0pKCk7XG5cbiAgLy9yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgcG9seWZpbGwgZm9yIG9sZGVyIEZpcmVmb3gvQ2hyb21lIHZlcnNpb25zXG4gIGlmICghd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSkge1xuICAgIGlmICh3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lICYmIHdpbmRvdy53ZWJraXRDYW5jZWxBbmltYXRpb25GcmFtZSkge1xuICAgIC8vaHR0cHM6Ly9naXRodWIuY29tL0ZpbmFuY2lhbC1UaW1lcy9wb2x5ZmlsbC1zZXJ2aWNlL2Jsb2IvbWFzdGVyL3BvbHlmaWxscy9yZXF1ZXN0QW5pbWF0aW9uRnJhbWUvcG9seWZpbGwtd2Via2l0LmpzXG4gICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgIGdsb2JhbC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIHdlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgY2FsbGJhY2soZ2xvYmFsLnBlcmZvcm1hbmNlLm5vdygpKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBnbG9iYWwuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBnbG9iYWwud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWU7XG4gICAgfSh3aW5kb3cpKTtcbiAgICB9IGVsc2UgaWYgKHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgJiYgd2luZG93Lm1vekNhbmNlbEFuaW1hdGlvbkZyYW1lKSB7XG4gICAgICAvL2h0dHBzOi8vZ2l0aHViLmNvbS9GaW5hbmNpYWwtVGltZXMvcG9seWZpbGwtc2VydmljZS9ibG9iL21hc3Rlci9wb2x5ZmlsbHMvcmVxdWVzdEFuaW1hdGlvbkZyYW1lL3BvbHlmaWxsLW1vei5qc1xuICAgIChmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgICBnbG9iYWwucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBtb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNhbGxiYWNrKGdsb2JhbC5wZXJmb3JtYW5jZS5ub3coKSk7XG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgZ2xvYmFsLmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gZ2xvYmFsLm1vekNhbmNlbEFuaW1hdGlvbkZyYW1lO1xuICAgIH0od2luZG93KSk7XG4gICAgfSBlbHNlIHtcbiAgICAoZnVuY3Rpb24gKGdsb2JhbCkge1xuICAgICAgZ2xvYmFsLnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gZ2xvYmFsLnNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDAgLyA2MCk7XG4gICAgICB9O1xuXG4gICAgICBnbG9iYWwuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBnbG9iYWwuY2xlYXJUaW1lb3V0O1xuICAgIH0pKHdpbmRvdyk7XG4gICAgfVxuICB9XG59KSh0aGlzKTtcblxuKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiSG9sZGVyXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkhvbGRlclwiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG5cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG5cblxuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKlxuXHRIb2xkZXIuanMgLSBjbGllbnQgc2lkZSBpbWFnZSBwbGFjZWhvbGRlcnNcblx0KGMpIDIwMTItMjAxNSBJdmFuIE1hbG9waW5za3kgLSBodHRwOi8vaW1za3kuY29cblx0Ki9cblxuXHRtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsvKlxuXHRIb2xkZXIuanMgLSBjbGllbnQgc2lkZSBpbWFnZSBwbGFjZWhvbGRlcnNcblx0KGMpIDIwMTItMjAxNiBJdmFuIE1hbG9waW5za3kgLSBodHRwOi8vaW1za3kuY29cblx0Ki9cblxuXHQvL0xpYnJhcmllcyBhbmQgZnVuY3Rpb25zXG5cdHZhciBvbkRvbVJlYWR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0dmFyIHF1ZXJ5c3RyaW5nID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblxuXHR2YXIgU2NlbmVHcmFwaCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdHZhciB1dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cdHZhciBTVkcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuXHR2YXIgRE9NID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIENvbG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7XG5cdHZhciBjb25zdGFudHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcblxuXHR2YXIgc3ZnUmVuZGVyZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKTtcblx0dmFyIHNnQ2FudmFzUmVuZGVyZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTtcblxuXHR2YXIgZXh0ZW5kID0gdXRpbHMuZXh0ZW5kO1xuXHR2YXIgZGltZW5zaW9uQ2hlY2sgPSB1dGlscy5kaW1lbnNpb25DaGVjaztcblxuXHQvL0NvbnN0YW50cyBhbmQgZGVmaW5pdGlvbnNcblx0dmFyIFNWR19OUyA9IGNvbnN0YW50cy5zdmdfbnM7XG5cblx0dmFyIEhvbGRlciA9IHtcblx0ICAgIHZlcnNpb246IGNvbnN0YW50cy52ZXJzaW9uLFxuXG5cdCAgICAvKipcblx0ICAgICAqIEFkZHMgYSB0aGVtZSB0byBkZWZhdWx0IHNldHRpbmdzXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgVGhlbWUgbmFtZVxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IHRoZW1lIFRoZW1lIG9iamVjdCwgd2l0aCBmb3JlZ3JvdW5kLCBiYWNrZ3JvdW5kLCBzaXplLCBmb250LCBhbmQgZm9udHdlaWdodCBwcm9wZXJ0aWVzLlxuXHQgICAgICovXG5cdCAgICBhZGRUaGVtZTogZnVuY3Rpb24obmFtZSwgdGhlbWUpIHtcblx0ICAgICAgICBuYW1lICE9IG51bGwgJiYgdGhlbWUgIT0gbnVsbCAmJiAoQXBwLnNldHRpbmdzLnRoZW1lc1tuYW1lXSA9IHRoZW1lKTtcblx0ICAgICAgICBkZWxldGUgQXBwLnZhcnMuY2FjaGUudGhlbWVLZXlzO1xuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfSxcblxuXHQgICAgLyoqXG5cdCAgICAgKiBBcHBlbmRzIGEgcGxhY2Vob2xkZXIgdG8gYW4gZWxlbWVudFxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzcmMgUGxhY2Vob2xkZXIgVVJMIHN0cmluZ1xuXHQgICAgICogQHBhcmFtIGVsIEEgc2VsZWN0b3Igb3IgYSByZWZlcmVuY2UgdG8gYSBET00gbm9kZVxuXHQgICAgICovXG5cdCAgICBhZGRJbWFnZTogZnVuY3Rpb24oc3JjLCBlbCkge1xuXHQgICAgICAgIC8vdG9kbzogdXNlIGpxdWVyeSBmYWxsYmFjayBpZiBhdmFpbGFibGUgZm9yIGFsbCBRU0EgcmVmZXJlbmNlc1xuXHQgICAgICAgIHZhciBub2RlcyA9IERPTS5nZXROb2RlQXJyYXkoZWwpO1xuXHQgICAgICAgIG5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUpIHtcblx0ICAgICAgICAgICAgdmFyIGltZyA9IERPTS5uZXdFbCgnaW1nJyk7XG5cdCAgICAgICAgICAgIHZhciBkb21Qcm9wcyA9IHt9O1xuXHQgICAgICAgICAgICBkb21Qcm9wc1tBcHAuc2V0dXAuZGF0YUF0dHJdID0gc3JjO1xuXHQgICAgICAgICAgICBET00uc2V0QXR0cihpbWcsIGRvbVByb3BzKTtcblx0ICAgICAgICAgICAgbm9kZS5hcHBlbmRDaGlsZChpbWcpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfSxcblxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXRzIHdoZXRoZXIgb3Igbm90IGFuIGltYWdlIGlzIHVwZGF0ZWQgb24gcmVzaXplLlxuXHQgICAgICogSWYgYW4gaW1hZ2UgaXMgc2V0IHRvIGJlIHVwZGF0ZWQsIGl0IGlzIGltbWVkaWF0ZWx5IHJlbmRlcmVkLlxuXHQgICAgICpcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBlbCBJbWFnZSBET00gZWxlbWVudFxuXHQgICAgICogQHBhcmFtIHtCb29sZWFufSB2YWx1ZSBSZXNpemFibGUgdXBkYXRlIGZsYWcgdmFsdWVcblx0ICAgICAqL1xuXHQgICAgc2V0UmVzaXplVXBkYXRlOiBmdW5jdGlvbihlbCwgdmFsdWUpIHtcblx0ICAgICAgICBpZiAoZWwuaG9sZGVyRGF0YSkge1xuXHQgICAgICAgICAgICBlbC5ob2xkZXJEYXRhLnJlc2l6ZVVwZGF0ZSA9ICEhdmFsdWU7XG5cdCAgICAgICAgICAgIGlmIChlbC5ob2xkZXJEYXRhLnJlc2l6ZVVwZGF0ZSkge1xuXHQgICAgICAgICAgICAgICAgdXBkYXRlUmVzaXphYmxlRWxlbWVudHMoZWwpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblxuXHQgICAgLyoqXG5cdCAgICAgKiBSdW5zIEhvbGRlciB3aXRoIG9wdGlvbnMuIEJ5IGRlZmF1bHQgcnVucyBIb2xkZXIgb24gYWxsIGltYWdlcyB3aXRoIFwiaG9sZGVyLmpzXCIgaW4gdGhlaXIgc291cmNlIGF0dHJpYnV0ZXMuXG5cdCAgICAgKlxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IHVzZXJPcHRpb25zIE9wdGlvbnMgb2JqZWN0LCBjYW4gY29udGFpbiBkb21haW4sIHRoZW1lcywgaW1hZ2VzLCBhbmQgYmdub2RlcyBwcm9wZXJ0aWVzXG5cdCAgICAgKi9cblx0ICAgIHJ1bjogZnVuY3Rpb24odXNlck9wdGlvbnMpIHtcblx0ICAgICAgICAvL3RvZG86IHNwbGl0IHByb2Nlc3NpbmcgaW50byBzZXBhcmF0ZSBxdWV1ZXNcblx0ICAgICAgICB1c2VyT3B0aW9ucyA9IHVzZXJPcHRpb25zIHx8IHt9O1xuXHQgICAgICAgIHZhciBlbmdpbmVTZXR0aW5ncyA9IHt9O1xuXHQgICAgICAgIHZhciBvcHRpb25zID0gZXh0ZW5kKEFwcC5zZXR0aW5ncywgdXNlck9wdGlvbnMpO1xuXG5cdCAgICAgICAgQXBwLnZhcnMucHJlZW1wdGVkID0gdHJ1ZTtcblx0ICAgICAgICBBcHAudmFycy5kYXRhQXR0ciA9IG9wdGlvbnMuZGF0YUF0dHIgfHwgQXBwLnNldHVwLmRhdGFBdHRyO1xuXG5cdCAgICAgICAgZW5naW5lU2V0dGluZ3MucmVuZGVyZXIgPSBvcHRpb25zLnJlbmRlcmVyID8gb3B0aW9ucy5yZW5kZXJlciA6IEFwcC5zZXR1cC5yZW5kZXJlcjtcblx0ICAgICAgICBpZiAoQXBwLnNldHVwLnJlbmRlcmVycy5qb2luKCcsJykuaW5kZXhPZihlbmdpbmVTZXR0aW5ncy5yZW5kZXJlcikgPT09IC0xKSB7XG5cdCAgICAgICAgICAgIGVuZ2luZVNldHRpbmdzLnJlbmRlcmVyID0gQXBwLnNldHVwLnN1cHBvcnRzU1ZHID8gJ3N2ZycgOiAoQXBwLnNldHVwLnN1cHBvcnRzQ2FudmFzID8gJ2NhbnZhcycgOiAnaHRtbCcpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHZhciBpbWFnZXMgPSBET00uZ2V0Tm9kZUFycmF5KG9wdGlvbnMuaW1hZ2VzKTtcblx0ICAgICAgICB2YXIgYmdub2RlcyA9IERPTS5nZXROb2RlQXJyYXkob3B0aW9ucy5iZ25vZGVzKTtcblx0ICAgICAgICB2YXIgc3R5bGVub2RlcyA9IERPTS5nZXROb2RlQXJyYXkob3B0aW9ucy5zdHlsZW5vZGVzKTtcblx0ICAgICAgICB2YXIgb2JqZWN0cyA9IERPTS5nZXROb2RlQXJyYXkob3B0aW9ucy5vYmplY3RzKTtcblxuXHQgICAgICAgIGVuZ2luZVNldHRpbmdzLnN0eWxlc2hlZXRzID0gW107XG5cdCAgICAgICAgZW5naW5lU2V0dGluZ3Muc3ZnWE1MU3R5bGVzaGVldCA9IHRydWU7XG5cdCAgICAgICAgZW5naW5lU2V0dGluZ3Mubm9Gb250RmFsbGJhY2sgPSAhIW9wdGlvbnMubm9Gb250RmFsbGJhY2s7XG5cdCAgICAgICAgZW5naW5lU2V0dGluZ3Mubm9CYWNrZ3JvdW5kU2l6ZSA9ICEhb3B0aW9ucy5ub0JhY2tncm91bmRTaXplO1xuXG5cdCAgICAgICAgc3R5bGVub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChzdHlsZU5vZGUpIHtcblx0ICAgICAgICAgICAgaWYgKHN0eWxlTm9kZS5hdHRyaWJ1dGVzLnJlbCAmJiBzdHlsZU5vZGUuYXR0cmlidXRlcy5ocmVmICYmIHN0eWxlTm9kZS5hdHRyaWJ1dGVzLnJlbC52YWx1ZSA9PSAnc3R5bGVzaGVldCcpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBocmVmID0gc3R5bGVOb2RlLmF0dHJpYnV0ZXMuaHJlZi52YWx1ZTtcblx0ICAgICAgICAgICAgICAgIC8vdG9kbzogd3JpdGUgaXNvbW9ycGhpYyByZWxhdGl2ZS10by1hYnNvbHV0ZSBVUkwgZnVuY3Rpb25cblx0ICAgICAgICAgICAgICAgIHZhciBwcm94eUxpbmsgPSBET00ubmV3RWwoJ2EnKTtcblx0ICAgICAgICAgICAgICAgIHByb3h5TGluay5ocmVmID0gaHJlZjtcblx0ICAgICAgICAgICAgICAgIHZhciBzdHlsZXNoZWV0VVJMID0gcHJveHlMaW5rLnByb3RvY29sICsgJy8vJyArIHByb3h5TGluay5ob3N0ICsgcHJveHlMaW5rLnBhdGhuYW1lICsgcHJveHlMaW5rLnNlYXJjaDtcblx0ICAgICAgICAgICAgICAgIGVuZ2luZVNldHRpbmdzLnN0eWxlc2hlZXRzLnB1c2goc3R5bGVzaGVldFVSTCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblxuXHQgICAgICAgIGJnbm9kZXMuZm9yRWFjaChmdW5jdGlvbiAoYmdOb2RlKSB7XG5cdCAgICAgICAgICAgIC8vU2tpcCBwcm9jZXNzaW5nIGJhY2tncm91bmQgbm9kZXMgaWYgZ2V0Q29tcHV0ZWRTdHlsZSBpcyB1bmF2YWlsYWJsZSwgc2luY2Ugb25seSBtb2Rlcm4gYnJvd3NlcnMgd291bGQgYmUgYWJsZSB0byB1c2UgY2FudmFzIG9yIFNWRyB0byByZW5kZXIgdG8gYmFja2dyb3VuZFxuXHQgICAgICAgICAgICBpZiAoIWdsb2JhbC5nZXRDb21wdXRlZFN0eWxlKSByZXR1cm47XG5cdCAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kSW1hZ2UgPSBnbG9iYWwuZ2V0Q29tcHV0ZWRTdHlsZShiZ05vZGUsIG51bGwpLmdldFByb3BlcnR5VmFsdWUoJ2JhY2tncm91bmQtaW1hZ2UnKTtcblx0ICAgICAgICAgICAgdmFyIGRhdGFCYWNrZ3JvdW5kSW1hZ2UgPSBiZ05vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLWJhY2tncm91bmQtc3JjJyk7XG5cdCAgICAgICAgICAgIHZhciByYXdVUkwgPSBkYXRhQmFja2dyb3VuZEltYWdlIHx8IGJhY2tncm91bmRJbWFnZTtcblxuXHQgICAgICAgICAgICB2YXIgaG9sZGVyVVJMID0gbnVsbDtcblx0ICAgICAgICAgICAgdmFyIGhvbGRlclN0cmluZyA9IG9wdGlvbnMuZG9tYWluICsgJy8nO1xuXHQgICAgICAgICAgICB2YXIgaG9sZGVyU3RyaW5nSW5kZXggPSByYXdVUkwuaW5kZXhPZihob2xkZXJTdHJpbmcpO1xuXG5cdCAgICAgICAgICAgIGlmIChob2xkZXJTdHJpbmdJbmRleCA9PT0gMCkge1xuXHQgICAgICAgICAgICAgICAgaG9sZGVyVVJMID0gcmF3VVJMO1xuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKGhvbGRlclN0cmluZ0luZGV4ID09PSAxICYmIHJhd1VSTFswXSA9PT0gJz8nKSB7XG5cdCAgICAgICAgICAgICAgICBob2xkZXJVUkwgPSByYXdVUkwuc2xpY2UoMSk7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZnJhZ21lbnQgPSByYXdVUkwuc3Vic3RyKGhvbGRlclN0cmluZ0luZGV4KS5tYXRjaCgvKFteXFxcIl0qKVwiP1xcKS8pO1xuXHQgICAgICAgICAgICAgICAgaWYgKGZyYWdtZW50ICE9PSBudWxsKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaG9sZGVyVVJMID0gZnJhZ21lbnRbMV07XG5cdCAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJhd1VSTC5pbmRleE9mKCd1cmwoJykgPT09IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aHJvdyAnSG9sZGVyOiB1bmFibGUgdG8gcGFyc2UgYmFja2dyb3VuZCBVUkw6ICcgKyByYXdVUkw7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICBpZiAoaG9sZGVyVVJMKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgaG9sZGVyRmxhZ3MgPSBwYXJzZVVSTChob2xkZXJVUkwsIG9wdGlvbnMpO1xuXHQgICAgICAgICAgICAgICAgaWYgKGhvbGRlckZsYWdzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcHJlcGFyZURPTUVsZW1lbnQoe1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiAnYmFja2dyb3VuZCcsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGVsOiBiZ05vZGUsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGZsYWdzOiBob2xkZXJGbGFncyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZW5naW5lU2V0dGluZ3M6IGVuZ2luZVNldHRpbmdzXG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblxuXHQgICAgICAgIG9iamVjdHMuZm9yRWFjaChmdW5jdGlvbiAob2JqZWN0KSB7XG5cdCAgICAgICAgICAgIHZhciBvYmplY3RBdHRyID0ge307XG5cblx0ICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgIG9iamVjdEF0dHIuZGF0YSA9IG9iamVjdC5nZXRBdHRyaWJ1dGUoJ2RhdGEnKTtcblx0ICAgICAgICAgICAgICAgIG9iamVjdEF0dHIuZGF0YVNyYyA9IG9iamVjdC5nZXRBdHRyaWJ1dGUoQXBwLnZhcnMuZGF0YUF0dHIpO1xuXHQgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuXG5cdCAgICAgICAgICAgIHZhciBvYmplY3RIYXNTcmNVUkwgPSBvYmplY3RBdHRyLmRhdGEgIT0gbnVsbCAmJiBvYmplY3RBdHRyLmRhdGEuaW5kZXhPZihvcHRpb25zLmRvbWFpbikgPT09IDA7XG5cdCAgICAgICAgICAgIHZhciBvYmplY3RIYXNEYXRhU3JjVVJMID0gb2JqZWN0QXR0ci5kYXRhU3JjICE9IG51bGwgJiYgb2JqZWN0QXR0ci5kYXRhU3JjLmluZGV4T2Yob3B0aW9ucy5kb21haW4pID09PSAwO1xuXG5cdCAgICAgICAgICAgIGlmIChvYmplY3RIYXNTcmNVUkwpIHtcblx0ICAgICAgICAgICAgICAgIHByZXBhcmVJbWFnZUVsZW1lbnQob3B0aW9ucywgZW5naW5lU2V0dGluZ3MsIG9iamVjdEF0dHIuZGF0YSwgb2JqZWN0KTtcblx0ICAgICAgICAgICAgfSBlbHNlIGlmIChvYmplY3RIYXNEYXRhU3JjVVJMKSB7XG5cdCAgICAgICAgICAgICAgICBwcmVwYXJlSW1hZ2VFbGVtZW50KG9wdGlvbnMsIGVuZ2luZVNldHRpbmdzLCBvYmplY3RBdHRyLmRhdGFTcmMsIG9iamVjdCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblxuXHQgICAgICAgIGltYWdlcy5mb3JFYWNoKGZ1bmN0aW9uIChpbWFnZSkge1xuXHQgICAgICAgICAgICB2YXIgaW1hZ2VBdHRyID0ge307XG5cblx0ICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgIGltYWdlQXR0ci5zcmMgPSBpbWFnZS5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuXHQgICAgICAgICAgICAgICAgaW1hZ2VBdHRyLmRhdGFTcmMgPSBpbWFnZS5nZXRBdHRyaWJ1dGUoQXBwLnZhcnMuZGF0YUF0dHIpO1xuXHQgICAgICAgICAgICAgICAgaW1hZ2VBdHRyLnJlbmRlcmVkID0gaW1hZ2UuZ2V0QXR0cmlidXRlKCdkYXRhLWhvbGRlci1yZW5kZXJlZCcpO1xuXHQgICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuXG5cdCAgICAgICAgICAgIHZhciBpbWFnZUhhc1NyYyA9IGltYWdlQXR0ci5zcmMgIT0gbnVsbDtcblx0ICAgICAgICAgICAgdmFyIGltYWdlSGFzRGF0YVNyY1VSTCA9IGltYWdlQXR0ci5kYXRhU3JjICE9IG51bGwgJiYgaW1hZ2VBdHRyLmRhdGFTcmMuaW5kZXhPZihvcHRpb25zLmRvbWFpbikgPT09IDA7XG5cdCAgICAgICAgICAgIHZhciBpbWFnZVJlbmRlcmVkID0gaW1hZ2VBdHRyLnJlbmRlcmVkICE9IG51bGwgJiYgaW1hZ2VBdHRyLnJlbmRlcmVkID09ICd0cnVlJztcblxuXHQgICAgICAgICAgICBpZiAoaW1hZ2VIYXNTcmMpIHtcblx0ICAgICAgICAgICAgICAgIGlmIChpbWFnZUF0dHIuc3JjLmluZGV4T2Yob3B0aW9ucy5kb21haW4pID09PSAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcHJlcGFyZUltYWdlRWxlbWVudChvcHRpb25zLCBlbmdpbmVTZXR0aW5ncywgaW1hZ2VBdHRyLnNyYywgaW1hZ2UpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbWFnZUhhc0RhdGFTcmNVUkwpIHtcblx0ICAgICAgICAgICAgICAgICAgICAvL0ltYWdlIGhhcyBhIHZhbGlkIGRhdGEtc3JjIGFuZCBhbiBpbnZhbGlkIHNyY1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChpbWFnZVJlbmRlcmVkKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vSWYgdGhlIHBsYWNlaG9sZGVyIGhhcyBhbHJlYWR5IGJlZW4gcmVuZGVyLCByZS1yZW5kZXIgaXRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcHJlcGFyZUltYWdlRWxlbWVudChvcHRpb25zLCBlbmdpbmVTZXR0aW5ncywgaW1hZ2VBdHRyLmRhdGFTcmMsIGltYWdlKTtcblx0ICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAvL0lmIHRoZSBwbGFjZWhvbGRlciBoYXMgbm90IGJlZW4gcmVuZGVyZWQsIGNoZWNrIGlmIHRoZSBpbWFnZSBleGlzdHMgYW5kIHJlbmRlciBhIGZhbGxiYWNrIGlmIGl0IGRvZXNuJ3Rcblx0ICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uKHNyYywgb3B0aW9ucywgZW5naW5lU2V0dGluZ3MsIGRhdGFTcmMsIGltYWdlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGlscy5pbWFnZUV4aXN0cyhzcmMsIGZ1bmN0aW9uKGV4aXN0cykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXBhcmVJbWFnZUVsZW1lbnQob3B0aW9ucywgZW5naW5lU2V0dGluZ3MsIGRhdGFTcmMsIGltYWdlKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSkoaW1hZ2VBdHRyLnNyYywgb3B0aW9ucywgZW5naW5lU2V0dGluZ3MsIGltYWdlQXR0ci5kYXRhU3JjLCBpbWFnZSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKGltYWdlSGFzRGF0YVNyY1VSTCkge1xuXHQgICAgICAgICAgICAgICAgcHJlcGFyZUltYWdlRWxlbWVudChvcHRpb25zLCBlbmdpbmVTZXR0aW5ncywgaW1hZ2VBdHRyLmRhdGFTcmMsIGltYWdlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXG5cdCAgICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9XG5cdH07XG5cblx0dmFyIEFwcCA9IHtcblx0ICAgIHNldHRpbmdzOiB7XG5cdCAgICAgICAgZG9tYWluOiAnaG9sZGVyLmpzJyxcblx0ICAgICAgICBpbWFnZXM6ICdpbWcnLFxuXHQgICAgICAgIG9iamVjdHM6ICdvYmplY3QnLFxuXHQgICAgICAgIGJnbm9kZXM6ICdib2R5IC5ob2xkZXJqcycsXG5cdCAgICAgICAgc3R5bGVub2RlczogJ2hlYWQgbGluay5ob2xkZXJqcycsXG5cdCAgICAgICAgdGhlbWVzOiB7XG5cdCAgICAgICAgICAgICdncmF5Jzoge1xuXHQgICAgICAgICAgICAgICAgYmc6ICcjRUVFRUVFJyxcblx0ICAgICAgICAgICAgICAgIGZnOiAnI0FBQUFBQSdcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgJ3NvY2lhbCc6IHtcblx0ICAgICAgICAgICAgICAgIGJnOiAnIzNhNWE5NycsXG5cdCAgICAgICAgICAgICAgICBmZzogJyNGRkZGRkYnXG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICdpbmR1c3RyaWFsJzoge1xuXHQgICAgICAgICAgICAgICAgYmc6ICcjNDM0QTUyJyxcblx0ICAgICAgICAgICAgICAgIGZnOiAnI0MyRjIwMCdcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgJ3NreSc6IHtcblx0ICAgICAgICAgICAgICAgIGJnOiAnIzBEOEZEQicsXG5cdCAgICAgICAgICAgICAgICBmZzogJyNGRkZGRkYnXG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICd2aW5lJzoge1xuXHQgICAgICAgICAgICAgICAgYmc6ICcjMzlEQkFDJyxcblx0ICAgICAgICAgICAgICAgIGZnOiAnIzFFMjkyQydcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgJ2xhdmEnOiB7XG5cdCAgICAgICAgICAgICAgICBiZzogJyNGODU5MUEnLFxuXHQgICAgICAgICAgICAgICAgZmc6ICcjMUMyODQ2J1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0ICAgIGRlZmF1bHRzOiB7XG5cdCAgICAgICAgc2l6ZTogMTAsXG5cdCAgICAgICAgdW5pdHM6ICdwdCcsXG5cdCAgICAgICAgc2NhbGU6IDEgLyAxNlxuXHQgICAgfVxuXHR9O1xuXG5cdC8qKlxuXHQgKiBQcm9jZXNzZXMgcHJvdmlkZWQgc291cmNlIGF0dHJpYnV0ZSBhbmQgc2V0cyB1cCB0aGUgYXBwcm9wcmlhdGUgcmVuZGVyaW5nIHdvcmtmbG93XG5cdCAqXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSBvcHRpb25zIEluc3RhbmNlIG9wdGlvbnMgZnJvbSBIb2xkZXIucnVuXG5cdCAqIEBwYXJhbSByZW5kZXJTZXR0aW5ncyBJbnN0YW5jZSBjb25maWd1cmF0aW9uXG5cdCAqIEBwYXJhbSBzcmMgSW1hZ2UgVVJMXG5cdCAqIEBwYXJhbSBlbCBJbWFnZSBET00gZWxlbWVudFxuXHQgKi9cblx0ZnVuY3Rpb24gcHJlcGFyZUltYWdlRWxlbWVudChvcHRpb25zLCBlbmdpbmVTZXR0aW5ncywgc3JjLCBlbCkge1xuXHQgICAgdmFyIGhvbGRlckZsYWdzID0gcGFyc2VVUkwoc3JjLnN1YnN0cihzcmMubGFzdEluZGV4T2Yob3B0aW9ucy5kb21haW4pKSwgb3B0aW9ucyk7XG5cdCAgICBpZiAoaG9sZGVyRmxhZ3MpIHtcblx0ICAgICAgICBwcmVwYXJlRE9NRWxlbWVudCh7XG5cdCAgICAgICAgICAgIG1vZGU6IG51bGwsXG5cdCAgICAgICAgICAgIGVsOiBlbCxcblx0ICAgICAgICAgICAgZmxhZ3M6IGhvbGRlckZsYWdzLFxuXHQgICAgICAgICAgICBlbmdpbmVTZXR0aW5nczogZW5naW5lU2V0dGluZ3Ncblx0ICAgICAgICB9KTtcblx0ICAgIH1cblx0fVxuXG5cdC8qKlxuXHQgKiBQcm9jZXNzZXMgYSBIb2xkZXIgVVJMIGFuZCBleHRyYWN0cyBjb25maWd1cmF0aW9uIGZyb20gcXVlcnkgc3RyaW5nXG5cdCAqXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB1cmwgVVJMXG5cdCAqIEBwYXJhbSBpbnN0YW5jZU9wdGlvbnMgSW5zdGFuY2Ugb3B0aW9ucyBmcm9tIEhvbGRlci5ydW5cblx0ICovXG5cdGZ1bmN0aW9uIHBhcnNlVVJMKHVybCwgaW5zdGFuY2VPcHRpb25zKSB7XG5cdCAgICB2YXIgaG9sZGVyID0ge1xuXHQgICAgICAgIHRoZW1lOiBleHRlbmQoQXBwLnNldHRpbmdzLnRoZW1lcy5ncmF5LCBudWxsKSxcblx0ICAgICAgICBzdHlsZXNoZWV0czogaW5zdGFuY2VPcHRpb25zLnN0eWxlc2hlZXRzLFxuXHQgICAgICAgIGluc3RhbmNlT3B0aW9uczogaW5zdGFuY2VPcHRpb25zXG5cdCAgICB9O1xuXG5cdCAgICB2YXIgZmlyc3RRdWVzdGlvbk1hcmsgPSB1cmwuaW5kZXhPZignPycpO1xuXHQgICAgdmFyIHBhcnRzID0gW3VybF07XG5cblx0ICAgIGlmIChmaXJzdFF1ZXN0aW9uTWFyayAhPT0gLTEpIHtcblx0ICAgICAgICBwYXJ0cyA9IFt1cmwuc2xpY2UoMCwgZmlyc3RRdWVzdGlvbk1hcmspLCB1cmwuc2xpY2UoZmlyc3RRdWVzdGlvbk1hcmsgKyAxKV07XG5cdCAgICB9XG5cblx0ICAgIHZhciBiYXNpY3MgPSBwYXJ0c1swXS5zcGxpdCgnLycpO1xuXG5cdCAgICBob2xkZXIuaG9sZGVyVVJMID0gdXJsO1xuXG5cdCAgICB2YXIgZGltZW5zaW9ucyA9IGJhc2ljc1sxXTtcblx0ICAgIHZhciBkaW1lbnNpb25EYXRhID0gZGltZW5zaW9ucy5tYXRjaCgvKFtcXGRdK3A/KXgoW1xcZF0rcD8pLyk7XG5cblx0ICAgIGlmICghZGltZW5zaW9uRGF0YSkgcmV0dXJuIGZhbHNlO1xuXG5cdCAgICBob2xkZXIuZmx1aWQgPSBkaW1lbnNpb25zLmluZGV4T2YoJ3AnKSAhPT0gLTE7XG5cblx0ICAgIGhvbGRlci5kaW1lbnNpb25zID0ge1xuXHQgICAgICAgIHdpZHRoOiBkaW1lbnNpb25EYXRhWzFdLnJlcGxhY2UoJ3AnLCAnJScpLFxuXHQgICAgICAgIGhlaWdodDogZGltZW5zaW9uRGF0YVsyXS5yZXBsYWNlKCdwJywgJyUnKVxuXHQgICAgfTtcblxuXHQgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMikge1xuXHQgICAgICAgIHZhciBvcHRpb25zID0gcXVlcnlzdHJpbmcucGFyc2UocGFydHNbMV0pO1xuXG5cdCAgICAgICAgLy8gRGltZW5zaW9uc1xuXG5cdCAgICAgICAgaWYgKHV0aWxzLnRydXRoeShvcHRpb25zLnJhdGlvKSkge1xuXHQgICAgICAgICAgICBob2xkZXIuZmx1aWQgPSB0cnVlO1xuXHQgICAgICAgICAgICB2YXIgcmF0aW9XaWR0aCA9IHBhcnNlRmxvYXQoaG9sZGVyLmRpbWVuc2lvbnMud2lkdGgucmVwbGFjZSgnJScsICcnKSk7XG5cdCAgICAgICAgICAgIHZhciByYXRpb0hlaWdodCA9IHBhcnNlRmxvYXQoaG9sZGVyLmRpbWVuc2lvbnMuaGVpZ2h0LnJlcGxhY2UoJyUnLCAnJykpO1xuXG5cdCAgICAgICAgICAgIHJhdGlvSGVpZ2h0ID0gTWF0aC5mbG9vcigxMDAgKiAocmF0aW9IZWlnaHQgLyByYXRpb1dpZHRoKSk7XG5cdCAgICAgICAgICAgIHJhdGlvV2lkdGggPSAxMDA7XG5cblx0ICAgICAgICAgICAgaG9sZGVyLmRpbWVuc2lvbnMud2lkdGggPSByYXRpb1dpZHRoICsgJyUnO1xuXHQgICAgICAgICAgICBob2xkZXIuZGltZW5zaW9ucy5oZWlnaHQgPSByYXRpb0hlaWdodCArICclJztcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBob2xkZXIuYXV0byA9IHV0aWxzLnRydXRoeShvcHRpb25zLmF1dG8pO1xuXG5cdCAgICAgICAgLy8gQ29sb3JzXG5cblx0ICAgICAgICBpZiAob3B0aW9ucy5iZykge1xuXHQgICAgICAgICAgICBob2xkZXIudGhlbWUuYmcgPSB1dGlscy5wYXJzZUNvbG9yKG9wdGlvbnMuYmcpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChvcHRpb25zLmZnKSB7XG5cdCAgICAgICAgICAgIGhvbGRlci50aGVtZS5mZyA9IHV0aWxzLnBhcnNlQ29sb3Iob3B0aW9ucy5mZyk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgLy90b2RvOiBhZGQgYXV0b21hdGljIGZvcmVncm91bmQgdG8gdGhlbWVzIHdpdGhvdXQgZm9yZWdyb3VuZFxuXHQgICAgICAgIGlmIChvcHRpb25zLmJnICYmICFvcHRpb25zLmZnKSB7XG5cdCAgICAgICAgICAgIGhvbGRlci5hdXRvRmcgPSB0cnVlO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChvcHRpb25zLnRoZW1lICYmIGhvbGRlci5pbnN0YW5jZU9wdGlvbnMudGhlbWVzLmhhc093blByb3BlcnR5KG9wdGlvbnMudGhlbWUpKSB7XG5cdCAgICAgICAgICAgIGhvbGRlci50aGVtZSA9IGV4dGVuZChob2xkZXIuaW5zdGFuY2VPcHRpb25zLnRoZW1lc1tvcHRpb25zLnRoZW1lXSwgbnVsbCk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgLy8gVGV4dFxuXG5cdCAgICAgICAgaWYgKG9wdGlvbnMudGV4dCkge1xuXHQgICAgICAgICAgICBob2xkZXIudGV4dCA9IG9wdGlvbnMudGV4dDtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpZiAob3B0aW9ucy50ZXh0bW9kZSkge1xuXHQgICAgICAgICAgICBob2xkZXIudGV4dG1vZGUgPSBvcHRpb25zLnRleHRtb2RlO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChvcHRpb25zLnNpemUpIHtcblx0ICAgICAgICAgICAgaG9sZGVyLnNpemUgPSBvcHRpb25zLnNpemU7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaWYgKG9wdGlvbnMuZm9udCkge1xuXHQgICAgICAgICAgICBob2xkZXIuZm9udCA9IG9wdGlvbnMuZm9udDtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpZiAob3B0aW9ucy5hbGlnbikge1xuXHQgICAgICAgICAgICBob2xkZXIuYWxpZ24gPSBvcHRpb25zLmFsaWduO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChvcHRpb25zLmxpbmVXcmFwKSB7XG5cdCAgICAgICAgICAgIGhvbGRlci5saW5lV3JhcCA9IG9wdGlvbnMubGluZVdyYXA7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaG9sZGVyLm5vd3JhcCA9IHV0aWxzLnRydXRoeShvcHRpb25zLm5vd3JhcCk7XG5cblx0ICAgICAgICAvLyBNaXNjZWxsYW5lb3VzXG5cblx0ICAgICAgICBob2xkZXIub3V0bGluZSA9IHV0aWxzLnRydXRoeShvcHRpb25zLm91dGxpbmUpO1xuXG5cdCAgICAgICAgaWYgKHV0aWxzLnRydXRoeShvcHRpb25zLnJhbmRvbSkpIHtcblx0ICAgICAgICAgICAgQXBwLnZhcnMuY2FjaGUudGhlbWVLZXlzID0gQXBwLnZhcnMuY2FjaGUudGhlbWVLZXlzIHx8IE9iamVjdC5rZXlzKGhvbGRlci5pbnN0YW5jZU9wdGlvbnMudGhlbWVzKTtcblx0ICAgICAgICAgICAgdmFyIF90aGVtZSA9IEFwcC52YXJzLmNhY2hlLnRoZW1lS2V5c1swIHwgTWF0aC5yYW5kb20oKSAqIEFwcC52YXJzLmNhY2hlLnRoZW1lS2V5cy5sZW5ndGhdO1xuXHQgICAgICAgICAgICBob2xkZXIudGhlbWUgPSBleHRlbmQoaG9sZGVyLmluc3RhbmNlT3B0aW9ucy50aGVtZXNbX3RoZW1lXSwgbnVsbCk7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gaG9sZGVyO1xuXHR9XG5cblx0LyoqXG5cdCAqIE1vZGlmaWVzIHRoZSBET00gdG8gZml0IHBsYWNlaG9sZGVycyBhbmQgc2V0cyB1cCByZXNpemFibGUgaW1hZ2UgY2FsbGJhY2tzIChmb3IgZmx1aWQgYW5kIGF1dG9tYXRpY2FsbHkgc2l6ZWQgcGxhY2Vob2xkZXJzKVxuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0gc2V0dGluZ3MgRE9NIHByZXAgc2V0dGluZ3Ncblx0ICovXG5cdGZ1bmN0aW9uIHByZXBhcmVET01FbGVtZW50KHByZXBTZXR0aW5ncykge1xuXHQgICAgdmFyIG1vZGUgPSBwcmVwU2V0dGluZ3MubW9kZTtcblx0ICAgIHZhciBlbCA9IHByZXBTZXR0aW5ncy5lbDtcblx0ICAgIHZhciBmbGFncyA9IHByZXBTZXR0aW5ncy5mbGFncztcblx0ICAgIHZhciBfZW5naW5lU2V0dGluZ3MgPSBwcmVwU2V0dGluZ3MuZW5naW5lU2V0dGluZ3M7XG5cdCAgICB2YXIgZGltZW5zaW9ucyA9IGZsYWdzLmRpbWVuc2lvbnMsXG5cdCAgICAgICAgdGhlbWUgPSBmbGFncy50aGVtZTtcblx0ICAgIHZhciBkaW1lbnNpb25zQ2FwdGlvbiA9IGRpbWVuc2lvbnMud2lkdGggKyAneCcgKyBkaW1lbnNpb25zLmhlaWdodDtcblx0ICAgIG1vZGUgPSBtb2RlID09IG51bGwgPyAoZmxhZ3MuZmx1aWQgPyAnZmx1aWQnIDogJ2ltYWdlJykgOiBtb2RlO1xuXHQgICAgdmFyIGhvbGRlclRlbXBsYXRlUmUgPSAvaG9sZGVyXyhbYS16XSspL2c7XG5cdCAgICB2YXIgZGltZW5zaW9uc0luVGV4dCA9IGZhbHNlO1xuXG5cdCAgICBpZiAoZmxhZ3MudGV4dCAhPSBudWxsKSB7XG5cdCAgICAgICAgdGhlbWUudGV4dCA9IGZsYWdzLnRleHQ7XG5cblx0ICAgICAgICAvLzxvYmplY3Q+IFNWRyBlbWJlZGRpbmcgZG9lc24ndCBwYXJzZSBVbmljb2RlIHByb3Blcmx5XG5cdCAgICAgICAgaWYgKGVsLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdvYmplY3QnKSB7XG5cdCAgICAgICAgICAgIHZhciB0ZXh0TGluZXMgPSB0aGVtZS50ZXh0LnNwbGl0KCdcXFxcbicpO1xuXHQgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHRleHRMaW5lcy5sZW5ndGg7IGsrKykge1xuXHQgICAgICAgICAgICAgICAgdGV4dExpbmVzW2tdID0gdXRpbHMuZW5jb2RlSHRtbEVudGl0eSh0ZXh0TGluZXNba10pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHRoZW1lLnRleHQgPSB0ZXh0TGluZXMuam9pbignXFxcXG4nKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGlmICh0aGVtZS50ZXh0KSB7XG5cdCAgICAgICAgdmFyIGhvbGRlclRlbXBsYXRlTWF0Y2hlcyA9IHRoZW1lLnRleHQubWF0Y2goaG9sZGVyVGVtcGxhdGVSZSk7XG5cblx0ICAgICAgICBpZiAoaG9sZGVyVGVtcGxhdGVNYXRjaGVzICE9PSBudWxsKSB7XG5cdCAgICAgICAgICAgIC8vdG9kbzogb3B0aW1pemUgdGVtcGxhdGUgcmVwbGFjZW1lbnRcblx0ICAgICAgICAgICAgaG9sZGVyVGVtcGxhdGVNYXRjaGVzLmZvckVhY2goZnVuY3Rpb24gKG1hdGNoKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAobWF0Y2ggPT09ICdob2xkZXJfZGltZW5zaW9ucycpIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGVtZS50ZXh0ID0gdGhlbWUudGV4dC5yZXBsYWNlKG1hdGNoLCBkaW1lbnNpb25zQ2FwdGlvbik7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgdmFyIGhvbGRlclVSTCA9IGZsYWdzLmhvbGRlclVSTDtcblx0ICAgIHZhciBlbmdpbmVTZXR0aW5ncyA9IGV4dGVuZChfZW5naW5lU2V0dGluZ3MsIG51bGwpO1xuXG5cdCAgICBpZiAoZmxhZ3MuZm9udCkge1xuXHQgICAgICAgIC8qXG5cdCAgICAgICAgSWYgZXh0ZXJuYWwgZm9udHMgYXJlIHVzZWQgaW4gYSA8aW1nPiBwbGFjZWhvbGRlciByZW5kZXJlZCB3aXRoIFNWRywgSG9sZGVyIGZhbGxzIGJhY2sgdG8gY2FudmFzLlxuXG5cdCAgICAgICAgVGhpcyBpcyBkb25lIGJlY2F1c2UgRmlyZWZveCBhbmQgQ2hyb21lIGRpc2FsbG93IGVtYmVkZGVkIFNWR3MgZnJvbSByZWZlcmVuY2luZyBleHRlcm5hbCBhc3NldHMuXG5cdCAgICAgICAgVGhlIHdvcmthcm91bmQgaXMgZWl0aGVyIHRvIGNoYW5nZSB0aGUgcGxhY2Vob2xkZXIgdGFnIGZyb20gPGltZz4gdG8gPG9iamVjdD4gb3IgdG8gdXNlIHRoZSBjYW52YXMgcmVuZGVyZXIuXG5cdCAgICAgICAgKi9cblx0ICAgICAgICB0aGVtZS5mb250ID0gZmxhZ3MuZm9udDtcblx0ICAgICAgICBpZiAoIWVuZ2luZVNldHRpbmdzLm5vRm9udEZhbGxiYWNrICYmIGVsLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbWcnICYmIEFwcC5zZXR1cC5zdXBwb3J0c0NhbnZhcyAmJiBlbmdpbmVTZXR0aW5ncy5yZW5kZXJlciA9PT0gJ3N2ZycpIHtcblx0ICAgICAgICAgICAgZW5naW5lU2V0dGluZ3MgPSBleHRlbmQoZW5naW5lU2V0dGluZ3MsIHtcblx0ICAgICAgICAgICAgICAgIHJlbmRlcmVyOiAnY2FudmFzJ1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIC8vQ2hyb21lIGFuZCBPcGVyYSByZXF1aXJlIGEgcXVpY2sgMTBtcyByZS1yZW5kZXIgaWYgd2ViIGZvbnRzIGFyZSB1c2VkIHdpdGggY2FudmFzXG5cdCAgICBpZiAoZmxhZ3MuZm9udCAmJiBlbmdpbmVTZXR0aW5ncy5yZW5kZXJlciA9PSAnY2FudmFzJykge1xuXHQgICAgICAgIGVuZ2luZVNldHRpbmdzLnJlUmVuZGVyID0gdHJ1ZTtcblx0ICAgIH1cblxuXHQgICAgaWYgKG1vZGUgPT0gJ2JhY2tncm91bmQnKSB7XG5cdCAgICAgICAgaWYgKGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1iYWNrZ3JvdW5kLXNyYycpID09IG51bGwpIHtcblx0ICAgICAgICAgICAgRE9NLnNldEF0dHIoZWwsIHtcblx0ICAgICAgICAgICAgICAgICdkYXRhLWJhY2tncm91bmQtc3JjJzogaG9sZGVyVVJMXG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdmFyIGRvbVByb3BzID0ge307XG5cdCAgICAgICAgZG9tUHJvcHNbQXBwLnZhcnMuZGF0YUF0dHJdID0gaG9sZGVyVVJMO1xuXHQgICAgICAgIERPTS5zZXRBdHRyKGVsLCBkb21Qcm9wcyk7XG5cdCAgICB9XG5cblx0ICAgIGZsYWdzLnRoZW1lID0gdGhlbWU7XG5cblx0ICAgIC8vdG9kbyBjb25zaWRlciB1c2luZyBhbGwgcmVuZGVyU2V0dGluZ3MgaW4gaG9sZGVyRGF0YVxuXHQgICAgZWwuaG9sZGVyRGF0YSA9IHtcblx0ICAgICAgICBmbGFnczogZmxhZ3MsXG5cdCAgICAgICAgZW5naW5lU2V0dGluZ3M6IGVuZ2luZVNldHRpbmdzXG5cdCAgICB9O1xuXG5cdCAgICBpZiAobW9kZSA9PSAnaW1hZ2UnIHx8IG1vZGUgPT0gJ2ZsdWlkJykge1xuXHQgICAgICAgIERPTS5zZXRBdHRyKGVsLCB7XG5cdCAgICAgICAgICAgICdhbHQnOiB0aGVtZS50ZXh0ID8gKGRpbWVuc2lvbnNJblRleHQgPyB0aGVtZS50ZXh0IDogdGhlbWUudGV4dCArICcgWycgKyBkaW1lbnNpb25zQ2FwdGlvbiArICddJykgOiBkaW1lbnNpb25zQ2FwdGlvblxuXHQgICAgICAgIH0pO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgcmVuZGVyU2V0dGluZ3MgPSB7XG5cdCAgICAgICAgbW9kZTogbW9kZSxcblx0ICAgICAgICBlbDogZWwsXG5cdCAgICAgICAgaG9sZGVyU2V0dGluZ3M6IHtcblx0ICAgICAgICAgICAgZGltZW5zaW9uczogZGltZW5zaW9ucyxcblx0ICAgICAgICAgICAgdGhlbWU6IHRoZW1lLFxuXHQgICAgICAgICAgICBmbGFnczogZmxhZ3Ncblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVuZ2luZVNldHRpbmdzOiBlbmdpbmVTZXR0aW5nc1xuXHQgICAgfTtcblxuXHQgICAgaWYgKG1vZGUgPT0gJ2ltYWdlJykge1xuXHQgICAgICAgIGlmICghZmxhZ3MuYXV0bykge1xuXHQgICAgICAgICAgICBlbC5zdHlsZS53aWR0aCA9IGRpbWVuc2lvbnMud2lkdGggKyAncHgnO1xuXHQgICAgICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSBkaW1lbnNpb25zLmhlaWdodCArICdweCc7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaWYgKGVuZ2luZVNldHRpbmdzLnJlbmRlcmVyID09ICdodG1sJykge1xuXHQgICAgICAgICAgICBlbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGVtZS5iZztcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICByZW5kZXIocmVuZGVyU2V0dGluZ3MpO1xuXG5cdCAgICAgICAgICAgIGlmIChmbGFncy50ZXh0bW9kZSA9PSAnZXhhY3QnKSB7XG5cdCAgICAgICAgICAgICAgICBlbC5ob2xkZXJEYXRhLnJlc2l6ZVVwZGF0ZSA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICBBcHAudmFycy5yZXNpemFibGVJbWFnZXMucHVzaChlbCk7XG5cdCAgICAgICAgICAgICAgICB1cGRhdGVSZXNpemFibGVFbGVtZW50cyhlbCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9IGVsc2UgaWYgKG1vZGUgPT0gJ2JhY2tncm91bmQnICYmIGVuZ2luZVNldHRpbmdzLnJlbmRlcmVyICE9ICdodG1sJykge1xuXHQgICAgICAgIHJlbmRlcihyZW5kZXJTZXR0aW5ncyk7XG5cdCAgICB9IGVsc2UgaWYgKG1vZGUgPT0gJ2ZsdWlkJykge1xuXHQgICAgICAgIGVsLmhvbGRlckRhdGEucmVzaXplVXBkYXRlID0gdHJ1ZTtcblxuXHQgICAgICAgIGlmIChkaW1lbnNpb25zLmhlaWdodC5zbGljZSgtMSkgPT0gJyUnKSB7XG5cdCAgICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9IGRpbWVuc2lvbnMuaGVpZ2h0O1xuXHQgICAgICAgIH0gZWxzZSBpZiAoZmxhZ3MuYXV0byA9PSBudWxsIHx8ICFmbGFncy5hdXRvKSB7XG5cdCAgICAgICAgICAgIGVsLnN0eWxlLmhlaWdodCA9IGRpbWVuc2lvbnMuaGVpZ2h0ICsgJ3B4Jztcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGRpbWVuc2lvbnMud2lkdGguc2xpY2UoLTEpID09ICclJykge1xuXHQgICAgICAgICAgICBlbC5zdHlsZS53aWR0aCA9IGRpbWVuc2lvbnMud2lkdGg7XG5cdCAgICAgICAgfSBlbHNlIGlmIChmbGFncy5hdXRvID09IG51bGwgfHwgIWZsYWdzLmF1dG8pIHtcblx0ICAgICAgICAgICAgZWwuc3R5bGUud2lkdGggPSBkaW1lbnNpb25zLndpZHRoICsgJ3B4Jztcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGVsLnN0eWxlLmRpc3BsYXkgPT0gJ2lubGluZScgfHwgZWwuc3R5bGUuZGlzcGxheSA9PT0gJycgfHwgZWwuc3R5bGUuZGlzcGxheSA9PSAnbm9uZScpIHtcblx0ICAgICAgICAgICAgZWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgc2V0SW5pdGlhbERpbWVuc2lvbnMoZWwpO1xuXG5cdCAgICAgICAgaWYgKGVuZ2luZVNldHRpbmdzLnJlbmRlcmVyID09ICdodG1sJykge1xuXHQgICAgICAgICAgICBlbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGVtZS5iZztcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBBcHAudmFycy5yZXNpemFibGVJbWFnZXMucHVzaChlbCk7XG5cdCAgICAgICAgICAgIHVwZGF0ZVJlc2l6YWJsZUVsZW1lbnRzKGVsKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdH1cblxuXHQvKipcblx0ICogQ29yZSBmdW5jdGlvbiB0aGF0IHRha2VzIG91dHB1dCBmcm9tIHJlbmRlcmVycyBhbmQgc2V0cyBpdCBhcyB0aGUgc291cmNlIG9yIGJhY2tncm91bmQtaW1hZ2Ugb2YgdGhlIHRhcmdldCBlbGVtZW50XG5cdCAqXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSByZW5kZXJTZXR0aW5ncyBSZW5kZXJlciBzZXR0aW5nc1xuXHQgKi9cblx0ZnVuY3Rpb24gcmVuZGVyKHJlbmRlclNldHRpbmdzKSB7XG5cdCAgICB2YXIgaW1hZ2UgPSBudWxsO1xuXHQgICAgdmFyIG1vZGUgPSByZW5kZXJTZXR0aW5ncy5tb2RlO1xuXHQgICAgdmFyIGVsID0gcmVuZGVyU2V0dGluZ3MuZWw7XG5cdCAgICB2YXIgaG9sZGVyU2V0dGluZ3MgPSByZW5kZXJTZXR0aW5ncy5ob2xkZXJTZXR0aW5ncztcblx0ICAgIHZhciBlbmdpbmVTZXR0aW5ncyA9IHJlbmRlclNldHRpbmdzLmVuZ2luZVNldHRpbmdzO1xuXG5cdCAgICBzd2l0Y2ggKGVuZ2luZVNldHRpbmdzLnJlbmRlcmVyKSB7XG5cdCAgICAgICAgY2FzZSAnc3ZnJzpcblx0ICAgICAgICAgICAgaWYgKCFBcHAuc2V0dXAuc3VwcG9ydHNTVkcpIHJldHVybjtcblx0ICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgY2FzZSAnY2FudmFzJzpcblx0ICAgICAgICAgICAgaWYgKCFBcHAuc2V0dXAuc3VwcG9ydHNDYW52YXMpIHJldHVybjtcblx0ICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgZGVmYXVsdDpcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXG5cdCAgICAvL3RvZG86IG1vdmUgZ2VuZXJhdGlvbiBvZiBzY2VuZSB1cCB0byBmbGFnIGdlbmVyYXRpb24gdG8gcmVkdWNlIGV4dHJhIG9iamVjdCBjcmVhdGlvblxuXHQgICAgdmFyIHNjZW5lID0ge1xuXHQgICAgICAgIHdpZHRoOiBob2xkZXJTZXR0aW5ncy5kaW1lbnNpb25zLndpZHRoLFxuXHQgICAgICAgIGhlaWdodDogaG9sZGVyU2V0dGluZ3MuZGltZW5zaW9ucy5oZWlnaHQsXG5cdCAgICAgICAgdGhlbWU6IGhvbGRlclNldHRpbmdzLnRoZW1lLFxuXHQgICAgICAgIGZsYWdzOiBob2xkZXJTZXR0aW5ncy5mbGFnc1xuXHQgICAgfTtcblxuXHQgICAgdmFyIHNjZW5lR3JhcGggPSBidWlsZFNjZW5lR3JhcGgoc2NlbmUpO1xuXG5cdCAgICBmdW5jdGlvbiBnZXRSZW5kZXJlZEltYWdlKCkge1xuXHQgICAgICAgIHZhciBpbWFnZSA9IG51bGw7XG5cdCAgICAgICAgc3dpdGNoIChlbmdpbmVTZXR0aW5ncy5yZW5kZXJlcikge1xuXHQgICAgICAgICAgICBjYXNlICdjYW52YXMnOlxuXHQgICAgICAgICAgICAgICAgaW1hZ2UgPSBzZ0NhbnZhc1JlbmRlcmVyKHNjZW5lR3JhcGgsIHJlbmRlclNldHRpbmdzKTtcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICBjYXNlICdzdmcnOlxuXHQgICAgICAgICAgICAgICAgaW1hZ2UgPSBzdmdSZW5kZXJlcihzY2VuZUdyYXBoLCByZW5kZXJTZXR0aW5ncyk7XG5cdCAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgZGVmYXVsdDpcblx0ICAgICAgICAgICAgICAgIHRocm93ICdIb2xkZXI6IGludmFsaWQgcmVuZGVyZXI6ICcgKyBlbmdpbmVTZXR0aW5ncy5yZW5kZXJlcjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICByZXR1cm4gaW1hZ2U7XG5cdCAgICB9XG5cblx0ICAgIGltYWdlID0gZ2V0UmVuZGVyZWRJbWFnZSgpO1xuXG5cdCAgICBpZiAoaW1hZ2UgPT0gbnVsbCkge1xuXHQgICAgICAgIHRocm93ICdIb2xkZXI6IGNvdWxkblxcJ3QgcmVuZGVyIHBsYWNlaG9sZGVyJztcblx0ICAgIH1cblxuXHQgICAgLy90b2RvOiBhZGQgPG9iamVjdD4gY2FudmFzIHJlbmRlcmluZ1xuXHQgICAgaWYgKG1vZGUgPT0gJ2JhY2tncm91bmQnKSB7XG5cdCAgICAgICAgZWwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgnICsgaW1hZ2UgKyAnKSc7XG5cblx0ICAgICAgICBpZiAoIWVuZ2luZVNldHRpbmdzLm5vQmFja2dyb3VuZFNpemUpIHtcblx0ICAgICAgICAgICAgZWwuc3R5bGUuYmFja2dyb3VuZFNpemUgPSBzY2VuZS53aWR0aCArICdweCAnICsgc2NlbmUuaGVpZ2h0ICsgJ3B4Jztcblx0ICAgICAgICB9XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICAgIGlmIChlbC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaW1nJykge1xuXHQgICAgICAgICAgICBET00uc2V0QXR0cihlbCwge1xuXHQgICAgICAgICAgICAgICAgJ3NyYyc6IGltYWdlXG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoZWwubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ29iamVjdCcpIHtcblx0ICAgICAgICAgICAgRE9NLnNldEF0dHIoZWwsIHtcblx0ICAgICAgICAgICAgICAgICdkYXRhJzogaW1hZ2UsXG5cdCAgICAgICAgICAgICAgICAndHlwZSc6ICdpbWFnZS9zdmcreG1sJ1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGVuZ2luZVNldHRpbmdzLnJlUmVuZGVyKSB7XG5cdCAgICAgICAgICAgIGdsb2JhbC5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBpbWFnZSA9IGdldFJlbmRlcmVkSW1hZ2UoKTtcblx0ICAgICAgICAgICAgICAgIGlmIChpbWFnZSA9PSBudWxsKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhyb3cgJ0hvbGRlcjogY291bGRuXFwndCByZW5kZXIgcGxhY2Vob2xkZXInO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgLy90b2RvOiByZWZhY3RvciB0aGlzIGNvZGUgaW50byBhIGZ1bmN0aW9uXG5cdCAgICAgICAgICAgICAgICBpZiAoZWwubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2ltZycpIHtcblx0ICAgICAgICAgICAgICAgICAgICBET00uc2V0QXR0cihlbCwge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAnc3JjJzogaW1hZ2Vcblx0ICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZWwubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ29iamVjdCcpIHtcblx0ICAgICAgICAgICAgICAgICAgICBET00uc2V0QXR0cihlbCwge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YSc6IGltYWdlLFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdpbWFnZS9zdmcreG1sJ1xuXHQgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9LCAxNTApO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIC8vdG9kbzogYWNjb3VudCBmb3IgcmUtcmVuZGVyaW5nXG5cdCAgICBET00uc2V0QXR0cihlbCwge1xuXHQgICAgICAgICdkYXRhLWhvbGRlci1yZW5kZXJlZCc6IHRydWVcblx0ICAgIH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvcmUgZnVuY3Rpb24gdGhhdCB0YWtlcyBhIEhvbGRlciBzY2VuZSBkZXNjcmlwdGlvbiBhbmQgYnVpbGRzIGEgc2NlbmUgZ3JhcGhcblx0ICpcblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHNjZW5lIEhvbGRlciBzY2VuZSBvYmplY3Rcblx0ICovXG5cdC8vdG9kbzogbWFrZSB0aGlzIGZ1bmN0aW9uIHJldXNhYmxlXG5cdC8vdG9kbzogbWVyZ2UgYXBwIGRlZmF1bHRzIGFuZCBzZXR1cCBwcm9wZXJ0aWVzIGludG8gdGhlIHNjZW5lIGFyZ3VtZW50XG5cdGZ1bmN0aW9uIGJ1aWxkU2NlbmVHcmFwaChzY2VuZSkge1xuXHQgICAgdmFyIGZvbnRTaXplID0gQXBwLmRlZmF1bHRzLnNpemU7XG5cdCAgICBpZiAocGFyc2VGbG9hdChzY2VuZS50aGVtZS5zaXplKSkge1xuXHQgICAgICAgIGZvbnRTaXplID0gc2NlbmUudGhlbWUuc2l6ZTtcblx0ICAgIH0gZWxzZSBpZiAocGFyc2VGbG9hdChzY2VuZS5mbGFncy5zaXplKSkge1xuXHQgICAgICAgIGZvbnRTaXplID0gc2NlbmUuZmxhZ3Muc2l6ZTtcblx0ICAgIH1cblxuXHQgICAgc2NlbmUuZm9udCA9IHtcblx0ICAgICAgICBmYW1pbHk6IHNjZW5lLnRoZW1lLmZvbnQgPyBzY2VuZS50aGVtZS5mb250IDogJ0FyaWFsLCBIZWx2ZXRpY2EsIE9wZW4gU2Fucywgc2Fucy1zZXJpZicsXG5cdCAgICAgICAgc2l6ZTogdGV4dFNpemUoc2NlbmUud2lkdGgsIHNjZW5lLmhlaWdodCwgZm9udFNpemUsIEFwcC5kZWZhdWx0cy5zY2FsZSksXG5cdCAgICAgICAgdW5pdHM6IHNjZW5lLnRoZW1lLnVuaXRzID8gc2NlbmUudGhlbWUudW5pdHMgOiBBcHAuZGVmYXVsdHMudW5pdHMsXG5cdCAgICAgICAgd2VpZ2h0OiBzY2VuZS50aGVtZS5mb250d2VpZ2h0ID8gc2NlbmUudGhlbWUuZm9udHdlaWdodCA6ICdib2xkJ1xuXHQgICAgfTtcblxuXHQgICAgc2NlbmUudGV4dCA9IHNjZW5lLnRoZW1lLnRleHQgfHwgTWF0aC5mbG9vcihzY2VuZS53aWR0aCkgKyAneCcgKyBNYXRoLmZsb29yKHNjZW5lLmhlaWdodCk7XG5cblx0ICAgIHNjZW5lLm5vV3JhcCA9IHNjZW5lLnRoZW1lLm5vd3JhcCB8fCBzY2VuZS5mbGFncy5ub3dyYXA7XG5cblx0ICAgIHNjZW5lLmFsaWduID0gc2NlbmUudGhlbWUuYWxpZ24gfHwgc2NlbmUuZmxhZ3MuYWxpZ24gfHwgJ2NlbnRlcic7XG5cblx0ICAgIHN3aXRjaCAoc2NlbmUuZmxhZ3MudGV4dG1vZGUpIHtcblx0ICAgICAgICBjYXNlICdsaXRlcmFsJzpcblx0ICAgICAgICAgICAgc2NlbmUudGV4dCA9IHNjZW5lLmZsYWdzLmRpbWVuc2lvbnMud2lkdGggKyAneCcgKyBzY2VuZS5mbGFncy5kaW1lbnNpb25zLmhlaWdodDtcblx0ICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgY2FzZSAnZXhhY3QnOlxuXHQgICAgICAgICAgICBpZiAoIXNjZW5lLmZsYWdzLmV4YWN0RGltZW5zaW9ucykgYnJlYWs7XG5cdCAgICAgICAgICAgIHNjZW5lLnRleHQgPSBNYXRoLmZsb29yKHNjZW5lLmZsYWdzLmV4YWN0RGltZW5zaW9ucy53aWR0aCkgKyAneCcgKyBNYXRoLmZsb29yKHNjZW5lLmZsYWdzLmV4YWN0RGltZW5zaW9ucy5oZWlnaHQpO1xuXHQgICAgICAgICAgICBicmVhaztcblx0ICAgIH1cblxuXHQgICAgdmFyIGxpbmVXcmFwID0gc2NlbmUuZmxhZ3MubGluZVdyYXAgfHwgQXBwLnNldHVwLmxpbmVXcmFwUmF0aW87XG5cdCAgICB2YXIgc2NlbmVNYXJnaW4gPSBzY2VuZS53aWR0aCAqIGxpbmVXcmFwO1xuXHQgICAgdmFyIG1heExpbmVXaWR0aCA9IHNjZW5lTWFyZ2luO1xuXG5cdCAgICB2YXIgc2NlbmVHcmFwaCA9IG5ldyBTY2VuZUdyYXBoKHtcblx0ICAgICAgICB3aWR0aDogc2NlbmUud2lkdGgsXG5cdCAgICAgICAgaGVpZ2h0OiBzY2VuZS5oZWlnaHRcblx0ICAgIH0pO1xuXG5cdCAgICB2YXIgU2hhcGUgPSBzY2VuZUdyYXBoLlNoYXBlO1xuXG5cdCAgICB2YXIgaG9sZGVyQmcgPSBuZXcgU2hhcGUuUmVjdCgnaG9sZGVyQmcnLCB7XG5cdCAgICAgICAgZmlsbDogc2NlbmUudGhlbWUuYmdcblx0ICAgIH0pO1xuXG5cdCAgICBob2xkZXJCZy5yZXNpemUoc2NlbmUud2lkdGgsIHNjZW5lLmhlaWdodCk7XG5cdCAgICBzY2VuZUdyYXBoLnJvb3QuYWRkKGhvbGRlckJnKTtcblxuXHQgICAgaWYgKHNjZW5lLmZsYWdzLm91dGxpbmUpIHtcblx0ICAgICAgICB2YXIgb3V0bGluZUNvbG9yID0gbmV3IENvbG9yKGhvbGRlckJnLnByb3BlcnRpZXMuZmlsbCk7XG5cdCAgICAgICAgb3V0bGluZUNvbG9yID0gb3V0bGluZUNvbG9yLmxpZ2h0ZW4ob3V0bGluZUNvbG9yLmxpZ2h0ZXJUaGFuKCc3ZjdmN2YnKSA/IC0wLjEgOiAwLjEpO1xuXHQgICAgICAgIGhvbGRlckJnLnByb3BlcnRpZXMub3V0bGluZSA9IHtcblx0ICAgICAgICAgICAgZmlsbDogb3V0bGluZUNvbG9yLnRvSGV4KHRydWUpLFxuXHQgICAgICAgICAgICB3aWR0aDogMlxuXHQgICAgICAgIH07XG5cdCAgICB9XG5cblx0ICAgIHZhciBob2xkZXJUZXh0Q29sb3IgPSBzY2VuZS50aGVtZS5mZztcblxuXHQgICAgaWYgKHNjZW5lLmZsYWdzLmF1dG9GZykge1xuXHQgICAgICAgIHZhciBob2xkZXJCZ0NvbG9yID0gbmV3IENvbG9yKGhvbGRlckJnLnByb3BlcnRpZXMuZmlsbCk7XG5cdCAgICAgICAgdmFyIGxpZ2h0Q29sb3IgPSBuZXcgQ29sb3IoJ2ZmZicpO1xuXHQgICAgICAgIHZhciBkYXJrQ29sb3IgPSBuZXcgQ29sb3IoJzAwMCcsIHtcblx0ICAgICAgICAgICAgJ2FscGhhJzogMC4yODU3MTRcblx0ICAgICAgICB9KTtcblxuXHQgICAgICAgIGhvbGRlclRleHRDb2xvciA9IGhvbGRlckJnQ29sb3IuYmxlbmRBbHBoYShob2xkZXJCZ0NvbG9yLmxpZ2h0ZXJUaGFuKCc3ZjdmN2YnKSA/IGRhcmtDb2xvciA6IGxpZ2h0Q29sb3IpLnRvSGV4KHRydWUpO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgaG9sZGVyVGV4dEdyb3VwID0gbmV3IFNoYXBlLkdyb3VwKCdob2xkZXJUZXh0R3JvdXAnLCB7XG5cdCAgICAgICAgdGV4dDogc2NlbmUudGV4dCxcblx0ICAgICAgICBhbGlnbjogc2NlbmUuYWxpZ24sXG5cdCAgICAgICAgZm9udDogc2NlbmUuZm9udCxcblx0ICAgICAgICBmaWxsOiBob2xkZXJUZXh0Q29sb3Jcblx0ICAgIH0pO1xuXG5cdCAgICBob2xkZXJUZXh0R3JvdXAubW92ZVRvKG51bGwsIG51bGwsIDEpO1xuXHQgICAgc2NlbmVHcmFwaC5yb290LmFkZChob2xkZXJUZXh0R3JvdXApO1xuXG5cdCAgICB2YXIgdHBkYXRhID0gaG9sZGVyVGV4dEdyb3VwLnRleHRQb3NpdGlvbkRhdGEgPSBzdGFnaW5nUmVuZGVyZXIoc2NlbmVHcmFwaCk7XG5cdCAgICBpZiAoIXRwZGF0YSkge1xuXHQgICAgICAgIHRocm93ICdIb2xkZXI6IHN0YWdpbmcgZmFsbGJhY2sgbm90IHN1cHBvcnRlZCB5ZXQuJztcblx0ICAgIH1cblx0ICAgIGhvbGRlclRleHRHcm91cC5wcm9wZXJ0aWVzLmxlYWRpbmcgPSB0cGRhdGEuYm91bmRpbmdCb3guaGVpZ2h0O1xuXG5cdCAgICB2YXIgdGV4dE5vZGUgPSBudWxsO1xuXHQgICAgdmFyIGxpbmUgPSBudWxsO1xuXG5cdCAgICBmdW5jdGlvbiBmaW5hbGl6ZUxpbmUocGFyZW50LCBsaW5lLCB3aWR0aCwgaGVpZ2h0KSB7XG5cdCAgICAgICAgbGluZS53aWR0aCA9IHdpZHRoO1xuXHQgICAgICAgIGxpbmUuaGVpZ2h0ID0gaGVpZ2h0O1xuXHQgICAgICAgIHBhcmVudC53aWR0aCA9IE1hdGgubWF4KHBhcmVudC53aWR0aCwgbGluZS53aWR0aCk7XG5cdCAgICAgICAgcGFyZW50LmhlaWdodCArPSBsaW5lLmhlaWdodDtcblx0ICAgIH1cblxuXHQgICAgaWYgKHRwZGF0YS5saW5lQ291bnQgPiAxKSB7XG5cdCAgICAgICAgdmFyIG9mZnNldFggPSAwO1xuXHQgICAgICAgIHZhciBvZmZzZXRZID0gMDtcblx0ICAgICAgICB2YXIgbGluZUluZGV4ID0gMDtcblx0ICAgICAgICB2YXIgbGluZUtleTtcblx0ICAgICAgICBsaW5lID0gbmV3IFNoYXBlLkdyb3VwKCdsaW5lJyArIGxpbmVJbmRleCk7XG5cblx0ICAgICAgICAvL0RvdWJsZSBtYXJnaW4gc28gdGhhdCBsZWZ0L3JpZ2h0LWFsaWduZWQgbmV4dCBpcyBub3QgZmx1c2ggd2l0aCBlZGdlIG9mIGltYWdlXG5cdCAgICAgICAgaWYgKHNjZW5lLmFsaWduID09PSAnbGVmdCcgfHwgc2NlbmUuYWxpZ24gPT09ICdyaWdodCcpIHtcblx0ICAgICAgICAgICAgbWF4TGluZVdpZHRoID0gc2NlbmUud2lkdGggKiAoMSAtICgxIC0gbGluZVdyYXApICogMik7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0cGRhdGEud29yZHMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgdmFyIHdvcmQgPSB0cGRhdGEud29yZHNbaV07XG5cdCAgICAgICAgICAgIHRleHROb2RlID0gbmV3IFNoYXBlLlRleHQod29yZC50ZXh0KTtcblx0ICAgICAgICAgICAgdmFyIG5ld2xpbmUgPSB3b3JkLnRleHQgPT0gJ1xcXFxuJztcblx0ICAgICAgICAgICAgaWYgKCFzY2VuZS5ub1dyYXAgJiYgKG9mZnNldFggKyB3b3JkLndpZHRoID49IG1heExpbmVXaWR0aCB8fCBuZXdsaW5lID09PSB0cnVlKSkge1xuXHQgICAgICAgICAgICAgICAgZmluYWxpemVMaW5lKGhvbGRlclRleHRHcm91cCwgbGluZSwgb2Zmc2V0WCwgaG9sZGVyVGV4dEdyb3VwLnByb3BlcnRpZXMubGVhZGluZyk7XG5cdCAgICAgICAgICAgICAgICBob2xkZXJUZXh0R3JvdXAuYWRkKGxpbmUpO1xuXHQgICAgICAgICAgICAgICAgb2Zmc2V0WCA9IDA7XG5cdCAgICAgICAgICAgICAgICBvZmZzZXRZICs9IGhvbGRlclRleHRHcm91cC5wcm9wZXJ0aWVzLmxlYWRpbmc7XG5cdCAgICAgICAgICAgICAgICBsaW5lSW5kZXggKz0gMTtcblx0ICAgICAgICAgICAgICAgIGxpbmUgPSBuZXcgU2hhcGUuR3JvdXAoJ2xpbmUnICsgbGluZUluZGV4KTtcblx0ICAgICAgICAgICAgICAgIGxpbmUueSA9IG9mZnNldFk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgaWYgKG5ld2xpbmUgPT09IHRydWUpIHtcblx0ICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHRleHROb2RlLm1vdmVUbyhvZmZzZXRYLCAwKTtcblx0ICAgICAgICAgICAgb2Zmc2V0WCArPSB0cGRhdGEuc3BhY2VXaWR0aCArIHdvcmQud2lkdGg7XG5cdCAgICAgICAgICAgIGxpbmUuYWRkKHRleHROb2RlKTtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBmaW5hbGl6ZUxpbmUoaG9sZGVyVGV4dEdyb3VwLCBsaW5lLCBvZmZzZXRYLCBob2xkZXJUZXh0R3JvdXAucHJvcGVydGllcy5sZWFkaW5nKTtcblx0ICAgICAgICBob2xkZXJUZXh0R3JvdXAuYWRkKGxpbmUpO1xuXG5cdCAgICAgICAgaWYgKHNjZW5lLmFsaWduID09PSAnbGVmdCcpIHtcblx0ICAgICAgICAgICAgaG9sZGVyVGV4dEdyb3VwLm1vdmVUbyhzY2VuZS53aWR0aCAtIHNjZW5lTWFyZ2luLCBudWxsLCBudWxsKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKHNjZW5lLmFsaWduID09PSAncmlnaHQnKSB7XG5cdCAgICAgICAgICAgIGZvciAobGluZUtleSBpbiBob2xkZXJUZXh0R3JvdXAuY2hpbGRyZW4pIHtcblx0ICAgICAgICAgICAgICAgIGxpbmUgPSBob2xkZXJUZXh0R3JvdXAuY2hpbGRyZW5bbGluZUtleV07XG5cdCAgICAgICAgICAgICAgICBsaW5lLm1vdmVUbyhzY2VuZS53aWR0aCAtIGxpbmUud2lkdGgsIG51bGwsIG51bGwpO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgaG9sZGVyVGV4dEdyb3VwLm1vdmVUbygwIC0gKHNjZW5lLndpZHRoIC0gc2NlbmVNYXJnaW4pLCBudWxsLCBudWxsKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBmb3IgKGxpbmVLZXkgaW4gaG9sZGVyVGV4dEdyb3VwLmNoaWxkcmVuKSB7XG5cdCAgICAgICAgICAgICAgICBsaW5lID0gaG9sZGVyVGV4dEdyb3VwLmNoaWxkcmVuW2xpbmVLZXldO1xuXHQgICAgICAgICAgICAgICAgbGluZS5tb3ZlVG8oKGhvbGRlclRleHRHcm91cC53aWR0aCAtIGxpbmUud2lkdGgpIC8gMiwgbnVsbCwgbnVsbCk7XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICBob2xkZXJUZXh0R3JvdXAubW92ZVRvKChzY2VuZS53aWR0aCAtIGhvbGRlclRleHRHcm91cC53aWR0aCkgLyAyLCBudWxsLCBudWxsKTtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBob2xkZXJUZXh0R3JvdXAubW92ZVRvKG51bGwsIChzY2VuZS5oZWlnaHQgLSBob2xkZXJUZXh0R3JvdXAuaGVpZ2h0KSAvIDIsIG51bGwpO1xuXG5cdCAgICAgICAgLy9JZiB0aGUgdGV4dCBleGNlZWRzIHZlcnRpY2FsIHNwYWNlLCBtb3ZlIGl0IGRvd24gc28gdGhlIGZpcnN0IGxpbmUgaXMgdmlzaWJsZVxuXHQgICAgICAgIGlmICgoc2NlbmUuaGVpZ2h0IC0gaG9sZGVyVGV4dEdyb3VwLmhlaWdodCkgLyAyIDwgMCkge1xuXHQgICAgICAgICAgICBob2xkZXJUZXh0R3JvdXAubW92ZVRvKG51bGwsIDAsIG51bGwpO1xuXHQgICAgICAgIH1cblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdGV4dE5vZGUgPSBuZXcgU2hhcGUuVGV4dChzY2VuZS50ZXh0KTtcblx0ICAgICAgICBsaW5lID0gbmV3IFNoYXBlLkdyb3VwKCdsaW5lMCcpO1xuXHQgICAgICAgIGxpbmUuYWRkKHRleHROb2RlKTtcblx0ICAgICAgICBob2xkZXJUZXh0R3JvdXAuYWRkKGxpbmUpO1xuXG5cdCAgICAgICAgaWYgKHNjZW5lLmFsaWduID09PSAnbGVmdCcpIHtcblx0ICAgICAgICAgICAgaG9sZGVyVGV4dEdyb3VwLm1vdmVUbyhzY2VuZS53aWR0aCAtIHNjZW5lTWFyZ2luLCBudWxsLCBudWxsKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKHNjZW5lLmFsaWduID09PSAncmlnaHQnKSB7XG5cdCAgICAgICAgICAgIGhvbGRlclRleHRHcm91cC5tb3ZlVG8oMCAtIChzY2VuZS53aWR0aCAtIHNjZW5lTWFyZ2luKSwgbnVsbCwgbnVsbCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgaG9sZGVyVGV4dEdyb3VwLm1vdmVUbygoc2NlbmUud2lkdGggLSB0cGRhdGEuYm91bmRpbmdCb3gud2lkdGgpIC8gMiwgbnVsbCwgbnVsbCk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaG9sZGVyVGV4dEdyb3VwLm1vdmVUbyhudWxsLCAoc2NlbmUuaGVpZ2h0IC0gdHBkYXRhLmJvdW5kaW5nQm94LmhlaWdodCkgLyAyLCBudWxsKTtcblx0ICAgIH1cblxuXHQgICAgLy90b2RvOiByZW5kZXJsaXN0XG5cdCAgICByZXR1cm4gc2NlbmVHcmFwaDtcblx0fVxuXG5cdC8qKlxuXHQgKiBBZGFwdGl2ZSB0ZXh0IHNpemluZyBmdW5jdGlvblxuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0gd2lkdGggUGFyZW50IHdpZHRoXG5cdCAqIEBwYXJhbSBoZWlnaHQgUGFyZW50IGhlaWdodFxuXHQgKiBAcGFyYW0gZm9udFNpemUgUmVxdWVzdGVkIHRleHQgc2l6ZVxuXHQgKiBAcGFyYW0gc2NhbGUgUHJvcG9ydGlvbmFsIHNjYWxlIG9mIHRleHRcblx0ICovXG5cdGZ1bmN0aW9uIHRleHRTaXplKHdpZHRoLCBoZWlnaHQsIGZvbnRTaXplLCBzY2FsZSkge1xuXHQgICAgdmFyIHN0YWdlV2lkdGggPSBwYXJzZUludCh3aWR0aCwgMTApO1xuXHQgICAgdmFyIHN0YWdlSGVpZ2h0ID0gcGFyc2VJbnQoaGVpZ2h0LCAxMCk7XG5cblx0ICAgIHZhciBiaWdTaWRlID0gTWF0aC5tYXgoc3RhZ2VXaWR0aCwgc3RhZ2VIZWlnaHQpO1xuXHQgICAgdmFyIHNtYWxsU2lkZSA9IE1hdGgubWluKHN0YWdlV2lkdGgsIHN0YWdlSGVpZ2h0KTtcblxuXHQgICAgdmFyIG5ld0hlaWdodCA9IDAuOCAqIE1hdGgubWluKHNtYWxsU2lkZSwgYmlnU2lkZSAqIHNjYWxlKTtcblx0ICAgIHJldHVybiBNYXRoLnJvdW5kKE1hdGgubWF4KGZvbnRTaXplLCBuZXdIZWlnaHQpKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBJdGVyYXRlcyBvdmVyIHJlc2l6YWJsZSAoZmx1aWQgb3IgYXV0bykgcGxhY2Vob2xkZXJzIGFuZCByZW5kZXJzIHRoZW1cblx0ICpcblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIGVsZW1lbnQgT3B0aW9uYWwgZWxlbWVudCBzZWxlY3Rvciwgc3BlY2lmaWVkIG9ubHkgaWYgYSBzcGVjaWZpYyBlbGVtZW50IG5lZWRzIHRvIGJlIHJlLXJlbmRlcmVkXG5cdCAqL1xuXHRmdW5jdGlvbiB1cGRhdGVSZXNpemFibGVFbGVtZW50cyhlbGVtZW50KSB7XG5cdCAgICB2YXIgaW1hZ2VzO1xuXHQgICAgaWYgKGVsZW1lbnQgPT0gbnVsbCB8fCBlbGVtZW50Lm5vZGVUeXBlID09IG51bGwpIHtcblx0ICAgICAgICBpbWFnZXMgPSBBcHAudmFycy5yZXNpemFibGVJbWFnZXM7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICAgIGltYWdlcyA9IFtlbGVtZW50XTtcblx0ICAgIH1cblx0ICAgIGZvciAodmFyIGkgPSAwLCBsID0gaW1hZ2VzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHQgICAgICAgIHZhciBlbCA9IGltYWdlc1tpXTtcblx0ICAgICAgICBpZiAoZWwuaG9sZGVyRGF0YSkge1xuXHQgICAgICAgICAgICB2YXIgZmxhZ3MgPSBlbC5ob2xkZXJEYXRhLmZsYWdzO1xuXHQgICAgICAgICAgICB2YXIgZGltZW5zaW9ucyA9IGRpbWVuc2lvbkNoZWNrKGVsKTtcblx0ICAgICAgICAgICAgaWYgKGRpbWVuc2lvbnMpIHtcblx0ICAgICAgICAgICAgICAgIGlmICghZWwuaG9sZGVyRGF0YS5yZXNpemVVcGRhdGUpIHtcblx0ICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgICAgaWYgKGZsYWdzLmZsdWlkICYmIGZsYWdzLmF1dG8pIHtcblx0ICAgICAgICAgICAgICAgICAgICB2YXIgZmx1aWRDb25maWcgPSBlbC5ob2xkZXJEYXRhLmZsdWlkQ29uZmlnO1xuXHQgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZmx1aWRDb25maWcubW9kZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd3aWR0aCc6XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaW1lbnNpb25zLmhlaWdodCA9IGRpbWVuc2lvbnMud2lkdGggLyBmbHVpZENvbmZpZy5yYXRpbztcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdoZWlnaHQnOlxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGltZW5zaW9ucy53aWR0aCA9IGRpbWVuc2lvbnMuaGVpZ2h0ICogZmx1aWRDb25maWcucmF0aW87XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgIHZhciBzZXR0aW5ncyA9IHtcblx0ICAgICAgICAgICAgICAgICAgICBtb2RlOiAnaW1hZ2UnLFxuXHQgICAgICAgICAgICAgICAgICAgIGhvbGRlclNldHRpbmdzOiB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGRpbWVuc2lvbnM6IGRpbWVuc2lvbnMsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiBmbGFncy50aGVtZSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ3M6IGZsYWdzXG5cdCAgICAgICAgICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgICAgICAgICBlbDogZWwsXG5cdCAgICAgICAgICAgICAgICAgICAgZW5naW5lU2V0dGluZ3M6IGVsLmhvbGRlckRhdGEuZW5naW5lU2V0dGluZ3Ncblx0ICAgICAgICAgICAgICAgIH07XG5cblx0ICAgICAgICAgICAgICAgIGlmIChmbGFncy50ZXh0bW9kZSA9PSAnZXhhY3QnKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZmxhZ3MuZXhhY3REaW1lbnNpb25zID0gZGltZW5zaW9ucztcblx0ICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5ob2xkZXJTZXR0aW5ncy5kaW1lbnNpb25zID0gZmxhZ3MuZGltZW5zaW9ucztcblx0ICAgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgICAgcmVuZGVyKHNldHRpbmdzKTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIHNldEludmlzaWJsZShlbCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9XG5cdH1cblxuXHQvKipcblx0ICogU2V0cyB1cCBhc3BlY3QgcmF0aW8gbWV0YWRhdGEgZm9yIGZsdWlkIHBsYWNlaG9sZGVycywgaW4gb3JkZXIgdG8gcHJlc2VydmUgcHJvcG9ydGlvbnMgd2hlbiByZXNpemluZ1xuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0gZWwgSW1hZ2UgRE9NIGVsZW1lbnRcblx0ICovXG5cdGZ1bmN0aW9uIHNldEluaXRpYWxEaW1lbnNpb25zKGVsKSB7XG5cdCAgICBpZiAoZWwuaG9sZGVyRGF0YSkge1xuXHQgICAgICAgIHZhciBkaW1lbnNpb25zID0gZGltZW5zaW9uQ2hlY2soZWwpO1xuXHQgICAgICAgIGlmIChkaW1lbnNpb25zKSB7XG5cdCAgICAgICAgICAgIHZhciBmbGFncyA9IGVsLmhvbGRlckRhdGEuZmxhZ3M7XG5cblx0ICAgICAgICAgICAgdmFyIGZsdWlkQ29uZmlnID0ge1xuXHQgICAgICAgICAgICAgICAgZmx1aWRIZWlnaHQ6IGZsYWdzLmRpbWVuc2lvbnMuaGVpZ2h0LnNsaWNlKC0xKSA9PSAnJScsXG5cdCAgICAgICAgICAgICAgICBmbHVpZFdpZHRoOiBmbGFncy5kaW1lbnNpb25zLndpZHRoLnNsaWNlKC0xKSA9PSAnJScsXG5cdCAgICAgICAgICAgICAgICBtb2RlOiBudWxsLFxuXHQgICAgICAgICAgICAgICAgaW5pdGlhbERpbWVuc2lvbnM6IGRpbWVuc2lvbnNcblx0ICAgICAgICAgICAgfTtcblxuXHQgICAgICAgICAgICBpZiAoZmx1aWRDb25maWcuZmx1aWRXaWR0aCAmJiAhZmx1aWRDb25maWcuZmx1aWRIZWlnaHQpIHtcblx0ICAgICAgICAgICAgICAgIGZsdWlkQ29uZmlnLm1vZGUgPSAnd2lkdGgnO1xuXHQgICAgICAgICAgICAgICAgZmx1aWRDb25maWcucmF0aW8gPSBmbHVpZENvbmZpZy5pbml0aWFsRGltZW5zaW9ucy53aWR0aCAvIHBhcnNlRmxvYXQoZmxhZ3MuZGltZW5zaW9ucy5oZWlnaHQpO1xuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKCFmbHVpZENvbmZpZy5mbHVpZFdpZHRoICYmIGZsdWlkQ29uZmlnLmZsdWlkSGVpZ2h0KSB7XG5cdCAgICAgICAgICAgICAgICBmbHVpZENvbmZpZy5tb2RlID0gJ2hlaWdodCc7XG5cdCAgICAgICAgICAgICAgICBmbHVpZENvbmZpZy5yYXRpbyA9IHBhcnNlRmxvYXQoZmxhZ3MuZGltZW5zaW9ucy53aWR0aCkgLyBmbHVpZENvbmZpZy5pbml0aWFsRGltZW5zaW9ucy5oZWlnaHQ7XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICBlbC5ob2xkZXJEYXRhLmZsdWlkQ29uZmlnID0gZmx1aWRDb25maWc7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgc2V0SW52aXNpYmxlKGVsKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdH1cblxuXHQvKipcblx0ICogSXRlcmF0ZXMgdGhyb3VnaCBhbGwgY3VycmVudCBpbnZpc2libGUgaW1hZ2VzLCBhbmQgaWYgdGhleSdyZSB2aXNpYmxlLCByZW5kZXJzIHRoZW0gYW5kIHJlbW92ZXMgdGhlbSBmcm9tIGZ1cnRoZXIgY2hlY2tzLiBSdW5zIGV2ZXJ5IGFuaW1hdGlvbiBmcmFtZS5cblx0ICpcblx0ICogQHByaXZhdGVcblx0ICovXG5cdGZ1bmN0aW9uIHZpc2liaWxpdHlDaGVjaygpIHtcblx0ICAgIHZhciByZW5kZXJhYmxlSW1hZ2VzID0gW107XG5cdCAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKEFwcC52YXJzLmludmlzaWJsZUltYWdlcyk7XG5cdCAgICB2YXIgZWw7XG5cblx0ICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG5cdCAgICAgICAgZWwgPSBBcHAudmFycy5pbnZpc2libGVJbWFnZXNba2V5XTtcblx0ICAgICAgICBpZiAoZGltZW5zaW9uQ2hlY2soZWwpICYmIGVsLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2ltZycpIHtcblx0ICAgICAgICAgICAgcmVuZGVyYWJsZUltYWdlcy5wdXNoKGVsKTtcblx0ICAgICAgICAgICAgZGVsZXRlIEFwcC52YXJzLmludmlzaWJsZUltYWdlc1trZXldO1xuXHQgICAgICAgIH1cblx0ICAgIH0pO1xuXG5cdCAgICBpZiAocmVuZGVyYWJsZUltYWdlcy5sZW5ndGgpIHtcblx0ICAgICAgICBIb2xkZXIucnVuKHtcblx0ICAgICAgICAgICAgaW1hZ2VzOiByZW5kZXJhYmxlSW1hZ2VzXG5cdCAgICAgICAgfSk7XG5cdCAgICB9XG5cblx0ICAgIC8vIERvbmUgdG8gcHJldmVudCAxMDAlIENQVSB1c2FnZSB2aWEgYWdncmVzc2l2ZSBjYWxsaW5nIG9mIHJlcXVlc3RBbmltYXRpb25GcmFtZVxuXHQgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgZ2xvYmFsLnJlcXVlc3RBbmltYXRpb25GcmFtZSh2aXNpYmlsaXR5Q2hlY2spO1xuXHQgICAgfSwgMTApO1xuXHR9XG5cblx0LyoqXG5cdCAqIFN0YXJ0cyBjaGVja2luZyBmb3IgaW52aXNpYmxlIHBsYWNlaG9sZGVycyBpZiBub3QgZG9pbmcgc28geWV0LiBEb2VzIG5vdGhpbmcgb3RoZXJ3aXNlLlxuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0ZnVuY3Rpb24gc3RhcnRWaXNpYmlsaXR5Q2hlY2soKSB7XG5cdCAgICBpZiAoIUFwcC52YXJzLnZpc2liaWxpdHlDaGVja1N0YXJ0ZWQpIHtcblx0ICAgICAgICBnbG9iYWwucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHZpc2liaWxpdHlDaGVjayk7XG5cdCAgICAgICAgQXBwLnZhcnMudmlzaWJpbGl0eUNoZWNrU3RhcnRlZCA9IHRydWU7XG5cdCAgICB9XG5cdH1cblxuXHQvKipcblx0ICogU2V0cyBhIHVuaXF1ZSBJRCBmb3IgYW4gaW1hZ2UgZGV0ZWN0ZWQgdG8gYmUgaW52aXNpYmxlIGFuZCBhZGRzIGl0IHRvIHRoZSBtYXAgb2YgaW52aXNpYmxlIGltYWdlcyBjaGVja2VkIGJ5IHZpc2liaWxpdHlDaGVja1xuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0gZWwgSW52aXNpYmxlIERPTSBlbGVtZW50XG5cdCAqL1xuXHRmdW5jdGlvbiBzZXRJbnZpc2libGUoZWwpIHtcblx0ICAgIGlmICghZWwuaG9sZGVyRGF0YS5pbnZpc2libGVJZCkge1xuXHQgICAgICAgIEFwcC52YXJzLmludmlzaWJsZUlkICs9IDE7XG5cdCAgICAgICAgQXBwLnZhcnMuaW52aXNpYmxlSW1hZ2VzWydpJyArIEFwcC52YXJzLmludmlzaWJsZUlkXSA9IGVsO1xuXHQgICAgICAgIGVsLmhvbGRlckRhdGEuaW52aXNpYmxlSWQgPSBBcHAudmFycy5pbnZpc2libGVJZDtcblx0ICAgIH1cblx0fVxuXG5cdC8vdG9kbzogc2VlIGlmIHBvc3NpYmxlIHRvIGNvbnZlcnQgc3RhZ2luZ1JlbmRlcmVyIHRvIHVzZSBIVE1MIG9ubHlcblx0dmFyIHN0YWdpbmdSZW5kZXJlciA9IChmdW5jdGlvbigpIHtcblx0ICAgIHZhciBzdmcgPSBudWxsLFxuXHQgICAgICAgIHN0YWdpbmdUZXh0ID0gbnVsbCxcblx0ICAgICAgICBzdGFnaW5nVGV4dE5vZGUgPSBudWxsO1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKGdyYXBoKSB7XG5cdCAgICAgICAgdmFyIHJvb3ROb2RlID0gZ3JhcGgucm9vdDtcblx0ICAgICAgICBpZiAoQXBwLnNldHVwLnN1cHBvcnRzU1ZHKSB7XG5cdCAgICAgICAgICAgIHZhciBmaXJzdFRpbWVTZXR1cCA9IGZhbHNlO1xuXHQgICAgICAgICAgICB2YXIgdG5vZGUgPSBmdW5jdGlvbih0ZXh0KSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGV4dCk7XG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgICAgIGlmIChzdmcgPT0gbnVsbCB8fCBzdmcucGFyZW50Tm9kZSAhPT0gZG9jdW1lbnQuYm9keSkge1xuXHQgICAgICAgICAgICAgICAgZmlyc3RUaW1lU2V0dXAgPSB0cnVlO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgc3ZnID0gU1ZHLmluaXRTVkcoc3ZnLCByb290Tm9kZS5wcm9wZXJ0aWVzLndpZHRoLCByb290Tm9kZS5wcm9wZXJ0aWVzLmhlaWdodCk7XG5cdCAgICAgICAgICAgIC8vU2hvdyBzdGFnaW5nIGVsZW1lbnQgYmVmb3JlIHN0YWdpbmdcblx0ICAgICAgICAgICAgc3ZnLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuXG5cdCAgICAgICAgICAgIGlmIChmaXJzdFRpbWVTZXR1cCkge1xuXHQgICAgICAgICAgICAgICAgc3RhZ2luZ1RleHQgPSBET00ubmV3RWwoJ3RleHQnLCBTVkdfTlMpO1xuXHQgICAgICAgICAgICAgICAgc3RhZ2luZ1RleHROb2RlID0gdG5vZGUobnVsbCk7XG5cdCAgICAgICAgICAgICAgICBET00uc2V0QXR0cihzdGFnaW5nVGV4dCwge1xuXHQgICAgICAgICAgICAgICAgICAgIHg6IDBcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgc3RhZ2luZ1RleHQuYXBwZW5kQ2hpbGQoc3RhZ2luZ1RleHROb2RlKTtcblx0ICAgICAgICAgICAgICAgIHN2Zy5hcHBlbmRDaGlsZChzdGFnaW5nVGV4dCk7XG5cdCAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHN2Zyk7XG5cdCAgICAgICAgICAgICAgICBzdmcuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuXHQgICAgICAgICAgICAgICAgc3ZnLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcblx0ICAgICAgICAgICAgICAgIHN2Zy5zdHlsZS50b3AgPSAnLTEwMCUnO1xuXHQgICAgICAgICAgICAgICAgc3ZnLnN0eWxlLmxlZnQgPSAnLTEwMCUnO1xuXHQgICAgICAgICAgICAgICAgLy90b2RvOiB3b3JrYXJvdW5kIGZvciB6ZXJvLWRpbWVuc2lvbiA8c3ZnPiB0YWcgaW4gT3BlcmEgMTJcblx0ICAgICAgICAgICAgICAgIC8vc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAwKTtcblx0ICAgICAgICAgICAgICAgIC8vc3ZnLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgMCk7XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICB2YXIgaG9sZGVyVGV4dEdyb3VwID0gcm9vdE5vZGUuY2hpbGRyZW4uaG9sZGVyVGV4dEdyb3VwO1xuXHQgICAgICAgICAgICB2YXIgaHRnUHJvcHMgPSBob2xkZXJUZXh0R3JvdXAucHJvcGVydGllcztcblx0ICAgICAgICAgICAgRE9NLnNldEF0dHIoc3RhZ2luZ1RleHQsIHtcblx0ICAgICAgICAgICAgICAgICd5JzogaHRnUHJvcHMuZm9udC5zaXplLFxuXHQgICAgICAgICAgICAgICAgJ3N0eWxlJzogdXRpbHMuY3NzUHJvcHMoe1xuXHQgICAgICAgICAgICAgICAgICAgICdmb250LXdlaWdodCc6IGh0Z1Byb3BzLmZvbnQud2VpZ2h0LFxuXHQgICAgICAgICAgICAgICAgICAgICdmb250LXNpemUnOiBodGdQcm9wcy5mb250LnNpemUgKyBodGdQcm9wcy5mb250LnVuaXRzLFxuXHQgICAgICAgICAgICAgICAgICAgICdmb250LWZhbWlseSc6IGh0Z1Byb3BzLmZvbnQuZmFtaWx5XG5cdCAgICAgICAgICAgICAgICB9KVxuXHQgICAgICAgICAgICB9KTtcblxuXHQgICAgICAgICAgICAvL0dldCBib3VuZGluZyBib3ggZm9yIHRoZSB3aG9sZSBzdHJpbmcgKHRvdGFsIHdpZHRoIGFuZCBoZWlnaHQpXG5cdCAgICAgICAgICAgIHN0YWdpbmdUZXh0Tm9kZS5ub2RlVmFsdWUgPSBodGdQcm9wcy50ZXh0O1xuXHQgICAgICAgICAgICB2YXIgc3RhZ2luZ1RleHRCQm94ID0gc3RhZ2luZ1RleHQuZ2V0QkJveCgpO1xuXG5cdCAgICAgICAgICAgIC8vR2V0IGxpbmUgY291bnQgYW5kIHNwbGl0IHRoZSBzdHJpbmcgaW50byB3b3Jkc1xuXHQgICAgICAgICAgICB2YXIgbGluZUNvdW50ID0gTWF0aC5jZWlsKHN0YWdpbmdUZXh0QkJveC53aWR0aCAvIHJvb3ROb2RlLnByb3BlcnRpZXMud2lkdGgpO1xuXHQgICAgICAgICAgICB2YXIgd29yZHMgPSBodGdQcm9wcy50ZXh0LnNwbGl0KCcgJyk7XG5cdCAgICAgICAgICAgIHZhciBuZXdsaW5lcyA9IGh0Z1Byb3BzLnRleHQubWF0Y2goL1xcXFxuL2cpO1xuXHQgICAgICAgICAgICBsaW5lQ291bnQgKz0gbmV3bGluZXMgPT0gbnVsbCA/IDAgOiBuZXdsaW5lcy5sZW5ndGg7XG5cblx0ICAgICAgICAgICAgLy9HZXQgYm91bmRpbmcgYm94IGZvciB0aGUgc3RyaW5nIHdpdGggc3BhY2VzIHJlbW92ZWRcblx0ICAgICAgICAgICAgc3RhZ2luZ1RleHROb2RlLm5vZGVWYWx1ZSA9IGh0Z1Byb3BzLnRleHQucmVwbGFjZSgvWyBdKy9nLCAnJyk7XG5cdCAgICAgICAgICAgIHZhciBjb21wdXRlZE5vU3BhY2VMZW5ndGggPSBzdGFnaW5nVGV4dC5nZXRDb21wdXRlZFRleHRMZW5ndGgoKTtcblxuXHQgICAgICAgICAgICAvL0NvbXB1dGUgYXZlcmFnZSBzcGFjZSB3aWR0aFxuXHQgICAgICAgICAgICB2YXIgZGlmZkxlbmd0aCA9IHN0YWdpbmdUZXh0QkJveC53aWR0aCAtIGNvbXB1dGVkTm9TcGFjZUxlbmd0aDtcblx0ICAgICAgICAgICAgdmFyIHNwYWNlV2lkdGggPSBNYXRoLnJvdW5kKGRpZmZMZW5ndGggLyBNYXRoLm1heCgxLCB3b3Jkcy5sZW5ndGggLSAxKSk7XG5cblx0ICAgICAgICAgICAgLy9HZXQgd2lkdGhzIGZvciBldmVyeSB3b3JkIHdpdGggc3BhY2Ugb25seSBpZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIGxpbmVcblx0ICAgICAgICAgICAgdmFyIHdvcmRXaWR0aHMgPSBbXTtcblx0ICAgICAgICAgICAgaWYgKGxpbmVDb3VudCA+IDEpIHtcblx0ICAgICAgICAgICAgICAgIHN0YWdpbmdUZXh0Tm9kZS5ub2RlVmFsdWUgPSAnJztcblx0ICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAod29yZHNbaV0ubGVuZ3RoID09PSAwKSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgICBzdGFnaW5nVGV4dE5vZGUubm9kZVZhbHVlID0gdXRpbHMuZGVjb2RlSHRtbEVudGl0eSh3b3Jkc1tpXSk7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIGJib3ggPSBzdGFnaW5nVGV4dC5nZXRCQm94KCk7XG5cdCAgICAgICAgICAgICAgICAgICAgd29yZFdpZHRocy5wdXNoKHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogd29yZHNbaV0sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBiYm94LndpZHRoXG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAvL0hpZGUgc3RhZ2luZyBlbGVtZW50IGFmdGVyIHN0YWdpbmdcblx0ICAgICAgICAgICAgc3ZnLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cblx0ICAgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgICAgIHNwYWNlV2lkdGg6IHNwYWNlV2lkdGgsXG5cdCAgICAgICAgICAgICAgICBsaW5lQ291bnQ6IGxpbmVDb3VudCxcblx0ICAgICAgICAgICAgICAgIGJvdW5kaW5nQm94OiBzdGFnaW5nVGV4dEJCb3gsXG5cdCAgICAgICAgICAgICAgICB3b3Jkczogd29yZFdpZHRoc1xuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIC8vdG9kbzogY2FudmFzIGZhbGxiYWNrIGZvciBtZWFzdXJpbmcgdGV4dCBvbiBhbmRyb2lkIDIuM1xuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0fSkoKTtcblxuXHQvL0hlbHBlcnNcblxuXHQvKipcblx0ICogUHJldmVudHMgYSBmdW5jdGlvbiBmcm9tIGJlaW5nIGNhbGxlZCB0b28gb2Z0ZW4sIHdhaXRzIHVudGlsIGEgdGltZXIgZWxhcHNlcyB0byBjYWxsIGl0IGFnYWluXG5cdCAqXG5cdCAqIEBwYXJhbSBmbiBGdW5jdGlvbiB0byBjYWxsXG5cdCAqL1xuXHRmdW5jdGlvbiBkZWJvdW5jZShmbikge1xuXHQgICAgaWYgKCFBcHAudmFycy5kZWJvdW5jZVRpbWVyKSBmbi5jYWxsKHRoaXMpO1xuXHQgICAgaWYgKEFwcC52YXJzLmRlYm91bmNlVGltZXIpIGdsb2JhbC5jbGVhclRpbWVvdXQoQXBwLnZhcnMuZGVib3VuY2VUaW1lcik7XG5cdCAgICBBcHAudmFycy5kZWJvdW5jZVRpbWVyID0gZ2xvYmFsLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgQXBwLnZhcnMuZGVib3VuY2VUaW1lciA9IG51bGw7XG5cdCAgICAgICAgZm4uY2FsbCh0aGlzKTtcblx0ICAgIH0sIEFwcC5zZXR1cC5kZWJvdW5jZSk7XG5cdH1cblxuXHQvKipcblx0ICogSG9sZGVyLXNwZWNpZmljIHJlc2l6ZS9vcmllbnRhdGlvbiBjaGFuZ2UgY2FsbGJhY2ssIGRlYm91bmNlZCB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSBleGVjdXRpb25cblx0ICovXG5cdGZ1bmN0aW9uIHJlc2l6ZUV2ZW50KCkge1xuXHQgICAgZGVib3VuY2UoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdXBkYXRlUmVzaXphYmxlRWxlbWVudHMobnVsbCk7XG5cdCAgICB9KTtcblx0fVxuXG5cdC8vU2V0IHVwIGZsYWdzXG5cblx0Zm9yICh2YXIgZmxhZyBpbiBBcHAuZmxhZ3MpIHtcblx0ICAgIGlmICghQXBwLmZsYWdzLmhhc093blByb3BlcnR5KGZsYWcpKSBjb250aW51ZTtcblx0ICAgIEFwcC5mbGFnc1tmbGFnXS5tYXRjaCA9IGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgICAgIHJldHVybiB2YWwubWF0Y2godGhpcy5yZWdleCk7XG5cdCAgICB9O1xuXHR9XG5cblx0Ly9Qcm9wZXJ0aWVzIHNldCBvbmNlIG9uIHNldHVwXG5cblx0QXBwLnNldHVwID0ge1xuXHQgICAgcmVuZGVyZXI6ICdodG1sJyxcblx0ICAgIGRlYm91bmNlOiAxMDAsXG5cdCAgICByYXRpbzogMSxcblx0ICAgIHN1cHBvcnRzQ2FudmFzOiBmYWxzZSxcblx0ICAgIHN1cHBvcnRzU1ZHOiBmYWxzZSxcblx0ICAgIGxpbmVXcmFwUmF0aW86IDAuOSxcblx0ICAgIGRhdGFBdHRyOiAnZGF0YS1zcmMnLFxuXHQgICAgcmVuZGVyZXJzOiBbJ2h0bWwnLCAnY2FudmFzJywgJ3N2ZyddXG5cdH07XG5cblx0Ly9Qcm9wZXJ0aWVzIG1vZGlmaWVkIGR1cmluZyBydW50aW1lXG5cblx0QXBwLnZhcnMgPSB7XG5cdCAgICBwcmVlbXB0ZWQ6IGZhbHNlLFxuXHQgICAgcmVzaXphYmxlSW1hZ2VzOiBbXSxcblx0ICAgIGludmlzaWJsZUltYWdlczoge30sXG5cdCAgICBpbnZpc2libGVJZDogMCxcblx0ICAgIHZpc2liaWxpdHlDaGVja1N0YXJ0ZWQ6IGZhbHNlLFxuXHQgICAgZGVib3VuY2VUaW1lcjogbnVsbCxcblx0ICAgIGNhY2hlOiB7fVxuXHR9O1xuXG5cdC8vUHJlLWZsaWdodFxuXG5cdChmdW5jdGlvbigpIHtcblx0ICAgIHZhciBjYW52YXMgPSBET00ubmV3RWwoJ2NhbnZhcycpO1xuXG5cdCAgICBpZiAoY2FudmFzLmdldENvbnRleHQpIHtcblx0ICAgICAgICBpZiAoY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJykuaW5kZXhPZignZGF0YTppbWFnZS9wbmcnKSAhPSAtMSkge1xuXHQgICAgICAgICAgICBBcHAuc2V0dXAucmVuZGVyZXIgPSAnY2FudmFzJztcblx0ICAgICAgICAgICAgQXBwLnNldHVwLnN1cHBvcnRzQ2FudmFzID0gdHJ1ZTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGlmICghIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyAmJiAhIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhTVkdfTlMsICdzdmcnKS5jcmVhdGVTVkdSZWN0KSB7XG5cdCAgICAgICAgQXBwLnNldHVwLnJlbmRlcmVyID0gJ3N2Zyc7XG5cdCAgICAgICAgQXBwLnNldHVwLnN1cHBvcnRzU1ZHID0gdHJ1ZTtcblx0ICAgIH1cblx0fSkoKTtcblxuXHQvL1N0YXJ0cyBjaGVja2luZyBmb3IgaW52aXNpYmxlIHBsYWNlaG9sZGVyc1xuXHRzdGFydFZpc2liaWxpdHlDaGVjaygpO1xuXG5cdGlmIChvbkRvbVJlYWR5KSB7XG5cdCAgICBvbkRvbVJlYWR5KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICghQXBwLnZhcnMucHJlZW1wdGVkKSB7XG5cdCAgICAgICAgICAgIEhvbGRlci5ydW4oKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKSB7XG5cdCAgICAgICAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVFdmVudCwgZmFsc2UpO1xuXHQgICAgICAgICAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignb3JpZW50YXRpb25jaGFuZ2UnLCByZXNpemVFdmVudCwgZmFsc2UpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGdsb2JhbC5hdHRhY2hFdmVudCgnb25yZXNpemUnLCByZXNpemVFdmVudCk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaWYgKHR5cGVvZiBnbG9iYWwuVHVyYm9saW5rcyA9PSAnb2JqZWN0Jykge1xuXHQgICAgICAgICAgICBnbG9iYWwuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncGFnZTpjaGFuZ2UnLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgICAgIEhvbGRlci5ydW4oKTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfSk7XG5cdH1cblxuXHRtb2R1bGUuZXhwb3J0cyA9IEhvbGRlcjtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpXG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKiFcblx0ICogb25Eb21SZWFkeS5qcyAxLjQuMCAoYykgMjAxMyBUdWJhbCBNYXJ0aW4gLSBNSVQgbGljZW5zZVxuXHQgKlxuXHQgKiBTcGVjaWFsbHkgbW9kaWZpZWQgdG8gd29yayB3aXRoIEhvbGRlci5qc1xuXHQgKi9cblxuXHRmdW5jdGlvbiBfb25Eb21SZWFkeSh3aW4pIHtcblx0ICAgIC8vTGF6eSBsb2FkaW5nIGZpeCBmb3IgRmlyZWZveCA8IDMuNlxuXHQgICAgLy9odHRwOi8vd2VicmVmbGVjdGlvbi5ibG9nc3BvdC5jb20vMjAwOS8xMS8xOTUtY2hhcnMtdG8taGVscC1sYXp5LWxvYWRpbmcuaHRtbFxuXHQgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT0gbnVsbCAmJiBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7XG5cdCAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gRE9NQ29udGVudExvYWRlZCgpIHtcblx0ICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgRE9NQ29udGVudExvYWRlZCwgZmFsc2UpO1xuXHQgICAgICAgICAgICBkb2N1bWVudC5yZWFkeVN0YXRlID0gXCJjb21wbGV0ZVwiO1xuXHQgICAgICAgIH0sIGZhbHNlKTtcblx0ICAgICAgICBkb2N1bWVudC5yZWFkeVN0YXRlID0gXCJsb2FkaW5nXCI7XG5cdCAgICB9XG5cdCAgICBcblx0ICAgIHZhciBkb2MgPSB3aW4uZG9jdW1lbnQsXG5cdCAgICAgICAgZG9jRWxlbSA9IGRvYy5kb2N1bWVudEVsZW1lbnQsXG5cdCAgICBcblx0ICAgICAgICBMT0FEID0gXCJsb2FkXCIsXG5cdCAgICAgICAgRkFMU0UgPSBmYWxzZSxcblx0ICAgICAgICBPTkxPQUQgPSBcIm9uXCIrTE9BRCxcblx0ICAgICAgICBDT01QTEVURSA9IFwiY29tcGxldGVcIixcblx0ICAgICAgICBSRUFEWVNUQVRFID0gXCJyZWFkeVN0YXRlXCIsXG5cdCAgICAgICAgQVRUQUNIRVZFTlQgPSBcImF0dGFjaEV2ZW50XCIsXG5cdCAgICAgICAgREVUQUNIRVZFTlQgPSBcImRldGFjaEV2ZW50XCIsXG5cdCAgICAgICAgQURERVZFTlRMSVNURU5FUiA9IFwiYWRkRXZlbnRMaXN0ZW5lclwiLFxuXHQgICAgICAgIERPTUNPTlRFTlRMT0FERUQgPSBcIkRPTUNvbnRlbnRMb2FkZWRcIixcblx0ICAgICAgICBPTlJFQURZU1RBVEVDSEFOR0UgPSBcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiLFxuXHQgICAgICAgIFJFTU9WRUVWRU5UTElTVEVORVIgPSBcInJlbW92ZUV2ZW50TGlzdGVuZXJcIixcblx0ICAgIFxuXHQgICAgICAgIC8vIFczQyBFdmVudCBtb2RlbFxuXHQgICAgICAgIHczYyA9IEFEREVWRU5UTElTVEVORVIgaW4gZG9jLFxuXHQgICAgICAgIF90b3AgPSBGQUxTRSxcblx0ICAgIFxuXHQgICAgICAgIC8vIGlzUmVhZHk6IElzIHRoZSBET00gcmVhZHkgdG8gYmUgdXNlZD8gU2V0IHRvIHRydWUgb25jZSBpdCBvY2N1cnMuXG5cdCAgICAgICAgaXNSZWFkeSA9IEZBTFNFLFxuXHQgICAgXG5cdCAgICAgICAgLy8gQ2FsbGJhY2tzIHBlbmRpbmcgZXhlY3V0aW9uIHVudGlsIERPTSBpcyByZWFkeVxuXHQgICAgICAgIGNhbGxiYWNrcyA9IFtdO1xuXHQgICAgXG5cdCAgICAvLyBIYW5kbGUgd2hlbiB0aGUgRE9NIGlzIHJlYWR5XG5cdCAgICBmdW5jdGlvbiByZWFkeSggZm4gKSB7XG5cdCAgICAgICAgaWYgKCAhaXNSZWFkeSApIHtcblx0ICAgIFxuXHQgICAgICAgICAgICAvLyBNYWtlIHN1cmUgYm9keSBleGlzdHMsIGF0IGxlYXN0LCBpbiBjYXNlIElFIGdldHMgYSBsaXR0bGUgb3ZlcnplYWxvdXMgKHRpY2tldCAjNTQ0MykuXG5cdCAgICAgICAgICAgIGlmICggIWRvYy5ib2R5ICkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVyKCByZWFkeSApO1xuXHQgICAgICAgICAgICB9XG5cdCAgICBcblx0ICAgICAgICAgICAgLy8gUmVtZW1iZXIgdGhhdCB0aGUgRE9NIGlzIHJlYWR5XG5cdCAgICAgICAgICAgIGlzUmVhZHkgPSB0cnVlO1xuXHQgICAgXG5cdCAgICAgICAgICAgIC8vIEV4ZWN1dGUgYWxsIGNhbGxiYWNrc1xuXHQgICAgICAgICAgICB3aGlsZSAoIGZuID0gY2FsbGJhY2tzLnNoaWZ0KCkgKSB7XG5cdCAgICAgICAgICAgICAgICBkZWZlciggZm4gKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIFxuXHQgICAgLy8gVGhlIHJlYWR5IGV2ZW50IGhhbmRsZXJcblx0ICAgIGZ1bmN0aW9uIGNvbXBsZXRlZCggZXZlbnQgKSB7XG5cdCAgICAgICAgLy8gcmVhZHlTdGF0ZSA9PT0gXCJjb21wbGV0ZVwiIGlzIGdvb2QgZW5vdWdoIGZvciB1cyB0byBjYWxsIHRoZSBkb20gcmVhZHkgaW4gb2xkSUVcblx0ICAgICAgICBpZiAoIHczYyB8fCBldmVudC50eXBlID09PSBMT0FEIHx8IGRvY1tSRUFEWVNUQVRFXSA9PT0gQ09NUExFVEUgKSB7XG5cdCAgICAgICAgICAgIGRldGFjaCgpO1xuXHQgICAgICAgICAgICByZWFkeSgpO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIFxuXHQgICAgLy8gQ2xlYW4tdXAgbWV0aG9kIGZvciBkb20gcmVhZHkgZXZlbnRzXG5cdCAgICBmdW5jdGlvbiBkZXRhY2goKSB7XG5cdCAgICAgICAgaWYgKCB3M2MgKSB7XG5cdCAgICAgICAgICAgIGRvY1tSRU1PVkVFVkVOVExJU1RFTkVSXSggRE9NQ09OVEVOVExPQURFRCwgY29tcGxldGVkLCBGQUxTRSApO1xuXHQgICAgICAgICAgICB3aW5bUkVNT1ZFRVZFTlRMSVNURU5FUl0oIExPQUQsIGNvbXBsZXRlZCwgRkFMU0UgKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBkb2NbREVUQUNIRVZFTlRdKCBPTlJFQURZU1RBVEVDSEFOR0UsIGNvbXBsZXRlZCApO1xuXHQgICAgICAgICAgICB3aW5bREVUQUNIRVZFTlRdKCBPTkxPQUQsIGNvbXBsZXRlZCApO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIFxuXHQgICAgLy8gRGVmZXJzIGEgZnVuY3Rpb24sIHNjaGVkdWxpbmcgaXQgdG8gcnVuIGFmdGVyIHRoZSBjdXJyZW50IGNhbGwgc3RhY2sgaGFzIGNsZWFyZWQuXG5cdCAgICBmdW5jdGlvbiBkZWZlciggZm4sIHdhaXQgKSB7XG5cdCAgICAgICAgLy8gQWxsb3cgMCB0byBiZSBwYXNzZWRcblx0ICAgICAgICBzZXRUaW1lb3V0KCBmbiwgK3dhaXQgPj0gMCA/IHdhaXQgOiAxICk7XG5cdCAgICB9XG5cdCAgICBcblx0ICAgIC8vIEF0dGFjaCB0aGUgbGlzdGVuZXJzOlxuXHQgICAgXG5cdCAgICAvLyBDYXRjaCBjYXNlcyB3aGVyZSBvbkRvbVJlYWR5IGlzIGNhbGxlZCBhZnRlciB0aGUgYnJvd3NlciBldmVudCBoYXMgYWxyZWFkeSBvY2N1cnJlZC5cblx0ICAgIC8vIHdlIG9uY2UgdHJpZWQgdG8gdXNlIHJlYWR5U3RhdGUgXCJpbnRlcmFjdGl2ZVwiIGhlcmUsIGJ1dCBpdCBjYXVzZWQgaXNzdWVzIGxpa2UgdGhlIG9uZVxuXHQgICAgLy8gZGlzY292ZXJlZCBieSBDaHJpc1MgaGVyZTogaHR0cDovL2J1Z3MuanF1ZXJ5LmNvbS90aWNrZXQvMTIyODIjY29tbWVudDoxNVxuXHQgICAgaWYgKCBkb2NbUkVBRFlTVEFURV0gPT09IENPTVBMRVRFICkge1xuXHQgICAgICAgIC8vIEhhbmRsZSBpdCBhc3luY2hyb25vdXNseSB0byBhbGxvdyBzY3JpcHRzIHRoZSBvcHBvcnR1bml0eSB0byBkZWxheSByZWFkeVxuXHQgICAgICAgIGRlZmVyKCByZWFkeSApO1xuXHQgICAgXG5cdCAgICAvLyBTdGFuZGFyZHMtYmFzZWQgYnJvd3NlcnMgc3VwcG9ydCBET01Db250ZW50TG9hZGVkXG5cdCAgICB9IGVsc2UgaWYgKCB3M2MgKSB7XG5cdCAgICAgICAgLy8gVXNlIHRoZSBoYW5keSBldmVudCBjYWxsYmFja1xuXHQgICAgICAgIGRvY1tBRERFVkVOVExJU1RFTkVSXSggRE9NQ09OVEVOVExPQURFRCwgY29tcGxldGVkLCBGQUxTRSApO1xuXHQgICAgXG5cdCAgICAgICAgLy8gQSBmYWxsYmFjayB0byB3aW5kb3cub25sb2FkLCB0aGF0IHdpbGwgYWx3YXlzIHdvcmtcblx0ICAgICAgICB3aW5bQURERVZFTlRMSVNURU5FUl0oIExPQUQsIGNvbXBsZXRlZCwgRkFMU0UgKTtcblx0ICAgIFxuXHQgICAgLy8gSWYgSUUgZXZlbnQgbW9kZWwgaXMgdXNlZFxuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgICAvLyBFbnN1cmUgZmlyaW5nIGJlZm9yZSBvbmxvYWQsIG1heWJlIGxhdGUgYnV0IHNhZmUgYWxzbyBmb3IgaWZyYW1lc1xuXHQgICAgICAgIGRvY1tBVFRBQ0hFVkVOVF0oIE9OUkVBRFlTVEFURUNIQU5HRSwgY29tcGxldGVkICk7XG5cdCAgICBcblx0ICAgICAgICAvLyBBIGZhbGxiYWNrIHRvIHdpbmRvdy5vbmxvYWQsIHRoYXQgd2lsbCBhbHdheXMgd29ya1xuXHQgICAgICAgIHdpbltBVFRBQ0hFVkVOVF0oIE9OTE9BRCwgY29tcGxldGVkICk7XG5cdCAgICBcblx0ICAgICAgICAvLyBJZiBJRSBhbmQgbm90IGEgZnJhbWVcblx0ICAgICAgICAvLyBjb250aW51YWxseSBjaGVjayB0byBzZWUgaWYgdGhlIGRvY3VtZW50IGlzIHJlYWR5XG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgX3RvcCA9IHdpbi5mcmFtZUVsZW1lbnQgPT0gbnVsbCAmJiBkb2NFbGVtO1xuXHQgICAgICAgIH0gY2F0Y2goZSkge31cblx0ICAgIFxuXHQgICAgICAgIGlmICggX3RvcCAmJiBfdG9wLmRvU2Nyb2xsICkge1xuXHQgICAgICAgICAgICAoZnVuY3Rpb24gZG9TY3JvbGxDaGVjaygpIHtcblx0ICAgICAgICAgICAgICAgIGlmICggIWlzUmVhZHkgKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXNlIHRoZSB0cmljayBieSBEaWVnbyBQZXJpbmlcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gaHR0cDovL2phdmFzY3JpcHQubndib3guY29tL0lFQ29udGVudExvYWRlZC9cblx0ICAgICAgICAgICAgICAgICAgICAgICAgX3RvcC5kb1Njcm9sbChcImxlZnRcIik7XG5cdCAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWZlciggZG9TY3JvbGxDaGVjaywgNTAgKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICBcblx0ICAgICAgICAgICAgICAgICAgICAvLyBkZXRhY2ggYWxsIGRvbSByZWFkeSBldmVudHNcblx0ICAgICAgICAgICAgICAgICAgICBkZXRhY2goKTtcblx0ICAgIFxuXHQgICAgICAgICAgICAgICAgICAgIC8vIGFuZCBleGVjdXRlIGFueSB3YWl0aW5nIGZ1bmN0aW9uc1xuXHQgICAgICAgICAgICAgICAgICAgIHJlYWR5KCk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHQgICAgXG5cdCAgICBmdW5jdGlvbiBvbkRvbVJlYWR5KCBmbiApIHtcblx0ICAgICAgICAvLyBJZiBET00gaXMgcmVhZHksIGV4ZWN1dGUgdGhlIGZ1bmN0aW9uIChhc3luYyksIG90aGVyd2lzZSB3YWl0XG5cdCAgICAgICAgaXNSZWFkeSA/IGRlZmVyKCBmbiApIDogY2FsbGJhY2tzLnB1c2goIGZuICk7XG5cdCAgICB9XG5cdCAgICBcblx0ICAgIC8vIEFkZCB2ZXJzaW9uXG5cdCAgICBvbkRvbVJlYWR5LnZlcnNpb24gPSBcIjEuNC4wXCI7XG5cdCAgICAvLyBBZGQgbWV0aG9kIHRvIGNoZWNrIGlmIERPTSBpcyByZWFkeVxuXHQgICAgb25Eb21SZWFkeS5pc1JlYWR5ID0gZnVuY3Rpb24oKXtcblx0ICAgICAgICByZXR1cm4gaXNSZWFkeTtcblx0ICAgIH07XG5cblx0ICAgIHJldHVybiBvbkRvbVJlYWR5O1xuXHR9XG5cblx0bW9kdWxlLmV4cG9ydHMgPSB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiICYmIF9vbkRvbVJlYWR5KHdpbmRvdyk7XG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvL01vZGlmaWVkIHZlcnNpb24gb2YgY29tcG9uZW50L3F1ZXJ5c3RyaW5nXG5cdC8vQ2hhbmdlczogdXBkYXRlZCBkZXBlbmRlbmNpZXMsIGRvdCBub3RhdGlvbiBwYXJzaW5nLCBKU0hpbnQgZml4ZXNcblx0Ly9Gb3JrIGF0IGh0dHBzOi8vZ2l0aHViLmNvbS9pbXNreS9xdWVyeXN0cmluZ1xuXG5cdC8qKlxuXHQgKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuXHQgKi9cblxuXHR2YXIgZW5jb2RlID0gZW5jb2RlVVJJQ29tcG9uZW50O1xuXHR2YXIgZGVjb2RlID0gZGVjb2RlVVJJQ29tcG9uZW50O1xuXHR2YXIgdHJpbSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cdHZhciB0eXBlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblxuXHR2YXIgYXJyYXlSZWdleCA9IC8oXFx3KylcXFsoXFxkKylcXF0vO1xuXHR2YXIgb2JqZWN0UmVnZXggPSAvXFx3K1xcLlxcdysvO1xuXG5cdC8qKlxuXHQgKiBQYXJzZSB0aGUgZ2l2ZW4gcXVlcnkgYHN0cmAuXG5cdCAqXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcblx0ICogQHJldHVybiB7T2JqZWN0fVxuXHQgKiBAYXBpIHB1YmxpY1xuXHQgKi9cblxuXHRleHBvcnRzLnBhcnNlID0gZnVuY3Rpb24oc3RyKXtcblx0ICBpZiAoJ3N0cmluZycgIT09IHR5cGVvZiBzdHIpIHJldHVybiB7fTtcblxuXHQgIHN0ciA9IHRyaW0oc3RyKTtcblx0ICBpZiAoJycgPT09IHN0cikgcmV0dXJuIHt9O1xuXHQgIGlmICgnPycgPT09IHN0ci5jaGFyQXQoMCkpIHN0ciA9IHN0ci5zbGljZSgxKTtcblxuXHQgIHZhciBvYmogPSB7fTtcblx0ICB2YXIgcGFpcnMgPSBzdHIuc3BsaXQoJyYnKTtcblx0ICBmb3IgKHZhciBpID0gMDsgaSA8IHBhaXJzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICB2YXIgcGFydHMgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xuXHQgICAgdmFyIGtleSA9IGRlY29kZShwYXJ0c1swXSk7XG5cdCAgICB2YXIgbSwgY3R4LCBwcm9wO1xuXG5cdCAgICBpZiAobSA9IGFycmF5UmVnZXguZXhlYyhrZXkpKSB7XG5cdCAgICAgIG9ialttWzFdXSA9IG9ialttWzFdXSB8fCBbXTtcblx0ICAgICAgb2JqW21bMV1dW21bMl1dID0gZGVjb2RlKHBhcnRzWzFdKTtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cblx0ICAgIGlmIChtID0gb2JqZWN0UmVnZXgudGVzdChrZXkpKSB7XG5cdCAgICAgIG0gPSBrZXkuc3BsaXQoJy4nKTtcblx0ICAgICAgY3R4ID0gb2JqO1xuXHQgICAgICBcblx0ICAgICAgd2hpbGUgKG0ubGVuZ3RoKSB7XG5cdCAgICAgICAgcHJvcCA9IG0uc2hpZnQoKTtcblxuXHQgICAgICAgIGlmICghcHJvcC5sZW5ndGgpIGNvbnRpbnVlO1xuXG5cdCAgICAgICAgaWYgKCFjdHhbcHJvcF0pIHtcblx0ICAgICAgICAgIGN0eFtwcm9wXSA9IHt9O1xuXHQgICAgICAgIH0gZWxzZSBpZiAoY3R4W3Byb3BdICYmIHR5cGVvZiBjdHhbcHJvcF0gIT09ICdvYmplY3QnKSB7XG5cdCAgICAgICAgICBicmVhaztcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpZiAoIW0ubGVuZ3RoKSB7XG5cdCAgICAgICAgICBjdHhbcHJvcF0gPSBkZWNvZGUocGFydHNbMV0pO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGN0eCA9IGN0eFtwcm9wXTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXG5cdCAgICBvYmpbcGFydHNbMF1dID0gbnVsbCA9PSBwYXJ0c1sxXSA/ICcnIDogZGVjb2RlKHBhcnRzWzFdKTtcblx0ICB9XG5cblx0ICByZXR1cm4gb2JqO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBTdHJpbmdpZnkgdGhlIGdpdmVuIGBvYmpgLlxuXHQgKlxuXHQgKiBAcGFyYW0ge09iamVjdH0gb2JqXG5cdCAqIEByZXR1cm4ge1N0cmluZ31cblx0ICogQGFwaSBwdWJsaWNcblx0ICovXG5cblx0ZXhwb3J0cy5zdHJpbmdpZnkgPSBmdW5jdGlvbihvYmope1xuXHQgIGlmICghb2JqKSByZXR1cm4gJyc7XG5cdCAgdmFyIHBhaXJzID0gW107XG5cblx0ICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdCAgICB2YXIgdmFsdWUgPSBvYmpba2V5XTtcblxuXHQgICAgaWYgKCdhcnJheScgPT0gdHlwZSh2YWx1ZSkpIHtcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7ICsraSkge1xuXHQgICAgICAgIHBhaXJzLnB1c2goZW5jb2RlKGtleSArICdbJyArIGkgKyAnXScpICsgJz0nICsgZW5jb2RlKHZhbHVlW2ldKSk7XG5cdCAgICAgIH1cblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cblx0ICAgIHBhaXJzLnB1c2goZW5jb2RlKGtleSkgKyAnPScgKyBlbmNvZGUob2JqW2tleV0pKTtcblx0ICB9XG5cblx0ICByZXR1cm4gcGFpcnMuam9pbignJicpO1xuXHR9O1xuXG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcblx0ZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gdHJpbTtcblxuXHRmdW5jdGlvbiB0cmltKHN0cil7XG5cdCAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzKnxcXHMqJC9nLCAnJyk7XG5cdH1cblxuXHRleHBvcnRzLmxlZnQgPSBmdW5jdGlvbihzdHIpe1xuXHQgIHJldHVybiBzdHIucmVwbGFjZSgvXlxccyovLCAnJyk7XG5cdH07XG5cblx0ZXhwb3J0cy5yaWdodCA9IGZ1bmN0aW9uKHN0cil7XG5cdCAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXHMqJC8sICcnKTtcblx0fTtcblxuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0LyoqXG5cdCAqIHRvU3RyaW5nIHJlZi5cblx0ICovXG5cblx0dmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuXHQvKipcblx0ICogUmV0dXJuIHRoZSB0eXBlIG9mIGB2YWxgLlxuXHQgKlxuXHQgKiBAcGFyYW0ge01peGVkfSB2YWxcblx0ICogQHJldHVybiB7U3RyaW5nfVxuXHQgKiBAYXBpIHB1YmxpY1xuXHQgKi9cblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZhbCl7XG5cdCAgc3dpdGNoICh0b1N0cmluZy5jYWxsKHZhbCkpIHtcblx0ICAgIGNhc2UgJ1tvYmplY3QgRGF0ZV0nOiByZXR1cm4gJ2RhdGUnO1xuXHQgICAgY2FzZSAnW29iamVjdCBSZWdFeHBdJzogcmV0dXJuICdyZWdleHAnO1xuXHQgICAgY2FzZSAnW29iamVjdCBBcmd1bWVudHNdJzogcmV0dXJuICdhcmd1bWVudHMnO1xuXHQgICAgY2FzZSAnW29iamVjdCBBcnJheV0nOiByZXR1cm4gJ2FycmF5Jztcblx0ICAgIGNhc2UgJ1tvYmplY3QgRXJyb3JdJzogcmV0dXJuICdlcnJvcic7XG5cdCAgfVxuXG5cdCAgaWYgKHZhbCA9PT0gbnVsbCkgcmV0dXJuICdudWxsJztcblx0ICBpZiAodmFsID09PSB1bmRlZmluZWQpIHJldHVybiAndW5kZWZpbmVkJztcblx0ICBpZiAodmFsICE9PSB2YWwpIHJldHVybiAnbmFuJztcblx0ICBpZiAodmFsICYmIHZhbC5ub2RlVHlwZSA9PT0gMSkgcmV0dXJuICdlbGVtZW50JztcblxuXHQgIGlmIChpc0J1ZmZlcih2YWwpKSByZXR1cm4gJ2J1ZmZlcic7XG5cblx0ICB2YWwgPSB2YWwudmFsdWVPZlxuXHQgICAgPyB2YWwudmFsdWVPZigpXG5cdCAgICA6IE9iamVjdC5wcm90b3R5cGUudmFsdWVPZi5hcHBseSh2YWwpO1xuXG5cdCAgcmV0dXJuIHR5cGVvZiB2YWw7XG5cdH07XG5cblx0Ly8gY29kZSBib3Jyb3dlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9mZXJvc3MvaXMtYnVmZmVyL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG5cdGZ1bmN0aW9uIGlzQnVmZmVyKG9iaikge1xuXHQgIHJldHVybiAhIShvYmogIT0gbnVsbCAmJlxuXHQgICAgKG9iai5faXNCdWZmZXIgfHwgLy8gRm9yIFNhZmFyaSA1LTcgKG1pc3NpbmcgT2JqZWN0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvcilcblx0ICAgICAgKG9iai5jb25zdHJ1Y3RvciAmJlxuXHQgICAgICB0eXBlb2Ygb2JqLmNvbnN0cnVjdG9yLmlzQnVmZmVyID09PSAnZnVuY3Rpb24nICYmXG5cdCAgICAgIG9iai5jb25zdHJ1Y3Rvci5pc0J1ZmZlcihvYmopKVxuXHQgICAgKSlcblx0fVxuXG5cbi8qKiovIH0sXG4vKiA2ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHR2YXIgU2NlbmVHcmFwaCA9IGZ1bmN0aW9uKHNjZW5lUHJvcGVydGllcykge1xuXHQgICAgdmFyIG5vZGVDb3VudCA9IDE7XG5cblx0ICAgIC8vdG9kbzogbW92ZSBtZXJnZSB0byBoZWxwZXJzIHNlY3Rpb25cblx0ICAgIGZ1bmN0aW9uIG1lcmdlKHBhcmVudCwgY2hpbGQpIHtcblx0ICAgICAgICBmb3IgKHZhciBwcm9wIGluIGNoaWxkKSB7XG5cdCAgICAgICAgICAgIHBhcmVudFtwcm9wXSA9IGNoaWxkW3Byb3BdO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gcGFyZW50O1xuXHQgICAgfVxuXG5cdCAgICB2YXIgU2NlbmVOb2RlID0gZnVuY3Rpb24obmFtZSkge1xuXHQgICAgICAgIG5vZGVDb3VudCsrO1xuXHQgICAgICAgIHRoaXMucGFyZW50ID0gbnVsbDtcblx0ICAgICAgICB0aGlzLmNoaWxkcmVuID0ge307XG5cdCAgICAgICAgdGhpcy5pZCA9IG5vZGVDb3VudDtcblx0ICAgICAgICB0aGlzLm5hbWUgPSAnbicgKyBub2RlQ291bnQ7XG5cdCAgICAgICAgaWYgKHR5cGVvZiBuYW1lICE9PSAndW5kZWZpbmVkJykge1xuXHQgICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0aGlzLnggPSB0aGlzLnkgPSB0aGlzLnogPSAwO1xuXHQgICAgICAgIHRoaXMud2lkdGggPSB0aGlzLmhlaWdodCA9IDA7XG5cdCAgICB9O1xuXG5cdCAgICBTY2VuZU5vZGUucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQpIHtcblx0ICAgICAgICBpZiAod2lkdGggIT0gbnVsbCkge1xuXHQgICAgICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChoZWlnaHQgIT0gbnVsbCkge1xuXHQgICAgICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXG5cdCAgICBTY2VuZU5vZGUucHJvdG90eXBlLm1vdmVUbyA9IGZ1bmN0aW9uKHgsIHksIHopIHtcblx0ICAgICAgICB0aGlzLnggPSB4ICE9IG51bGwgPyB4IDogdGhpcy54O1xuXHQgICAgICAgIHRoaXMueSA9IHkgIT0gbnVsbCA/IHkgOiB0aGlzLnk7XG5cdCAgICAgICAgdGhpcy56ID0geiAhPSBudWxsID8geiA6IHRoaXMuejtcblx0ICAgIH07XG5cblx0ICAgIFNjZW5lTm9kZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24oY2hpbGQpIHtcblx0ICAgICAgICB2YXIgbmFtZSA9IGNoaWxkLm5hbWU7XG5cdCAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmNoaWxkcmVuW25hbWVdID09PSAndW5kZWZpbmVkJykge1xuXHQgICAgICAgICAgICB0aGlzLmNoaWxkcmVuW25hbWVdID0gY2hpbGQ7XG5cdCAgICAgICAgICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgdGhyb3cgJ1NjZW5lR3JhcGg6IGNoaWxkIGFscmVhZHkgZXhpc3RzOiAnICsgbmFtZTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXG5cdCAgICB2YXIgUm9vdE5vZGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBTY2VuZU5vZGUuY2FsbCh0aGlzLCAncm9vdCcpO1xuXHQgICAgICAgIHRoaXMucHJvcGVydGllcyA9IHNjZW5lUHJvcGVydGllcztcblx0ICAgIH07XG5cblx0ICAgIFJvb3ROb2RlLnByb3RvdHlwZSA9IG5ldyBTY2VuZU5vZGUoKTtcblxuXHQgICAgdmFyIFNoYXBlID0gZnVuY3Rpb24obmFtZSwgcHJvcHMpIHtcblx0ICAgICAgICBTY2VuZU5vZGUuY2FsbCh0aGlzLCBuYW1lKTtcblx0ICAgICAgICB0aGlzLnByb3BlcnRpZXMgPSB7XG5cdCAgICAgICAgICAgICdmaWxsJzogJyMwMDAwMDAnXG5cdCAgICAgICAgfTtcblx0ICAgICAgICBpZiAodHlwZW9mIHByb3BzICE9PSAndW5kZWZpbmVkJykge1xuXHQgICAgICAgICAgICBtZXJnZSh0aGlzLnByb3BlcnRpZXMsIHByb3BzKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBuYW1lICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcblx0ICAgICAgICAgICAgdGhyb3cgJ1NjZW5lR3JhcGg6IGludmFsaWQgbm9kZSBuYW1lJztcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXG5cdCAgICBTaGFwZS5wcm90b3R5cGUgPSBuZXcgU2NlbmVOb2RlKCk7XG5cblx0ICAgIHZhciBHcm91cCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIFNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICAgICAgdGhpcy50eXBlID0gJ2dyb3VwJztcblx0ICAgIH07XG5cblx0ICAgIEdyb3VwLnByb3RvdHlwZSA9IG5ldyBTaGFwZSgpO1xuXG5cdCAgICB2YXIgUmVjdCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIFNoYXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICAgICAgdGhpcy50eXBlID0gJ3JlY3QnO1xuXHQgICAgfTtcblxuXHQgICAgUmVjdC5wcm90b3R5cGUgPSBuZXcgU2hhcGUoKTtcblxuXHQgICAgdmFyIFRleHQgPSBmdW5jdGlvbih0ZXh0KSB7XG5cdCAgICAgICAgU2hhcGUuY2FsbCh0aGlzKTtcblx0ICAgICAgICB0aGlzLnR5cGUgPSAndGV4dCc7XG5cdCAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLnRleHQgPSB0ZXh0O1xuXHQgICAgfTtcblxuXHQgICAgVGV4dC5wcm90b3R5cGUgPSBuZXcgU2hhcGUoKTtcblxuXHQgICAgdmFyIHJvb3QgPSBuZXcgUm9vdE5vZGUoKTtcblxuXHQgICAgdGhpcy5TaGFwZSA9IHtcblx0ICAgICAgICAnUmVjdCc6IFJlY3QsXG5cdCAgICAgICAgJ1RleHQnOiBUZXh0LFxuXHQgICAgICAgICdHcm91cCc6IEdyb3VwXG5cdCAgICB9O1xuXG5cdCAgICB0aGlzLnJvb3QgPSByb290O1xuXHQgICAgcmV0dXJuIHRoaXM7XG5cdH07XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBTY2VuZUdyYXBoO1xuXG5cbi8qKiovIH0sXG4vKiA3ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7LyoqXG5cdCAqIFNoYWxsb3cgb2JqZWN0IGNsb25lIGFuZCBtZXJnZVxuXHQgKlxuXHQgKiBAcGFyYW0gYSBPYmplY3QgQVxuXHQgKiBAcGFyYW0gYiBPYmplY3QgQlxuXHQgKiBAcmV0dXJucyB7T2JqZWN0fSBOZXcgb2JqZWN0IHdpdGggYWxsIG9mIEEncyBwcm9wZXJ0aWVzLCBhbmQgYWxsIG9mIEIncyBwcm9wZXJ0aWVzLCBvdmVyd3JpdGluZyBBJ3MgcHJvcGVydGllc1xuXHQgKi9cblx0ZXhwb3J0cy5leHRlbmQgPSBmdW5jdGlvbihhLCBiKSB7XG5cdCAgICB2YXIgYyA9IHt9O1xuXHQgICAgZm9yICh2YXIgeCBpbiBhKSB7XG5cdCAgICAgICAgaWYgKGEuaGFzT3duUHJvcGVydHkoeCkpIHtcblx0ICAgICAgICAgICAgY1t4XSA9IGFbeF07XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHQgICAgaWYgKGIgIT0gbnVsbCkge1xuXHQgICAgICAgIGZvciAodmFyIHkgaW4gYikge1xuXHQgICAgICAgICAgICBpZiAoYi5oYXNPd25Qcm9wZXJ0eSh5KSkge1xuXHQgICAgICAgICAgICAgICAgY1t5XSA9IGJbeV07XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gYztcblx0fTtcblxuXHQvKipcblx0ICogVGFrZXMgYSBrL3YgbGlzdCBvZiBDU1MgcHJvcGVydGllcyBhbmQgcmV0dXJucyBhIHJ1bGVcblx0ICpcblx0ICogQHBhcmFtIHByb3BzIENTUyBwcm9wZXJ0aWVzIG9iamVjdFxuXHQgKi9cblx0ZXhwb3J0cy5jc3NQcm9wcyA9IGZ1bmN0aW9uKHByb3BzKSB7XG5cdCAgICB2YXIgcmV0ID0gW107XG5cdCAgICBmb3IgKHZhciBwIGluIHByb3BzKSB7XG5cdCAgICAgICAgaWYgKHByb3BzLmhhc093blByb3BlcnR5KHApKSB7XG5cdCAgICAgICAgICAgIHJldC5wdXNoKHAgKyAnOicgKyBwcm9wc1twXSk7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHJldC5qb2luKCc7Jyk7XG5cdH07XG5cblx0LyoqXG5cdCAqIEVuY29kZXMgSFRNTCBlbnRpdGllcyBpbiBhIHN0cmluZ1xuXHQgKlxuXHQgKiBAcGFyYW0gc3RyIElucHV0IHN0cmluZ1xuXHQgKi9cblx0ZXhwb3J0cy5lbmNvZGVIdG1sRW50aXR5ID0gZnVuY3Rpb24oc3RyKSB7XG5cdCAgICB2YXIgYnVmID0gW107XG5cdCAgICB2YXIgY2hhckNvZGUgPSAwO1xuXHQgICAgZm9yICh2YXIgaSA9IHN0ci5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHQgICAgICAgIGNoYXJDb2RlID0gc3RyLmNoYXJDb2RlQXQoaSk7XG5cdCAgICAgICAgaWYgKGNoYXJDb2RlID4gMTI4KSB7XG5cdCAgICAgICAgICAgIGJ1Zi51bnNoaWZ0KFsnJiMnLCBjaGFyQ29kZSwgJzsnXS5qb2luKCcnKSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgYnVmLnVuc2hpZnQoc3RyW2ldKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gYnVmLmpvaW4oJycpO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBDaGVja3MgaWYgYW4gaW1hZ2UgZXhpc3RzXG5cdCAqXG5cdCAqIEBwYXJhbSBzcmMgVVJMIG9mIGltYWdlXG5cdCAqIEBwYXJhbSBjYWxsYmFjayBDYWxsYmFjayB0byBjYWxsIG9uY2UgaW1hZ2Ugc3RhdHVzIGhhcyBiZWVuIGZvdW5kXG5cdCAqL1xuXHRleHBvcnRzLmltYWdlRXhpc3RzID0gZnVuY3Rpb24oc3JjLCBjYWxsYmFjaykge1xuXHQgICAgdmFyIGltYWdlID0gbmV3IEltYWdlKCk7XG5cdCAgICBpbWFnZS5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCBmYWxzZSk7XG5cdCAgICB9O1xuXHQgICAgaW1hZ2Uub25sb2FkID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCB0cnVlKTtcblx0ICAgIH07XG5cdCAgICBpbWFnZS5zcmMgPSBzcmM7XG5cdH07XG5cblx0LyoqXG5cdCAqIERlY29kZXMgSFRNTCBlbnRpdGllcyBpbiBhIHN0cmluZ1xuXHQgKlxuXHQgKiBAcGFyYW0gc3RyIElucHV0IHN0cmluZ1xuXHQgKi9cblx0ZXhwb3J0cy5kZWNvZGVIdG1sRW50aXR5ID0gZnVuY3Rpb24oc3RyKSB7XG5cdCAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyYjKFxcZCspOy9nLCBmdW5jdGlvbihtYXRjaCwgZGVjKSB7XG5cdCAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoZGVjKTtcblx0ICAgIH0pO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIFJldHVybnMgYW4gZWxlbWVudCdzIGRpbWVuc2lvbnMgaWYgaXQncyB2aXNpYmxlLCBgZmFsc2VgIG90aGVyd2lzZS5cblx0ICpcblx0ICogQHBhcmFtIGVsIERPTSBlbGVtZW50XG5cdCAqL1xuXHRleHBvcnRzLmRpbWVuc2lvbkNoZWNrID0gZnVuY3Rpb24oZWwpIHtcblx0ICAgIHZhciBkaW1lbnNpb25zID0ge1xuXHQgICAgICAgIGhlaWdodDogZWwuY2xpZW50SGVpZ2h0LFxuXHQgICAgICAgIHdpZHRoOiBlbC5jbGllbnRXaWR0aFxuXHQgICAgfTtcblxuXHQgICAgaWYgKGRpbWVuc2lvbnMuaGVpZ2h0ICYmIGRpbWVuc2lvbnMud2lkdGgpIHtcblx0ICAgICAgICByZXR1cm4gZGltZW5zaW9ucztcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHR9O1xuXG5cblx0LyoqXG5cdCAqIFJldHVybnMgdHJ1ZSBpZiB2YWx1ZSBpcyB0cnV0aHkgb3IgaWYgaXQgaXMgXCJzZW1hbnRpY2FsbHkgdHJ1dGh5XCJcblx0ICogQHBhcmFtIHZhbFxuXHQgKi9cblx0ZXhwb3J0cy50cnV0aHkgPSBmdW5jdGlvbih2YWwpIHtcblx0ICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuXHQgICAgICAgIHJldHVybiB2YWwgPT09ICd0cnVlJyB8fCB2YWwgPT09ICd5ZXMnIHx8IHZhbCA9PT0gJzEnIHx8IHZhbCA9PT0gJ29uJyB8fCB2YWwgPT09ICfinJMnO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuICEhdmFsO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBQYXJzZXMgaW5wdXQgaW50byBhIHdlbGwtZm9ybWVkIENTUyBjb2xvclxuXHQgKiBAcGFyYW0gdmFsXG5cdCAqL1xuXHRleHBvcnRzLnBhcnNlQ29sb3IgPSBmdW5jdGlvbih2YWwpIHtcblx0ICAgIHZhciBoZXhyZSA9IC8oXig/OiM/KVswLTlhLWZdezZ9JCl8KF4oPzojPylbMC05YS1mXXszfSQpL2k7XG5cdCAgICB2YXIgcmdicmUgPSAvXnJnYlxcKChcXGR7MSwzfSlcXHMqLFxccyooXFxkezEsM30pXFxzKixcXHMqKFxcZHsxLDN9KVxccypcXCkkLztcblx0ICAgIHZhciByZ2JhcmUgPSAvXnJnYmFcXCgoXFxkezEsM30pXFxzKixcXHMqKFxcZHsxLDN9KVxccyosXFxzKihcXGR7MSwzfSlcXHMqLFxccyooMFxcLlxcZHsxLH18MSlcXCkkLztcblxuXHQgICAgdmFyIG1hdGNoID0gdmFsLm1hdGNoKGhleHJlKTtcblx0ICAgIHZhciByZXR2YWw7XG5cblx0ICAgIGlmIChtYXRjaCAhPT0gbnVsbCkge1xuXHQgICAgICAgIHJldHZhbCA9IG1hdGNoWzFdIHx8IG1hdGNoWzJdO1xuXHQgICAgICAgIGlmIChyZXR2YWxbMF0gIT09ICcjJykge1xuXHQgICAgICAgICAgICByZXR1cm4gJyMnICsgcmV0dmFsO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHJldHVybiByZXR2YWw7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBtYXRjaCA9IHZhbC5tYXRjaChyZ2JyZSk7XG5cblx0ICAgIGlmIChtYXRjaCAhPT0gbnVsbCkge1xuXHQgICAgICAgIHJldHZhbCA9ICdyZ2IoJyArIG1hdGNoLnNsaWNlKDEpLmpvaW4oJywnKSArICcpJztcblx0ICAgICAgICByZXR1cm4gcmV0dmFsO1xuXHQgICAgfVxuXG5cdCAgICBtYXRjaCA9IHZhbC5tYXRjaChyZ2JhcmUpO1xuXG5cdCAgICBpZiAobWF0Y2ggIT09IG51bGwpIHtcblx0ICAgICAgICByZXR2YWwgPSAncmdiYSgnICsgbWF0Y2guc2xpY2UoMSkuam9pbignLCcpICsgJyknO1xuXHQgICAgICAgIHJldHVybiByZXR2YWw7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBudWxsO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBQcm92aWRlcyB0aGUgY29ycmVjdCBzY2FsaW5nIHJhdGlvIGZvciBjYW52YXMgZHJhd2luZyBvcGVyYXRpb25zIG9uIEhpRFBJIHNjcmVlbnMgKGUuZy4gUmV0aW5hIGRpc3BsYXlzKVxuXHQgKi9cblx0ZXhwb3J0cy5jYW52YXNSYXRpbyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBkZXZpY2VQaXhlbFJhdGlvID0gMTtcblx0ICAgIHZhciBiYWNraW5nU3RvcmVSYXRpbyA9IDE7XG5cblx0ICAgIGlmIChnbG9iYWwuZG9jdW1lbnQpIHtcblx0ICAgICAgICB2YXIgY2FudmFzID0gZ2xvYmFsLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXHQgICAgICAgIGlmIChjYW52YXMuZ2V0Q29udGV4dCkge1xuXHQgICAgICAgICAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cdCAgICAgICAgICAgIGRldmljZVBpeGVsUmF0aW8gPSBnbG9iYWwuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuXHQgICAgICAgICAgICBiYWNraW5nU3RvcmVSYXRpbyA9IGN0eC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGN0eC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGN0eC5tc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgY3R4Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGN0eC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IDE7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAvIGJhY2tpbmdTdG9yZVJhdGlvO1xuXHR9O1xuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpXG5cbi8qKiovIH0sXG4vKiA4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7dmFyIERPTSA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cblx0dmFyIFNWR19OUyA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XG5cdHZhciBOT0RFX1RZUEVfQ09NTUVOVCA9IDg7XG5cblx0LyoqXG5cdCAqIEdlbmVyaWMgU1ZHIGVsZW1lbnQgY3JlYXRpb24gZnVuY3Rpb25cblx0ICpcblx0ICogQHBhcmFtIHN2ZyBTVkcgY29udGV4dCwgc2V0IHRvIG51bGwgaWYgbmV3XG5cdCAqIEBwYXJhbSB3aWR0aCBEb2N1bWVudCB3aWR0aFxuXHQgKiBAcGFyYW0gaGVpZ2h0IERvY3VtZW50IGhlaWdodFxuXHQgKi9cblx0ZXhwb3J0cy5pbml0U1ZHID0gZnVuY3Rpb24oc3ZnLCB3aWR0aCwgaGVpZ2h0KSB7XG5cdCAgICB2YXIgZGVmcywgc3R5bGUsIGluaXRpYWxpemUgPSBmYWxzZTtcblxuXHQgICAgaWYgKHN2ZyAmJiBzdmcucXVlcnlTZWxlY3Rvcikge1xuXHQgICAgICAgIHN0eWxlID0gc3ZnLnF1ZXJ5U2VsZWN0b3IoJ3N0eWxlJyk7XG5cdCAgICAgICAgaWYgKHN0eWxlID09PSBudWxsKSB7XG5cdCAgICAgICAgICAgIGluaXRpYWxpemUgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc3ZnID0gRE9NLm5ld0VsKCdzdmcnLCBTVkdfTlMpO1xuXHQgICAgICAgIGluaXRpYWxpemUgPSB0cnVlO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoaW5pdGlhbGl6ZSkge1xuXHQgICAgICAgIGRlZnMgPSBET00ubmV3RWwoJ2RlZnMnLCBTVkdfTlMpO1xuXHQgICAgICAgIHN0eWxlID0gRE9NLm5ld0VsKCdzdHlsZScsIFNWR19OUyk7XG5cdCAgICAgICAgRE9NLnNldEF0dHIoc3R5bGUsIHtcblx0ICAgICAgICAgICAgJ3R5cGUnOiAndGV4dC9jc3MnXG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgZGVmcy5hcHBlbmRDaGlsZChzdHlsZSk7XG5cdCAgICAgICAgc3ZnLmFwcGVuZENoaWxkKGRlZnMpO1xuXHQgICAgfVxuXG5cdCAgICAvL0lFIHRocm93cyBhbiBleGNlcHRpb24gaWYgdGhpcyBpcyBzZXQgYW5kIENocm9tZSByZXF1aXJlcyBpdCB0byBiZSBzZXRcblx0ICAgIGlmIChzdmcud2Via2l0TWF0Y2hlc1NlbGVjdG9yKSB7XG5cdCAgICAgICAgc3ZnLnNldEF0dHJpYnV0ZSgneG1sbnMnLCBTVkdfTlMpO1xuXHQgICAgfVxuXG5cdCAgICAvL1JlbW92ZSBjb21tZW50IG5vZGVzXG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN2Zy5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgaWYgKHN2Zy5jaGlsZE5vZGVzW2ldLm5vZGVUeXBlID09PSBOT0RFX1RZUEVfQ09NTUVOVCkge1xuXHQgICAgICAgICAgICBzdmcucmVtb3ZlQ2hpbGQoc3ZnLmNoaWxkTm9kZXNbaV0pO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgLy9SZW1vdmUgQ1NTXG5cdCAgICB3aGlsZSAoc3R5bGUuY2hpbGROb2Rlcy5sZW5ndGgpIHtcblx0ICAgICAgICBzdHlsZS5yZW1vdmVDaGlsZChzdHlsZS5jaGlsZE5vZGVzWzBdKTtcblx0ICAgIH1cblxuXHQgICAgRE9NLnNldEF0dHIoc3ZnLCB7XG5cdCAgICAgICAgJ3dpZHRoJzogd2lkdGgsXG5cdCAgICAgICAgJ2hlaWdodCc6IGhlaWdodCxcblx0ICAgICAgICAndmlld0JveCc6ICcwIDAgJyArIHdpZHRoICsgJyAnICsgaGVpZ2h0LFxuXHQgICAgICAgICdwcmVzZXJ2ZUFzcGVjdFJhdGlvJzogJ25vbmUnXG5cdCAgICB9KTtcblxuXHQgICAgcmV0dXJuIHN2Zztcblx0fTtcblxuXHQvKipcblx0ICogQ29udmVydHMgc2VyaWFsaXplZCBTVkcgdG8gYSBzdHJpbmcgc3VpdGFibGUgZm9yIGRhdGEgVVJJIHVzZVxuXHQgKiBAcGFyYW0gc3ZnU3RyaW5nIFNlcmlhbGl6ZWQgU1ZHIHN0cmluZ1xuXHQgKiBAcGFyYW0gW2Jhc2U2NF0gVXNlIGJhc2U2NCBlbmNvZGluZyBmb3IgZGF0YSBVUklcblx0ICovXG5cdGV4cG9ydHMuc3ZnU3RyaW5nVG9EYXRhVVJJID0gZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgcmF3UHJlZml4ID0gJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PVVURi04LCc7XG5cdCAgICB2YXIgYmFzZTY0UHJlZml4ID0gJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PVVURi04O2Jhc2U2NCwnO1xuXG5cdCAgICByZXR1cm4gZnVuY3Rpb24oc3ZnU3RyaW5nLCBiYXNlNjQpIHtcblx0ICAgICAgICBpZiAoYmFzZTY0KSB7XG5cdCAgICAgICAgICAgIHJldHVybiBiYXNlNjRQcmVmaXggKyBidG9hKGdsb2JhbC51bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3ZnU3RyaW5nKSkpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHJldHVybiByYXdQcmVmaXggKyBlbmNvZGVVUklDb21wb25lbnQoc3ZnU3RyaW5nKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHR9KCk7XG5cblx0LyoqXG5cdCAqIFJldHVybnMgc2VyaWFsaXplZCBTVkcgd2l0aCBYTUwgcHJvY2Vzc2luZyBpbnN0cnVjdGlvbnNcblx0ICpcblx0ICogQHBhcmFtIHN2ZyBTVkcgY29udGV4dFxuXHQgKiBAcGFyYW0gc3R5bGVzaGVldHMgQ1NTIHN0eWxlc2hlZXRzIHRvIGluY2x1ZGVcblx0ICovXG5cdGV4cG9ydHMuc2VyaWFsaXplU1ZHID0gZnVuY3Rpb24oc3ZnLCBlbmdpbmVTZXR0aW5ncykge1xuXHQgICAgaWYgKCFnbG9iYWwuWE1MU2VyaWFsaXplcikgcmV0dXJuO1xuXHQgICAgdmFyIHNlcmlhbGl6ZXIgPSBuZXcgWE1MU2VyaWFsaXplcigpO1xuXHQgICAgdmFyIHN2Z0NTUyA9ICcnO1xuXHQgICAgdmFyIHN0eWxlc2hlZXRzID0gZW5naW5lU2V0dGluZ3Muc3R5bGVzaGVldHM7XG5cblx0ICAgIC8vRXh0ZXJuYWwgc3R5bGVzaGVldHM6IFByb2Nlc3NpbmcgSW5zdHJ1Y3Rpb24gbWV0aG9kXG5cdCAgICBpZiAoZW5naW5lU2V0dGluZ3Muc3ZnWE1MU3R5bGVzaGVldCkge1xuXHQgICAgICAgIHZhciB4bWwgPSBET00uY3JlYXRlWE1MKCk7XG5cdCAgICAgICAgLy9BZGQgPD94bWwtc3R5bGVzaGVldCA/PiBkaXJlY3RpdmVzXG5cdCAgICAgICAgZm9yICh2YXIgaSA9IHN0eWxlc2hlZXRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdCAgICAgICAgICAgIHZhciBjc3NwaSA9IHhtbC5jcmVhdGVQcm9jZXNzaW5nSW5zdHJ1Y3Rpb24oJ3htbC1zdHlsZXNoZWV0JywgJ2hyZWY9XCInICsgc3R5bGVzaGVldHNbaV0gKyAnXCIgcmVsPVwic3R5bGVzaGVldFwiJyk7XG5cdCAgICAgICAgICAgIHhtbC5pbnNlcnRCZWZvcmUoY3NzcGksIHhtbC5maXJzdENoaWxkKTtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICB4bWwucmVtb3ZlQ2hpbGQoeG1sLmRvY3VtZW50RWxlbWVudCk7XG5cdCAgICAgICAgc3ZnQ1NTID0gc2VyaWFsaXplci5zZXJpYWxpemVUb1N0cmluZyh4bWwpO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgc3ZnVGV4dCA9IHNlcmlhbGl6ZXIuc2VyaWFsaXplVG9TdHJpbmcoc3ZnKTtcblx0ICAgIHN2Z1RleHQgPSBzdmdUZXh0LnJlcGxhY2UoL1xcJmFtcDsoXFwjWzAtOV17Mix9XFw7KS9nLCAnJiQxJyk7XG5cdCAgICByZXR1cm4gc3ZnQ1NTICsgc3ZnVGV4dDtcblx0fTtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpXG5cbi8qKiovIH0sXG4vKiA5ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7LyoqXG5cdCAqIEdlbmVyaWMgbmV3IERPTSBlbGVtZW50IGZ1bmN0aW9uXG5cdCAqXG5cdCAqIEBwYXJhbSB0YWcgVGFnIHRvIGNyZWF0ZVxuXHQgKiBAcGFyYW0gbmFtZXNwYWNlIE9wdGlvbmFsIG5hbWVzcGFjZSB2YWx1ZVxuXHQgKi9cblx0ZXhwb3J0cy5uZXdFbCA9IGZ1bmN0aW9uKHRhZywgbmFtZXNwYWNlKSB7XG5cdCAgICBpZiAoIWdsb2JhbC5kb2N1bWVudCkgcmV0dXJuO1xuXG5cdCAgICBpZiAobmFtZXNwYWNlID09IG51bGwpIHtcblx0ICAgICAgICByZXR1cm4gZ2xvYmFsLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIGdsb2JhbC5kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMobmFtZXNwYWNlLCB0YWcpO1xuXHQgICAgfVxuXHR9O1xuXG5cdC8qKlxuXHQgKiBHZW5lcmljIHNldEF0dHJpYnV0ZSBmdW5jdGlvblxuXHQgKlxuXHQgKiBAcGFyYW0gZWwgUmVmZXJlbmNlIHRvIERPTSBlbGVtZW50XG5cdCAqIEBwYXJhbSBhdHRycyBPYmplY3Qgd2l0aCBhdHRyaWJ1dGUga2V5cyBhbmQgdmFsdWVzXG5cdCAqL1xuXHRleHBvcnRzLnNldEF0dHIgPSBmdW5jdGlvbiAoZWwsIGF0dHJzKSB7XG5cdCAgICBmb3IgKHZhciBhIGluIGF0dHJzKSB7XG5cdCAgICAgICAgZWwuc2V0QXR0cmlidXRlKGEsIGF0dHJzW2FdKTtcblx0ICAgIH1cblx0fTtcblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIFhNTCBkb2N1bWVudFxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0ZXhwb3J0cy5jcmVhdGVYTUwgPSBmdW5jdGlvbigpIHtcblx0ICAgIGlmICghZ2xvYmFsLkRPTVBhcnNlcikgcmV0dXJuO1xuXHQgICAgcmV0dXJuIG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoJzx4bWwgLz4nLCAnYXBwbGljYXRpb24veG1sJyk7XG5cdH07XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgdmFsdWUgaW50byBhbiBhcnJheSBvZiBET00gbm9kZXNcblx0ICpcblx0ICogQHBhcmFtIHZhbCBBIHN0cmluZywgYSBOb2RlTGlzdCwgYSBOb2RlLCBvciBhbiBIVE1MQ29sbGVjdGlvblxuXHQgKi9cblx0ZXhwb3J0cy5nZXROb2RlQXJyYXkgPSBmdW5jdGlvbih2YWwpIHtcblx0ICAgIHZhciByZXR2YWwgPSBudWxsO1xuXHQgICAgaWYgKHR5cGVvZih2YWwpID09ICdzdHJpbmcnKSB7XG5cdCAgICAgICAgcmV0dmFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh2YWwpO1xuXHQgICAgfSBlbHNlIGlmIChnbG9iYWwuTm9kZUxpc3QgJiYgdmFsIGluc3RhbmNlb2YgZ2xvYmFsLk5vZGVMaXN0KSB7XG5cdCAgICAgICAgcmV0dmFsID0gdmFsO1xuXHQgICAgfSBlbHNlIGlmIChnbG9iYWwuTm9kZSAmJiB2YWwgaW5zdGFuY2VvZiBnbG9iYWwuTm9kZSkge1xuXHQgICAgICAgIHJldHZhbCA9IFt2YWxdO1xuXHQgICAgfSBlbHNlIGlmIChnbG9iYWwuSFRNTENvbGxlY3Rpb24gJiYgdmFsIGluc3RhbmNlb2YgZ2xvYmFsLkhUTUxDb2xsZWN0aW9uKSB7XG5cdCAgICAgICAgcmV0dmFsID0gdmFsO1xuXHQgICAgfSBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBBcnJheSkge1xuXHQgICAgICAgIHJldHZhbCA9IHZhbDtcblx0ICAgIH0gZWxzZSBpZiAodmFsID09PSBudWxsKSB7XG5cdCAgICAgICAgcmV0dmFsID0gW107XG5cdCAgICB9XG5cblx0ICAgIHJldHZhbCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHJldHZhbCk7XG5cblx0ICAgIHJldHVybiByZXR2YWw7XG5cdH07XG5cblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKVxuXG4vKioqLyB9LFxuLyogMTAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdHZhciBDb2xvciA9IGZ1bmN0aW9uKGNvbG9yLCBvcHRpb25zKSB7XG5cdCAgICAvL3RvZG86IHN1cHBvcnQgcmdiYSwgaHNsYSwgYW5kIHJyZ2diYmFhIG5vdGF0aW9uXG5cdCAgICAvL3RvZG86IHVzZSBDSUVMQUIgaW50ZXJuYWxseVxuXHQgICAgLy90b2RvOiBhZGQgY2xhbXAgZnVuY3Rpb24gKHdpdGggc2lnbilcblx0ICAgIGlmICh0eXBlb2YgY29sb3IgIT09ICdzdHJpbmcnKSByZXR1cm47XG5cblx0ICAgIHRoaXMub3JpZ2luYWwgPSBjb2xvcjtcblxuXHQgICAgaWYgKGNvbG9yLmNoYXJBdCgwKSA9PT0gJyMnKSB7XG5cdCAgICAgICAgY29sb3IgPSBjb2xvci5zbGljZSgxKTtcblx0ICAgIH1cblxuXHQgICAgaWYgKC9bXmEtZjAtOV0rL2kudGVzdChjb2xvcikpIHJldHVybjtcblxuXHQgICAgaWYgKGNvbG9yLmxlbmd0aCA9PT0gMykge1xuXHQgICAgICAgIGNvbG9yID0gY29sb3IucmVwbGFjZSgvLi9nLCAnJCYkJicpO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY29sb3IubGVuZ3RoICE9PSA2KSByZXR1cm47XG5cblx0ICAgIHRoaXMuYWxwaGEgPSAxO1xuXG5cdCAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmFscGhhKSB7XG5cdCAgICAgICAgdGhpcy5hbHBoYSA9IG9wdGlvbnMuYWxwaGE7XG5cdCAgICB9XG5cblx0ICAgIHRoaXMuc2V0KHBhcnNlSW50KGNvbG9yLCAxNikpO1xuXHR9O1xuXG5cdC8vdG9kbzoganNkb2NzXG5cdENvbG9yLnJnYjJoZXggPSBmdW5jdGlvbihyLCBnLCBiKSB7XG5cdCAgICBmdW5jdGlvbiBmb3JtYXQgKGRlY2ltYWwpIHtcblx0ICAgICAgICB2YXIgaGV4ID0gKGRlY2ltYWwgfCAwKS50b1N0cmluZygxNik7XG5cdCAgICAgICAgaWYgKGRlY2ltYWwgPCAxNikge1xuXHQgICAgICAgICAgICBoZXggPSAnMCcgKyBoZXg7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBoZXg7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBbciwgZywgYl0ubWFwKGZvcm1hdCkuam9pbignJyk7XG5cdH07XG5cblx0Ly90b2RvOiBqc2RvY3Ncblx0Q29sb3IuaHNsMnJnYiA9IGZ1bmN0aW9uIChoLCBzLCBsKSB7XG5cdCAgICB2YXIgSCA9IGggLyA2MDtcblx0ICAgIHZhciBDID0gKDEgLSBNYXRoLmFicygyICogbCAtIDEpKSAqIHM7XG5cdCAgICB2YXIgWCA9IEMgKiAoMSAtIE1hdGguYWJzKHBhcnNlSW50KEgpICUgMiAtIDEpKTtcblx0ICAgIHZhciBtID0gbCAtIChDIC8gMik7XG5cblx0ICAgIHZhciByID0gMCwgZyA9IDAsIGIgPSAwO1xuXG5cdCAgICBpZiAoSCA+PSAwICYmIEggPCAxKSB7XG5cdCAgICAgICAgciA9IEM7XG5cdCAgICAgICAgZyA9IFg7XG5cdCAgICB9IGVsc2UgaWYgKEggPj0gMSAmJiBIIDwgMikge1xuXHQgICAgICAgIHIgPSBYO1xuXHQgICAgICAgIGcgPSBDO1xuXHQgICAgfSBlbHNlIGlmIChIID49IDIgJiYgSCA8IDMpIHtcblx0ICAgICAgICBnID0gQztcblx0ICAgICAgICBiID0gWDtcblx0ICAgIH0gZWxzZSBpZiAoSCA+PSAzICYmIEggPCA0KSB7XG5cdCAgICAgICAgZyA9IFg7XG5cdCAgICAgICAgYiA9IEM7XG5cdCAgICB9IGVsc2UgaWYgKEggPj0gNCAmJiBIIDwgNSkge1xuXHQgICAgICAgIHIgPSBYO1xuXHQgICAgICAgIGIgPSBDO1xuXHQgICAgfSBlbHNlIGlmIChIID49IDUgJiYgSCA8IDYpIHtcblx0ICAgICAgICByID0gQztcblx0ICAgICAgICBiID0gWDtcblx0ICAgIH1cblxuXHQgICAgciArPSBtO1xuXHQgICAgZyArPSBtO1xuXHQgICAgYiArPSBtO1xuXG5cdCAgICByID0gcGFyc2VJbnQociAqIDI1NSk7XG5cdCAgICBnID0gcGFyc2VJbnQoZyAqIDI1NSk7XG5cdCAgICBiID0gcGFyc2VJbnQoYiAqIDI1NSk7XG5cblx0ICAgIHJldHVybiBbciwgZywgYl07XG5cdH07XG5cblx0LyoqXG5cdCAqIFNldHMgdGhlIGNvbG9yIGZyb20gYSByYXcgUkdCODg4IGludGVnZXJcblx0ICogQHBhcmFtIHJhdyBSR0I4ODggcmVwcmVzZW50YXRpb24gb2YgY29sb3Jcblx0ICovXG5cdC8vdG9kbzogcmVmYWN0b3IgaW50byBhIHN0YXRpYyBtZXRob2Rcblx0Ly90b2RvOiBmYWN0b3Igb3V0IGluZGl2aWR1YWwgY29sb3Igc3BhY2VzXG5cdC8vdG9kbzogYWRkIEhTTCwgQ0lFTEFCLCBhbmQgQ0lFTFVWXG5cdENvbG9yLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAodmFsKSB7XG5cdCAgICB0aGlzLnJhdyA9IHZhbDtcblxuXHQgICAgdmFyIHIgPSAodGhpcy5yYXcgJiAweEZGMDAwMCkgPj4gMTY7XG5cdCAgICB2YXIgZyA9ICh0aGlzLnJhdyAmIDB4MDBGRjAwKSA+PiA4O1xuXHQgICAgdmFyIGIgPSAodGhpcy5yYXcgJiAweDAwMDBGRik7XG5cblx0ICAgIC8vIEJULjcwOVxuXHQgICAgdmFyIHkgPSAwLjIxMjYgKiByICsgMC43MTUyICogZyArIDAuMDcyMiAqIGI7XG5cdCAgICB2YXIgdSA9IC0wLjA5OTkxICogciAtIDAuMzM2MDkgKiBnICsgMC40MzYgKiBiO1xuXHQgICAgdmFyIHYgPSAwLjYxNSAqIHIgLSAwLjU1ODYxICogZyAtIDAuMDU2MzkgKiBiO1xuXG5cdCAgICB0aGlzLnJnYiA9IHtcblx0ICAgICAgICByOiByLFxuXHQgICAgICAgIGc6IGcsXG5cdCAgICAgICAgYjogYlxuXHQgICAgfTtcblxuXHQgICAgdGhpcy55dXYgPSB7XG5cdCAgICAgICAgeTogeSxcblx0ICAgICAgICB1OiB1LFxuXHQgICAgICAgIHY6IHZcblx0ICAgIH07XG5cblx0ICAgIHJldHVybiB0aGlzO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBMaWdodGVuIG9yIGRhcmtlbiBhIGNvbG9yXG5cdCAqIEBwYXJhbSBtdWx0aXBsaWVyIEFtb3VudCB0byBsaWdodGVuIG9yIGRhcmtlbiAoLTEgdG8gMSlcblx0ICovXG5cdENvbG9yLnByb3RvdHlwZS5saWdodGVuID0gZnVuY3Rpb24obXVsdGlwbGllcikge1xuXHQgICAgdmFyIGNtID0gTWF0aC5taW4oMSwgTWF0aC5tYXgoMCwgTWF0aC5hYnMobXVsdGlwbGllcikpKSAqIChtdWx0aXBsaWVyIDwgMCA/IC0xIDogMSk7XG5cdCAgICB2YXIgYm0gPSAoMjU1ICogY20pIHwgMDtcblx0ICAgIHZhciBjciA9IE1hdGgubWluKDI1NSwgTWF0aC5tYXgoMCwgdGhpcy5yZ2IuciArIGJtKSk7XG5cdCAgICB2YXIgY2cgPSBNYXRoLm1pbigyNTUsIE1hdGgubWF4KDAsIHRoaXMucmdiLmcgKyBibSkpO1xuXHQgICAgdmFyIGNiID0gTWF0aC5taW4oMjU1LCBNYXRoLm1heCgwLCB0aGlzLnJnYi5iICsgYm0pKTtcblx0ICAgIHZhciBoZXggPSBDb2xvci5yZ2IyaGV4KGNyLCBjZywgY2IpO1xuXHQgICAgcmV0dXJuIG5ldyBDb2xvcihoZXgpO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBPdXRwdXQgY29sb3IgaW4gaGV4IGZvcm1hdFxuXHQgKiBAcGFyYW0gYWRkSGFzaCBBZGQgYSBoYXNoIGNoYXJhY3RlciB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBvdXRwdXRcblx0ICovXG5cdENvbG9yLnByb3RvdHlwZS50b0hleCA9IGZ1bmN0aW9uKGFkZEhhc2gpIHtcblx0ICAgIHJldHVybiAoYWRkSGFzaCA/ICcjJyA6ICcnKSArIHRoaXMucmF3LnRvU3RyaW5nKDE2KTtcblx0fTtcblxuXHQvKipcblx0ICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCBjdXJyZW50IGNvbG9yIGlzIGxpZ2h0ZXIgdGhhbiBhbm90aGVyIGNvbG9yXG5cdCAqIEBwYXJhbSBjb2xvciBDb2xvciB0byBjb21wYXJlIGFnYWluc3Rcblx0ICovXG5cdENvbG9yLnByb3RvdHlwZS5saWdodGVyVGhhbiA9IGZ1bmN0aW9uKGNvbG9yKSB7XG5cdCAgICBpZiAoIShjb2xvciBpbnN0YW5jZW9mIENvbG9yKSkge1xuXHQgICAgICAgIGNvbG9yID0gbmV3IENvbG9yKGNvbG9yKTtcblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIHRoaXMueXV2LnkgPiBjb2xvci55dXYueTtcblx0fTtcblxuXHQvKipcblx0ICogUmV0dXJucyB0aGUgcmVzdWx0IG9mIG1peGluZyBjdXJyZW50IGNvbG9yIHdpdGggYW5vdGhlciBjb2xvclxuXHQgKiBAcGFyYW0gY29sb3IgQ29sb3IgdG8gbWl4IHdpdGhcblx0ICogQHBhcmFtIG11bHRpcGxpZXIgSG93IG11Y2ggdG8gbWl4IHdpdGggdGhlIG90aGVyIGNvbG9yXG5cdCAqL1xuXHQvKlxuXHRDb2xvci5wcm90b3R5cGUubWl4ID0gZnVuY3Rpb24gKGNvbG9yLCBtdWx0aXBsaWVyKSB7XG5cdCAgICBpZiAoIShjb2xvciBpbnN0YW5jZW9mIENvbG9yKSkge1xuXHQgICAgICAgIGNvbG9yID0gbmV3IENvbG9yKGNvbG9yKTtcblx0ICAgIH1cblxuXHQgICAgdmFyIHIgPSB0aGlzLnJnYi5yO1xuXHQgICAgdmFyIGcgPSB0aGlzLnJnYi5nO1xuXHQgICAgdmFyIGIgPSB0aGlzLnJnYi5iO1xuXHQgICAgdmFyIGEgPSB0aGlzLmFscGhhO1xuXG5cdCAgICB2YXIgbSA9IHR5cGVvZiBtdWx0aXBsaWVyICE9PSAndW5kZWZpbmVkJyA/IG11bHRpcGxpZXIgOiAwLjU7XG5cblx0ICAgIC8vdG9kbzogd3JpdGUgYSBsZXJwIGZ1bmN0aW9uXG5cdCAgICByID0gciArIG0gKiAoY29sb3IucmdiLnIgLSByKTtcblx0ICAgIGcgPSBnICsgbSAqIChjb2xvci5yZ2IuZyAtIGcpO1xuXHQgICAgYiA9IGIgKyBtICogKGNvbG9yLnJnYi5iIC0gYik7XG5cdCAgICBhID0gYSArIG0gKiAoY29sb3IuYWxwaGEgLSBhKTtcblxuXHQgICAgcmV0dXJuIG5ldyBDb2xvcihDb2xvci5yZ2JUb0hleChyLCBnLCBiKSwge1xuXHQgICAgICAgICdhbHBoYSc6IGFcblx0ICAgIH0pO1xuXHR9O1xuXHQqL1xuXG5cdC8qKlxuXHQgKiBSZXR1cm5zIHRoZSByZXN1bHQgb2YgYmxlbmRpbmcgYW5vdGhlciBjb2xvciBvbiB0b3Agb2YgY3VycmVudCBjb2xvciB3aXRoIGFscGhhXG5cdCAqIEBwYXJhbSBjb2xvciBDb2xvciB0byBibGVuZCBvbiB0b3Agb2YgY3VycmVudCBjb2xvciwgaS5lLiBcIkNhXCJcblx0ICovXG5cdC8vdG9kbzogc2VlIGlmIC5ibGVuZEFscGhhIGNhbiBiZSBtZXJnZWQgaW50byAubWl4XG5cdENvbG9yLnByb3RvdHlwZS5ibGVuZEFscGhhID0gZnVuY3Rpb24oY29sb3IpIHtcblx0ICAgIGlmICghKGNvbG9yIGluc3RhbmNlb2YgQ29sb3IpKSB7XG5cdCAgICAgICAgY29sb3IgPSBuZXcgQ29sb3IoY29sb3IpO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgQ2EgPSBjb2xvcjtcblx0ICAgIHZhciBDYiA9IHRoaXM7XG5cblx0ICAgIC8vdG9kbzogd3JpdGUgYWxwaGEgYmxlbmRpbmcgZnVuY3Rpb25cblx0ICAgIHZhciByID0gQ2EuYWxwaGEgKiBDYS5yZ2IuciArICgxIC0gQ2EuYWxwaGEpICogQ2IucmdiLnI7XG5cdCAgICB2YXIgZyA9IENhLmFscGhhICogQ2EucmdiLmcgKyAoMSAtIENhLmFscGhhKSAqIENiLnJnYi5nO1xuXHQgICAgdmFyIGIgPSBDYS5hbHBoYSAqIENhLnJnYi5iICsgKDEgLSBDYS5hbHBoYSkgKiBDYi5yZ2IuYjtcblxuXHQgICAgcmV0dXJuIG5ldyBDb2xvcihDb2xvci5yZ2IyaGV4KHIsIGcsIGIpKTtcblx0fTtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IENvbG9yO1xuXG5cbi8qKiovIH0sXG4vKiAxMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSB7XG5cdCAgJ3ZlcnNpb24nOiAnMi45LjQnLFxuXHQgICdzdmdfbnMnOiAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnXG5cdH07XG5cbi8qKiovIH0sXG4vKiAxMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIHNoYXZlbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpO1xuXG5cdHZhciBTVkcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuXHR2YXIgY29uc3RhbnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7XG5cdHZhciB1dGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cblx0dmFyIFNWR19OUyA9IGNvbnN0YW50cy5zdmdfbnM7XG5cblx0dmFyIHRlbXBsYXRlcyA9IHtcblx0ICAnZWxlbWVudCc6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG5cdCAgICB2YXIgdGFnID0gb3B0aW9ucy50YWc7XG5cdCAgICB2YXIgY29udGVudCA9IG9wdGlvbnMuY29udGVudCB8fCAnJztcblx0ICAgIGRlbGV0ZSBvcHRpb25zLnRhZztcblx0ICAgIGRlbGV0ZSBvcHRpb25zLmNvbnRlbnQ7XG5cdCAgICByZXR1cm4gIFt0YWcsIGNvbnRlbnQsIG9wdGlvbnNdO1xuXHQgIH1cblx0fTtcblxuXHQvL3RvZG86IGRlcHJlY2F0ZSB0YWcgYXJnLCBpbmZlciB0YWcgZnJvbSBzaGFwZSBvYmplY3Rcblx0ZnVuY3Rpb24gY29udmVydFNoYXBlIChzaGFwZSwgdGFnKSB7XG5cdCAgcmV0dXJuIHRlbXBsYXRlcy5lbGVtZW50KHtcblx0ICAgICd0YWcnOiB0YWcsXG5cdCAgICAnd2lkdGgnOiBzaGFwZS53aWR0aCxcblx0ICAgICdoZWlnaHQnOiBzaGFwZS5oZWlnaHQsXG5cdCAgICAnZmlsbCc6IHNoYXBlLnByb3BlcnRpZXMuZmlsbFxuXHQgIH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gdGV4dENzcyAocHJvcGVydGllcykge1xuXHQgIHJldHVybiB1dGlscy5jc3NQcm9wcyh7XG5cdCAgICAnZmlsbCc6IHByb3BlcnRpZXMuZmlsbCxcblx0ICAgICdmb250LXdlaWdodCc6IHByb3BlcnRpZXMuZm9udC53ZWlnaHQsXG5cdCAgICAnZm9udC1mYW1pbHknOiBwcm9wZXJ0aWVzLmZvbnQuZmFtaWx5ICsgJywgbW9ub3NwYWNlJyxcblx0ICAgICdmb250LXNpemUnOiBwcm9wZXJ0aWVzLmZvbnQuc2l6ZSArIHByb3BlcnRpZXMuZm9udC51bml0c1xuXHQgIH0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gb3V0bGluZVBhdGggKGJnV2lkdGgsIGJnSGVpZ2h0LCBvdXRsaW5lV2lkdGgpIHtcblx0ICB2YXIgb3V0bGluZU9mZnNldFdpZHRoID0gb3V0bGluZVdpZHRoIC8gMjtcblxuXHQgIHJldHVybiBbXG5cdCAgICAnTScsIG91dGxpbmVPZmZzZXRXaWR0aCwgb3V0bGluZU9mZnNldFdpZHRoLFxuXHQgICAgJ0gnLCBiZ1dpZHRoIC0gb3V0bGluZU9mZnNldFdpZHRoLFxuXHQgICAgJ1YnLCBiZ0hlaWdodCAtIG91dGxpbmVPZmZzZXRXaWR0aCxcblx0ICAgICdIJywgb3V0bGluZU9mZnNldFdpZHRoLFxuXHQgICAgJ1YnLCAwLFxuXHQgICAgJ00nLCAwLCBvdXRsaW5lT2Zmc2V0V2lkdGgsXG5cdCAgICAnTCcsIGJnV2lkdGgsIGJnSGVpZ2h0IC0gb3V0bGluZU9mZnNldFdpZHRoLFxuXHQgICAgJ00nLCAwLCBiZ0hlaWdodCAtIG91dGxpbmVPZmZzZXRXaWR0aCxcblx0ICAgICdMJywgYmdXaWR0aCwgb3V0bGluZU9mZnNldFdpZHRoXG5cdCAgXS5qb2luKCcgJyk7XG5cdH1cblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChzY2VuZUdyYXBoLCByZW5kZXJTZXR0aW5ncykge1xuXHQgIHZhciBlbmdpbmVTZXR0aW5ncyA9IHJlbmRlclNldHRpbmdzLmVuZ2luZVNldHRpbmdzO1xuXHQgIHZhciBzdHlsZXNoZWV0cyA9IGVuZ2luZVNldHRpbmdzLnN0eWxlc2hlZXRzO1xuXHQgIHZhciBzdHlsZXNoZWV0WG1sID0gc3R5bGVzaGVldHMubWFwKGZ1bmN0aW9uIChzdHlsZXNoZWV0KSB7XG5cdCAgICByZXR1cm4gJzw/eG1sLXN0eWxlc2hlZXQgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCInICsgc3R5bGVzaGVldCArICdcIj8+Jztcblx0ICB9KS5qb2luKCdcXG4nKTtcblxuXHQgIHZhciBob2xkZXJJZCA9ICdob2xkZXJfJyArIE51bWJlcihuZXcgRGF0ZSgpKS50b1N0cmluZygxNik7XG5cblx0ICB2YXIgcm9vdCA9IHNjZW5lR3JhcGgucm9vdDtcblx0ICB2YXIgdGV4dEdyb3VwID0gcm9vdC5jaGlsZHJlbi5ob2xkZXJUZXh0R3JvdXA7XG5cblx0ICB2YXIgY3NzID0gJyMnICsgaG9sZGVySWQgKyAnIHRleHQgeyAnICsgdGV4dENzcyh0ZXh0R3JvdXAucHJvcGVydGllcykgKyAnIH0gJztcblxuXHQgIC8vIHB1c2ggdGV4dCBkb3duIHRvIGJlIGVxdWFsbHkgdmVydGljYWxseSBhbGlnbmVkIHdpdGggY2FudmFzIHJlbmRlcmVyXG5cdCAgdGV4dEdyb3VwLnkgKz0gdGV4dEdyb3VwLnRleHRQb3NpdGlvbkRhdGEuYm91bmRpbmdCb3guaGVpZ2h0ICogMC44O1xuXG5cdCAgdmFyIHdvcmRUYWdzID0gW107XG5cblx0ICBPYmplY3Qua2V5cyh0ZXh0R3JvdXAuY2hpbGRyZW4pLmZvckVhY2goZnVuY3Rpb24gKGxpbmVLZXkpIHtcblx0ICAgIHZhciBsaW5lID0gdGV4dEdyb3VwLmNoaWxkcmVuW2xpbmVLZXldO1xuXG5cdCAgICBPYmplY3Qua2V5cyhsaW5lLmNoaWxkcmVuKS5mb3JFYWNoKGZ1bmN0aW9uICh3b3JkS2V5KSB7XG5cdCAgICAgIHZhciB3b3JkID0gbGluZS5jaGlsZHJlblt3b3JkS2V5XTtcblx0ICAgICAgdmFyIHggPSB0ZXh0R3JvdXAueCArIGxpbmUueCArIHdvcmQueDtcblx0ICAgICAgdmFyIHkgPSB0ZXh0R3JvdXAueSArIGxpbmUueSArIHdvcmQueTtcblxuXHQgICAgICB2YXIgd29yZFRhZyA9IHRlbXBsYXRlcy5lbGVtZW50KHtcblx0ICAgICAgICAndGFnJzogJ3RleHQnLFxuXHQgICAgICAgICdjb250ZW50Jzogd29yZC5wcm9wZXJ0aWVzLnRleHQsXG5cdCAgICAgICAgJ3gnOiB4LFxuXHQgICAgICAgICd5JzogeVxuXHQgICAgICB9KTtcblxuXHQgICAgICB3b3JkVGFncy5wdXNoKHdvcmRUYWcpO1xuXHQgICAgfSk7XG5cdCAgfSk7XG5cblx0ICB2YXIgdGV4dCA9IHRlbXBsYXRlcy5lbGVtZW50KHtcblx0ICAgICd0YWcnOiAnZycsXG5cdCAgICAnY29udGVudCc6IHdvcmRUYWdzXG5cdCAgfSk7XG5cblx0ICB2YXIgb3V0bGluZSA9IG51bGw7XG5cblx0ICBpZiAocm9vdC5jaGlsZHJlbi5ob2xkZXJCZy5wcm9wZXJ0aWVzLm91dGxpbmUpIHtcblx0ICAgIHZhciBvdXRsaW5lUHJvcGVydGllcyA9IHJvb3QuY2hpbGRyZW4uaG9sZGVyQmcucHJvcGVydGllcy5vdXRsaW5lO1xuXHQgICAgb3V0bGluZSA9IHRlbXBsYXRlcy5lbGVtZW50KHtcblx0ICAgICAgJ3RhZyc6ICdwYXRoJyxcblx0ICAgICAgJ2QnOiBvdXRsaW5lUGF0aChyb290LmNoaWxkcmVuLmhvbGRlckJnLndpZHRoLCByb290LmNoaWxkcmVuLmhvbGRlckJnLmhlaWdodCwgb3V0bGluZVByb3BlcnRpZXMud2lkdGgpLFxuXHQgICAgICAnc3Ryb2tlLXdpZHRoJzogb3V0bGluZVByb3BlcnRpZXMud2lkdGgsXG5cdCAgICAgICdzdHJva2UnOiBvdXRsaW5lUHJvcGVydGllcy5maWxsLFxuXHQgICAgICAnZmlsbCc6ICdub25lJ1xuXHQgICAgfSk7XG5cdCAgfVxuXG5cdCAgdmFyIGJnID0gY29udmVydFNoYXBlKHJvb3QuY2hpbGRyZW4uaG9sZGVyQmcsICdyZWN0Jyk7XG5cblx0ICB2YXIgc2NlbmVDb250ZW50ID0gW107XG5cblx0ICBzY2VuZUNvbnRlbnQucHVzaChiZyk7XG5cdCAgaWYgKG91dGxpbmVQcm9wZXJ0aWVzKSB7XG5cdCAgICBzY2VuZUNvbnRlbnQucHVzaChvdXRsaW5lKTtcblx0ICB9XG5cdCAgc2NlbmVDb250ZW50LnB1c2godGV4dCk7XG5cblx0ICB2YXIgc2NlbmUgPSB0ZW1wbGF0ZXMuZWxlbWVudCh7XG5cdCAgICAndGFnJzogJ2cnLFxuXHQgICAgJ2lkJzogaG9sZGVySWQsXG5cdCAgICAnY29udGVudCc6IHNjZW5lQ29udGVudFxuXHQgIH0pO1xuXG5cdCAgdmFyIHN0eWxlID0gdGVtcGxhdGVzLmVsZW1lbnQoe1xuXHQgICAgJ3RhZyc6ICdzdHlsZScsXG5cdCAgICAvL3RvZG86IGZpZ3VyZSBvdXQgaG93IHRvIGFkZCBDREFUQSBkaXJlY3RpdmVcblx0ICAgICdjb250ZW50JzogY3NzLFxuXHQgICAgJ3R5cGUnOiAndGV4dC9jc3MnXG5cdCAgfSk7XG5cblx0ICB2YXIgZGVmcyA9IHRlbXBsYXRlcy5lbGVtZW50KHtcblx0ICAgICd0YWcnOiAnZGVmcycsXG5cdCAgICAnY29udGVudCc6IHN0eWxlXG5cdCAgfSk7XG5cblx0ICB2YXIgc3ZnID0gdGVtcGxhdGVzLmVsZW1lbnQoe1xuXHQgICAgJ3RhZyc6ICdzdmcnLFxuXHQgICAgJ2NvbnRlbnQnOiBbZGVmcywgc2NlbmVdLFxuXHQgICAgJ3dpZHRoJzogcm9vdC5wcm9wZXJ0aWVzLndpZHRoLFxuXHQgICAgJ2hlaWdodCc6IHJvb3QucHJvcGVydGllcy5oZWlnaHQsXG5cdCAgICAneG1sbnMnOiBTVkdfTlMsXG5cdCAgICAndmlld0JveCc6IFswLCAwLCByb290LnByb3BlcnRpZXMud2lkdGgsIHJvb3QucHJvcGVydGllcy5oZWlnaHRdLmpvaW4oJyAnKSxcblx0ICAgICdwcmVzZXJ2ZUFzcGVjdFJhdGlvJzogJ25vbmUnXG5cdCAgfSk7XG5cblx0ICB2YXIgb3V0cHV0ID0gc2hhdmVuKHN2Zyk7XG5cdCAgXG5cdCAgb3V0cHV0ID0gc3R5bGVzaGVldFhtbCArIG91dHB1dFswXTtcblxuXHQgIHZhciBzdmdTdHJpbmcgPSBTVkcuc3ZnU3RyaW5nVG9EYXRhVVJJKG91dHB1dCwgcmVuZGVyU2V0dGluZ3MubW9kZSA9PT0gJ2JhY2tncm91bmQnKTtcblx0ICByZXR1cm4gc3ZnU3RyaW5nO1xuXHR9O1xuXG4vKioqLyB9LFxuLyogMTMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBlc2NhcGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KVxuXG5cdC8vIFRPRE86IHJlbW92ZSBuYW1lc3BhY2VcblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNoYXZlbiAoYXJyYXksIG5hbWVzcGFjZSwgcmV0dXJuT2JqZWN0KSB7XG5cblx0XHQndXNlIHN0cmljdCdcblxuXHRcdHZhciBpID0gMVxuXHRcdHZhciBkb2VzRXNjYXBlID0gdHJ1ZVxuXHRcdHZhciBIVE1MU3RyaW5nXG5cdFx0dmFyIGF0dHJpYnV0ZUtleVxuXHRcdHZhciBjYWxsYmFja1xuXHRcdHZhciBrZXlcblxuXG5cdFx0cmV0dXJuT2JqZWN0ID0gcmV0dXJuT2JqZWN0IHx8IHt9XG5cblxuXHRcdGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQgKHN1Z2FyU3RyaW5nKSB7XG5cblx0XHRcdHZhciB0YWdzID0gc3VnYXJTdHJpbmcubWF0Y2goL15bXFx3LV0rLylcblx0XHRcdHZhciBlbGVtZW50ID0ge1xuXHRcdFx0XHR0YWc6IHRhZ3MgPyB0YWdzWzBdIDogJ2RpdicsXG5cdFx0XHRcdGF0dHI6IHt9LFxuXHRcdFx0XHRjaGlsZHJlbjogW11cblx0XHRcdH1cblx0XHRcdHZhciBpZCA9IHN1Z2FyU3RyaW5nLm1hdGNoKC8jKFtcXHctXSspLylcblx0XHRcdHZhciByZWZlcmVuY2UgPSBzdWdhclN0cmluZy5tYXRjaCgvXFwkKFtcXHctXSspLylcblx0XHRcdHZhciBjbGFzc05hbWVzID0gc3VnYXJTdHJpbmcubWF0Y2goL1xcLltcXHctXSsvZylcblxuXG5cdFx0XHQvLyBBc3NpZ24gaWQgaWYgaXMgc2V0XG5cdFx0XHRpZiAoaWQpIHtcblx0XHRcdFx0ZWxlbWVudC5hdHRyLmlkID0gaWRbMV1cblxuXHRcdFx0XHQvLyBBZGQgZWxlbWVudCB0byB0aGUgcmV0dXJuIG9iamVjdFxuXHRcdFx0XHRyZXR1cm5PYmplY3RbaWRbMV1dID0gZWxlbWVudFxuXHRcdFx0fVxuXG5cdFx0XHRpZiAocmVmZXJlbmNlKVxuXHRcdFx0XHRyZXR1cm5PYmplY3RbcmVmZXJlbmNlWzFdXSA9IGVsZW1lbnRcblxuXHRcdFx0aWYgKGNsYXNzTmFtZXMpXG5cdFx0XHRcdGVsZW1lbnQuYXR0ci5jbGFzcyA9IGNsYXNzTmFtZXMuam9pbignICcpLnJlcGxhY2UoL1xcLi9nLCAnJylcblxuXHRcdFx0aWYgKHN1Z2FyU3RyaW5nLm1hdGNoKC8mJC9nKSlcblx0XHRcdFx0ZG9lc0VzY2FwZSA9IGZhbHNlXG5cblx0XHRcdHJldHVybiBlbGVtZW50XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcmVwbGFjZXIgKGtleSwgdmFsdWUpIHtcblxuXHRcdFx0aWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSBmYWxzZSB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRyZXR1cm5cblxuXHRcdFx0aWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycgJiYgdHlwZW9mIHZhbHVlICE9PSAnb2JqZWN0Jylcblx0XHRcdFx0cmV0dXJuIFN0cmluZyh2YWx1ZSlcblxuXHRcdFx0cmV0dXJuIHZhbHVlXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZXNjYXBlQXR0cmlidXRlIChzdHJpbmcpIHtcblx0XHRcdHJldHVybiAoc3RyaW5nIHx8IHN0cmluZyA9PT0gMCkgP1xuXHRcdFx0XHRTdHJpbmcoc3RyaW5nKVxuXHRcdFx0XHRcdC5yZXBsYWNlKC8mL2csICcmYW1wOycpXG5cdFx0XHRcdFx0LnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKSA6XG5cdFx0XHRcdCcnXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZXNjYXBlSFRNTCAoc3RyaW5nKSB7XG5cdFx0XHRyZXR1cm4gU3RyaW5nKHN0cmluZylcblx0XHRcdFx0LnJlcGxhY2UoLyYvZywgJyZhbXA7Jylcblx0XHRcdFx0LnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKVxuXHRcdFx0XHQucmVwbGFjZSgvJy9nLCAnJmFwb3M7Jylcblx0XHRcdFx0LnJlcGxhY2UoLzwvZywgJyZsdDsnKVxuXHRcdFx0XHQucmVwbGFjZSgvPi9nLCAnJmd0OycpXG5cdFx0fVxuXG5cblx0XHRpZiAodHlwZW9mIGFycmF5WzBdID09PSAnc3RyaW5nJylcblx0XHRcdGFycmF5WzBdID0gY3JlYXRlRWxlbWVudChhcnJheVswXSlcblxuXHRcdGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoYXJyYXlbMF0pKVxuXHRcdFx0aSA9IDBcblxuXHRcdGVsc2Vcblx0XHRcdHRocm93IG5ldyBFcnJvcihcblx0XHRcdFx0J0ZpcnN0IGVsZW1lbnQgb2YgYXJyYXkgbXVzdCBiZSBhIHN0cmluZywgJyArXG5cdFx0XHRcdCdvciBhbiBhcnJheSBhbmQgbm90ICcgKyBKU09OLnN0cmluZ2lmeShhcnJheVswXSlcblx0XHRcdClcblxuXG5cdFx0Zm9yICg7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuXG5cdFx0XHQvLyBEb24ndCByZW5kZXIgZWxlbWVudCBpZiB2YWx1ZSBpcyBmYWxzZSBvciBudWxsXG5cdFx0XHRpZiAoYXJyYXlbaV0gPT09IGZhbHNlIHx8IGFycmF5W2ldID09PSBudWxsKSB7XG5cdFx0XHRcdGFycmF5WzBdID0gZmFsc2Vcblx0XHRcdFx0YnJlYWtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ29udGludWUgd2l0aCBuZXh0IGFycmF5IHZhbHVlIGlmIGN1cnJlbnQgdmFsdWUgaXMgdW5kZWZpbmVkIG9yIHRydWVcblx0XHRcdGVsc2UgaWYgKGFycmF5W2ldID09PSB1bmRlZmluZWQgfHwgYXJyYXlbaV0gPT09IHRydWUpIHtcblx0XHRcdFx0Y29udGludWVcblx0XHRcdH1cblxuXHRcdFx0ZWxzZSBpZiAodHlwZW9mIGFycmF5W2ldID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRpZiAoZG9lc0VzY2FwZSlcblx0XHRcdFx0XHRhcnJheVtpXSA9IGVzY2FwZUhUTUwoYXJyYXlbaV0pXG5cblx0XHRcdFx0YXJyYXlbMF0uY2hpbGRyZW4ucHVzaChhcnJheVtpXSlcblx0XHRcdH1cblxuXHRcdFx0ZWxzZSBpZiAodHlwZW9mIGFycmF5W2ldID09PSAnbnVtYmVyJykge1xuXG5cdFx0XHRcdGFycmF5WzBdLmNoaWxkcmVuLnB1c2goYXJyYXlbaV0pXG5cdFx0XHR9XG5cblx0XHRcdGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoYXJyYXlbaV0pKSB7XG5cblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoYXJyYXlbaV1bMF0pKSB7XG5cdFx0XHRcdFx0YXJyYXlbaV0ucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24gKHN1YkFycmF5KSB7XG5cdFx0XHRcdFx0XHRhcnJheS5zcGxpY2UoaSArIDEsIDAsIHN1YkFycmF5KVxuXHRcdFx0XHRcdH0pXG5cblx0XHRcdFx0XHRpZiAoaSAhPT0gMClcblx0XHRcdFx0XHRcdGNvbnRpbnVlXG5cdFx0XHRcdFx0aSsrXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzaGF2ZW4oYXJyYXlbaV0sIG5hbWVzcGFjZSwgcmV0dXJuT2JqZWN0KVxuXG5cdFx0XHRcdGlmIChhcnJheVtpXVswXSlcblx0XHRcdFx0XHRhcnJheVswXS5jaGlsZHJlbi5wdXNoKGFycmF5W2ldWzBdKVxuXHRcdFx0fVxuXG5cdFx0XHRlbHNlIGlmICh0eXBlb2YgYXJyYXlbaV0gPT09ICdmdW5jdGlvbicpXG5cdFx0XHRcdGNhbGxiYWNrID0gYXJyYXlbaV1cblxuXG5cdFx0XHRlbHNlIGlmICh0eXBlb2YgYXJyYXlbaV0gPT09ICdvYmplY3QnKSB7XG5cdFx0XHRcdGZvciAoYXR0cmlidXRlS2V5IGluIGFycmF5W2ldKVxuXHRcdFx0XHRcdGlmIChhcnJheVtpXS5oYXNPd25Qcm9wZXJ0eShhdHRyaWJ1dGVLZXkpKVxuXHRcdFx0XHRcdFx0aWYgKGFycmF5W2ldW2F0dHJpYnV0ZUtleV0gIT09IG51bGwgJiZcblx0XHRcdFx0XHRcdFx0YXJyYXlbaV1bYXR0cmlidXRlS2V5XSAhPT0gZmFsc2UpXG5cdFx0XHRcdFx0XHRcdGlmIChhdHRyaWJ1dGVLZXkgPT09ICdzdHlsZScgJiZcblx0XHRcdFx0XHRcdFx0XHR0eXBlb2YgYXJyYXlbaV1bYXR0cmlidXRlS2V5XSA9PT0gJ29iamVjdCcpXG5cdFx0XHRcdFx0XHRcdFx0YXJyYXlbMF0uYXR0clthdHRyaWJ1dGVLZXldID0gSlNPTlxuXHRcdFx0XHRcdFx0XHRcdFx0LnN0cmluZ2lmeShhcnJheVtpXVthdHRyaWJ1dGVLZXldLCByZXBsYWNlcilcblx0XHRcdFx0XHRcdFx0XHRcdC5zbGljZSgyLCAtMilcblx0XHRcdFx0XHRcdFx0XHRcdC5yZXBsYWNlKC9cIixcIi9nLCAnOycpXG5cdFx0XHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvXCI6XCIvZywgJzonKVxuXHRcdFx0XHRcdFx0XHRcdFx0LnJlcGxhY2UoL1xcXFxcIi9nLCAnXFwnJylcblxuXHRcdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdFx0YXJyYXlbMF0uYXR0clthdHRyaWJ1dGVLZXldID0gYXJyYXlbaV1bYXR0cmlidXRlS2V5XVxuXHRcdFx0fVxuXG5cdFx0XHRlbHNlXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ1wiJyArIGFycmF5W2ldICsgJ1wiIGlzIG5vdCBhbGxvd2VkIGFzIGEgdmFsdWUuJylcblx0XHR9XG5cblxuXHRcdGlmIChhcnJheVswXSAhPT0gZmFsc2UpIHtcblxuXHRcdFx0SFRNTFN0cmluZyA9ICc8JyArIGFycmF5WzBdLnRhZ1xuXG5cdFx0XHRmb3IgKGtleSBpbiBhcnJheVswXS5hdHRyKVxuXHRcdFx0XHRpZiAoYXJyYXlbMF0uYXR0ci5oYXNPd25Qcm9wZXJ0eShrZXkpKVxuXHRcdFx0XHRcdEhUTUxTdHJpbmcgKz0gJyAnICsga2V5ICsgJz1cIicgK1xuXHRcdFx0XHRcdFx0ZXNjYXBlQXR0cmlidXRlKGFycmF5WzBdLmF0dHJba2V5XSkgKyAnXCInXG5cblx0XHRcdEhUTUxTdHJpbmcgKz0gJz4nXG5cblx0XHRcdGFycmF5WzBdLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG5cdFx0XHRcdEhUTUxTdHJpbmcgKz0gY2hpbGRcblx0XHRcdH0pXG5cblx0XHRcdEhUTUxTdHJpbmcgKz0gJzwvJyArIGFycmF5WzBdLnRhZyArICc+J1xuXG5cdFx0XHRhcnJheVswXSA9IEhUTUxTdHJpbmdcblx0XHR9XG5cblx0XHQvLyBSZXR1cm4gcm9vdCBlbGVtZW50IG9uIGluZGV4IDBcblx0XHRyZXR1cm5PYmplY3RbMF0gPSBhcnJheVswXVxuXG5cdFx0aWYgKGNhbGxiYWNrKVxuXHRcdFx0Y2FsbGJhY2soYXJyYXlbMF0pXG5cblx0XHQvLyByZXR1cm5zIG9iamVjdCBjb250YWluaW5nIGFsbCBlbGVtZW50cyB3aXRoIGFuIGlkIGFuZCB0aGUgcm9vdCBlbGVtZW50XG5cdFx0cmV0dXJuIHJldHVybk9iamVjdFxuXHR9XG5cblxuLyoqKi8gfSxcbi8qIDE0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKiFcblx0ICogZXNjYXBlLWh0bWxcblx0ICogQ29weXJpZ2h0KGMpIDIwMTItMjAxMyBUSiBIb2xvd2F5Y2h1a1xuXHQgKiBDb3B5cmlnaHQoYykgMjAxNSBBbmRyZWFzIEx1YmJlXG5cdCAqIENvcHlyaWdodChjKSAyMDE1IFRpYW5jaGVuZyBcIlRpbW90aHlcIiBHdVxuXHQgKiBNSVQgTGljZW5zZWRcblx0ICovXG5cblx0J3VzZSBzdHJpY3QnO1xuXG5cdC8qKlxuXHQgKiBNb2R1bGUgdmFyaWFibGVzLlxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblxuXHR2YXIgbWF0Y2hIdG1sUmVnRXhwID0gL1tcIicmPD5dLztcblxuXHQvKipcblx0ICogTW9kdWxlIGV4cG9ydHMuXG5cdCAqIEBwdWJsaWNcblx0ICovXG5cblx0bW9kdWxlLmV4cG9ydHMgPSBlc2NhcGVIdG1sO1xuXG5cdC8qKlxuXHQgKiBFc2NhcGUgc3BlY2lhbCBjaGFyYWN0ZXJzIGluIHRoZSBnaXZlbiBzdHJpbmcgb2YgaHRtbC5cblx0ICpcblx0ICogQHBhcmFtICB7c3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byBlc2NhcGUgZm9yIGluc2VydGluZyBpbnRvIEhUTUxcblx0ICogQHJldHVybiB7c3RyaW5nfVxuXHQgKiBAcHVibGljXG5cdCAqL1xuXG5cdGZ1bmN0aW9uIGVzY2FwZUh0bWwoc3RyaW5nKSB7XG5cdCAgdmFyIHN0ciA9ICcnICsgc3RyaW5nO1xuXHQgIHZhciBtYXRjaCA9IG1hdGNoSHRtbFJlZ0V4cC5leGVjKHN0cik7XG5cblx0ICBpZiAoIW1hdGNoKSB7XG5cdCAgICByZXR1cm4gc3RyO1xuXHQgIH1cblxuXHQgIHZhciBlc2NhcGU7XG5cdCAgdmFyIGh0bWwgPSAnJztcblx0ICB2YXIgaW5kZXggPSAwO1xuXHQgIHZhciBsYXN0SW5kZXggPSAwO1xuXG5cdCAgZm9yIChpbmRleCA9IG1hdGNoLmluZGV4OyBpbmRleCA8IHN0ci5sZW5ndGg7IGluZGV4KyspIHtcblx0ICAgIHN3aXRjaCAoc3RyLmNoYXJDb2RlQXQoaW5kZXgpKSB7XG5cdCAgICAgIGNhc2UgMzQ6IC8vIFwiXG5cdCAgICAgICAgZXNjYXBlID0gJyZxdW90Oyc7XG5cdCAgICAgICAgYnJlYWs7XG5cdCAgICAgIGNhc2UgMzg6IC8vICZcblx0ICAgICAgICBlc2NhcGUgPSAnJmFtcDsnO1xuXHQgICAgICAgIGJyZWFrO1xuXHQgICAgICBjYXNlIDM5OiAvLyAnXG5cdCAgICAgICAgZXNjYXBlID0gJyYjMzk7Jztcblx0ICAgICAgICBicmVhaztcblx0ICAgICAgY2FzZSA2MDogLy8gPFxuXHQgICAgICAgIGVzY2FwZSA9ICcmbHQ7Jztcblx0ICAgICAgICBicmVhaztcblx0ICAgICAgY2FzZSA2MjogLy8gPlxuXHQgICAgICAgIGVzY2FwZSA9ICcmZ3Q7Jztcblx0ICAgICAgICBicmVhaztcblx0ICAgICAgZGVmYXVsdDpcblx0ICAgICAgICBjb250aW51ZTtcblx0ICAgIH1cblxuXHQgICAgaWYgKGxhc3RJbmRleCAhPT0gaW5kZXgpIHtcblx0ICAgICAgaHRtbCArPSBzdHIuc3Vic3RyaW5nKGxhc3RJbmRleCwgaW5kZXgpO1xuXHQgICAgfVxuXG5cdCAgICBsYXN0SW5kZXggPSBpbmRleCArIDE7XG5cdCAgICBodG1sICs9IGVzY2FwZTtcblx0ICB9XG5cblx0ICByZXR1cm4gbGFzdEluZGV4ICE9PSBpbmRleFxuXHQgICAgPyBodG1sICsgc3RyLnN1YnN0cmluZyhsYXN0SW5kZXgsIGluZGV4KVxuXHQgICAgOiBodG1sO1xuXHR9XG5cblxuLyoqKi8gfSxcbi8qIDE1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgRE9NID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0dmFyIHV0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcblx0ICAgIHZhciBjYW52YXMgPSBET00ubmV3RWwoJ2NhbnZhcycpO1xuXHQgICAgdmFyIGN0eCA9IG51bGw7XG5cblx0ICAgIHJldHVybiBmdW5jdGlvbihzY2VuZUdyYXBoKSB7XG5cdCAgICAgICAgaWYgKGN0eCA9PSBudWxsKSB7XG5cdCAgICAgICAgICAgIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHZhciBkcHIgPSB1dGlscy5jYW52YXNSYXRpbygpO1xuXHQgICAgICAgIHZhciByb290ID0gc2NlbmVHcmFwaC5yb290O1xuXHQgICAgICAgIGNhbnZhcy53aWR0aCA9IGRwciAqIHJvb3QucHJvcGVydGllcy53aWR0aDtcblx0ICAgICAgICBjYW52YXMuaGVpZ2h0ID0gZHByICogcm9vdC5wcm9wZXJ0aWVzLmhlaWdodCA7XG5cdCAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9ICdtaWRkbGUnO1xuXG5cdCAgICAgICAgdmFyIGJnID0gcm9vdC5jaGlsZHJlbi5ob2xkZXJCZztcblx0ICAgICAgICB2YXIgYmdXaWR0aCA9IGRwciAqIGJnLndpZHRoO1xuXHQgICAgICAgIHZhciBiZ0hlaWdodCA9IGRwciAqIGJnLmhlaWdodDtcblx0ICAgICAgICAvL3RvZG86IHBhcmFtZXRyaXplIG91dGxpbmUgd2lkdGggKGUuZy4gaW4gc2NlbmUgb2JqZWN0KVxuXHQgICAgICAgIHZhciBvdXRsaW5lV2lkdGggPSAyO1xuXHQgICAgICAgIHZhciBvdXRsaW5lT2Zmc2V0V2lkdGggPSBvdXRsaW5lV2lkdGggLyAyO1xuXG5cdCAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGJnLnByb3BlcnRpZXMuZmlsbDtcblx0ICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgYmdXaWR0aCwgYmdIZWlnaHQpO1xuXG5cdCAgICAgICAgaWYgKGJnLnByb3BlcnRpZXMub3V0bGluZSkge1xuXHQgICAgICAgICAgICAvL3RvZG86IGFic3RyYWN0IHRoaXMgaW50byBhIG1ldGhvZFxuXHQgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBiZy5wcm9wZXJ0aWVzLm91dGxpbmUuZmlsbDtcblx0ICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IGJnLnByb3BlcnRpZXMub3V0bGluZS53aWR0aDtcblx0ICAgICAgICAgICAgY3R4Lm1vdmVUbyhvdXRsaW5lT2Zmc2V0V2lkdGgsIG91dGxpbmVPZmZzZXRXaWR0aCk7XG5cdCAgICAgICAgICAgIC8vIFRMLCBUUiwgQlIsIEJMXG5cdCAgICAgICAgICAgIGN0eC5saW5lVG8oYmdXaWR0aCAtIG91dGxpbmVPZmZzZXRXaWR0aCwgb3V0bGluZU9mZnNldFdpZHRoKTtcblx0ICAgICAgICAgICAgY3R4LmxpbmVUbyhiZ1dpZHRoIC0gb3V0bGluZU9mZnNldFdpZHRoLCBiZ0hlaWdodCAtIG91dGxpbmVPZmZzZXRXaWR0aCk7XG5cdCAgICAgICAgICAgIGN0eC5saW5lVG8ob3V0bGluZU9mZnNldFdpZHRoLCBiZ0hlaWdodCAtIG91dGxpbmVPZmZzZXRXaWR0aCk7XG5cdCAgICAgICAgICAgIGN0eC5saW5lVG8ob3V0bGluZU9mZnNldFdpZHRoLCBvdXRsaW5lT2Zmc2V0V2lkdGgpO1xuXHQgICAgICAgICAgICAvLyBEaWFnb25hbHNcblx0ICAgICAgICAgICAgY3R4Lm1vdmVUbygwLCBvdXRsaW5lT2Zmc2V0V2lkdGgpO1xuXHQgICAgICAgICAgICBjdHgubGluZVRvKGJnV2lkdGgsIGJnSGVpZ2h0IC0gb3V0bGluZU9mZnNldFdpZHRoKTtcblx0ICAgICAgICAgICAgY3R4Lm1vdmVUbygwLCBiZ0hlaWdodCAtIG91dGxpbmVPZmZzZXRXaWR0aCk7XG5cdCAgICAgICAgICAgIGN0eC5saW5lVG8oYmdXaWR0aCwgb3V0bGluZU9mZnNldFdpZHRoKTtcblx0ICAgICAgICAgICAgY3R4LnN0cm9rZSgpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHZhciB0ZXh0R3JvdXAgPSByb290LmNoaWxkcmVuLmhvbGRlclRleHRHcm91cDtcblx0ICAgICAgICBjdHguZm9udCA9IHRleHRHcm91cC5wcm9wZXJ0aWVzLmZvbnQud2VpZ2h0ICsgJyAnICsgKGRwciAqIHRleHRHcm91cC5wcm9wZXJ0aWVzLmZvbnQuc2l6ZSkgKyB0ZXh0R3JvdXAucHJvcGVydGllcy5mb250LnVuaXRzICsgJyAnICsgdGV4dEdyb3VwLnByb3BlcnRpZXMuZm9udC5mYW1pbHkgKyAnLCBtb25vc3BhY2UnO1xuXHQgICAgICAgIGN0eC5maWxsU3R5bGUgPSB0ZXh0R3JvdXAucHJvcGVydGllcy5maWxsO1xuXG5cdCAgICAgICAgZm9yICh2YXIgbGluZUtleSBpbiB0ZXh0R3JvdXAuY2hpbGRyZW4pIHtcblx0ICAgICAgICAgICAgdmFyIGxpbmUgPSB0ZXh0R3JvdXAuY2hpbGRyZW5bbGluZUtleV07XG5cdCAgICAgICAgICAgIGZvciAodmFyIHdvcmRLZXkgaW4gbGluZS5jaGlsZHJlbikge1xuXHQgICAgICAgICAgICAgICAgdmFyIHdvcmQgPSBsaW5lLmNoaWxkcmVuW3dvcmRLZXldO1xuXHQgICAgICAgICAgICAgICAgdmFyIHggPSBkcHIgKiAodGV4dEdyb3VwLnggKyBsaW5lLnggKyB3b3JkLngpO1xuXHQgICAgICAgICAgICAgICAgdmFyIHkgPSBkcHIgKiAodGV4dEdyb3VwLnkgKyBsaW5lLnkgKyB3b3JkLnkgKyAodGV4dEdyb3VwLnByb3BlcnRpZXMubGVhZGluZyAvIDIpKTtcblxuXHQgICAgICAgICAgICAgICAgY3R4LmZpbGxUZXh0KHdvcmQucHJvcGVydGllcy50ZXh0LCB4LCB5KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHJldHVybiBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTtcblx0ICAgIH07XG5cdH0pKCk7XG5cbi8qKiovIH1cbi8qKioqKiovIF0pXG59KTtcbjtcbihmdW5jdGlvbihjdHgsIGlzTWV0ZW9yUGFja2FnZSkge1xuICAgIGlmIChpc01ldGVvclBhY2thZ2UpIHtcbiAgICAgICAgSG9sZGVyID0gY3R4LkhvbGRlcjtcbiAgICB9XG59KSh0aGlzLCB0eXBlb2YgTWV0ZW9yICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgUGFja2FnZSAhPT0gJ3VuZGVmaW5lZCcpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvaG9sZGVyanMvaG9sZGVyLmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///3\n")},function(module,exports,__webpack_require__){"use strict";eval("\n\n//=========================\n// BUTTON HANDLERS\n//=========================\n$(document).ready(function () {\n\n    $('.books__status-wrapper').on('click', function (e) {\n        e.stopPropagation();\n        var $this = this;\n        // console.log($this)\n        $($this).children('.books__status-options').addClass('books__status-options--active');\n    });\n\n    $('.books__status-options').on('click', function (tEvent) {\n        tEvent.stopPropagation();\n\n        var $this = this;\n        // console.log($this)\n        //get status that was passed on the button clicked\n        var tempStatus = tEvent.target.dataset.status;\n\n        console.log(tempStatus);\n        //define book(from the parent) and add status\n        var bookData = $($this).closest('.main__books-wrapper')[0].dataset.book;\n        var tempBook = JSON.parse(bookData);\n        addBookToUser(tempBook, tempStatus);\n\n        $($this).removeClass('books__status-options--active');\n    });\n\n    $('.nav__books-search-input').on('keydown', function (e) {\n        if (e.keyCode == 13) {\n            var query = e.target.value;\n            window.location.href = window.location.origin + '/search/' + query;\n        }\n    });\n});\n\n//=========================\n// POST TO SERVER\n//=========================\n//send book to the API\nfunction addBookToUser(tBook, tStatus) {\n    //set book status\n    tBook.status = tStatus;\n\n    //define post options\n    var tempPostOptions = { url: '/api/v1/books/addToUser', data: tBook, method: 'POST' };\n\n    //post to API\n    $.post(tempPostOptions).then(function (tempResults) {\n        console.log(tempResults);\n    });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3ByaXZhdGUvanMvc2VhcmNoLmpzPzY2NjUiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEJVVFRPTiBIQU5ETEVSU1xuLy89PT09PT09PT09PT09PT09PT09PT09PT09XG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG5cbiAgICAkKCcuYm9va3NfX3N0YXR1cy13cmFwcGVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdmFyICR0aGlzID0gdGhpcztcbiAgICAgICAgLy8gY29uc29sZS5sb2coJHRoaXMpXG4gICAgICAgICQoJHRoaXMpLmNoaWxkcmVuKCcuYm9va3NfX3N0YXR1cy1vcHRpb25zJykuYWRkQ2xhc3MoJ2Jvb2tzX19zdGF0dXMtb3B0aW9ucy0tYWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICAkKCcuYm9va3NfX3N0YXR1cy1vcHRpb25zJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKHRFdmVudCkge1xuICAgICAgICB0RXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgdmFyICR0aGlzID0gdGhpcztcbiAgICAgICAgLy8gY29uc29sZS5sb2coJHRoaXMpXG4gICAgICAgIC8vZ2V0IHN0YXR1cyB0aGF0IHdhcyBwYXNzZWQgb24gdGhlIGJ1dHRvbiBjbGlja2VkXG4gICAgICAgIHZhciB0ZW1wU3RhdHVzID0gdEV2ZW50LnRhcmdldC5kYXRhc2V0LnN0YXR1cztcblxuICAgICAgICBjb25zb2xlLmxvZyh0ZW1wU3RhdHVzKTtcbiAgICAgICAgLy9kZWZpbmUgYm9vayhmcm9tIHRoZSBwYXJlbnQpIGFuZCBhZGQgc3RhdHVzXG4gICAgICAgIHZhciBib29rRGF0YSA9ICQoJHRoaXMpLmNsb3Nlc3QoJy5tYWluX19ib29rcy13cmFwcGVyJylbMF0uZGF0YXNldC5ib29rO1xuICAgICAgICB2YXIgdGVtcEJvb2sgPSBKU09OLnBhcnNlKGJvb2tEYXRhKTtcbiAgICAgICAgYWRkQm9va1RvVXNlcih0ZW1wQm9vaywgdGVtcFN0YXR1cyk7XG5cbiAgICAgICAgJCgkdGhpcykucmVtb3ZlQ2xhc3MoJ2Jvb2tzX19zdGF0dXMtb3B0aW9ucy0tYWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICAkKCcubmF2X19ib29rcy1zZWFyY2gtaW5wdXQnKS5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gMTMpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB3aW5kb3cubG9jYXRpb24ub3JpZ2luICsgJy9zZWFyY2gvJyArIHF1ZXJ5O1xuICAgICAgICB9XG4gICAgfSk7XG59KTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQT1NUIFRPIFNFUlZFUlxuLy89PT09PT09PT09PT09PT09PT09PT09PT09XG4vL3NlbmQgYm9vayB0byB0aGUgQVBJXG5mdW5jdGlvbiBhZGRCb29rVG9Vc2VyKHRCb29rLCB0U3RhdHVzKSB7XG4gICAgLy9zZXQgYm9vayBzdGF0dXNcbiAgICB0Qm9vay5zdGF0dXMgPSB0U3RhdHVzO1xuXG4gICAgLy9kZWZpbmUgcG9zdCBvcHRpb25zXG4gICAgdmFyIHRlbXBQb3N0T3B0aW9ucyA9IHsgdXJsOiAnL2FwaS92MS9ib29rcy9hZGRUb1VzZXInLCBkYXRhOiB0Qm9vaywgbWV0aG9kOiAnUE9TVCcgfTtcblxuICAgIC8vcG9zdCB0byBBUElcbiAgICAkLnBvc3QodGVtcFBvc3RPcHRpb25zKS50aGVuKGZ1bmN0aW9uICh0ZW1wUmVzdWx0cykge1xuICAgICAgICBjb25zb2xlLmxvZyh0ZW1wUmVzdWx0cyk7XG4gICAgfSk7XG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9wcml2YXRlL2pzL3NlYXJjaC5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///4\n")},function(module,exports,__webpack_require__){"use strict";eval("\n\n//=========================\n// BUTTON HANDLERS\n//=========================\n$(document).ready(function () {\n    $(document).on(\"click\", \".books__image\", event, getUsers);\n    $(document).on(\"click\", \".books__image\", event, openSidebar);\n    $('.sidebar__button-close').on(\"click\", event, closeSidebar);\n});\n\n//=========================\n// GET TO SERVER\n//=========================\n//send bookid to the API\nfunction getUsers(tBookId) {\n    console.log(\"ive been clicked\");\n    var $this = this;\n\n    var id = $($this).attr('data-id');\n    var title = $($this).attr('data-title');\n    var author = $($this).attr('data-author');\n    var imgurl = $($this).attr('data-imgurl');\n\n    $.get({ url: \"/api/v1/users/\" + id }).then(function (results) {\n        console.log(results);\n\n        var $userId = $('.profile__main-name').attr('data-id');\n\n        var $sidebarHeading = $('.sidebar__heading');\n        var $bookWrapper = $('.sidebar__book-wrapper');\n        var $userWrapper = $('.sidebar__user-wrapper');\n\n        if (results.length > 0) {\n\n            var bookhtml = '';\n            var userhtml = '';\n\n            userhtml += \"\\n                    \\n                    \";\n\n            for (var index = 0; index < results.length; index++) {\n                var element = results[index];\n\n                if (element.id != $userId) {\n\n                    userhtml += \"\\n                            <div class=\\\"sidebar__profile-wrapper\\\">\\n                                <div class=\\\"sidebar__profile-avatar\\\">\\n                                    <img src='http://via.placeholder.com/150x200' alt=\\\"profile image\\\">\\n                                </div>\\n                                <div class=\\\"sidebar__profile-info\\\">\\n                                    <h3 class=\\\"sidebar__profile-name\\\">\" + element.user_name + \"</h3>\\n                                    <form action=\\\"/messages/\" + element.id + \"\\\">\\n                                        <button class=\\\"sidebar__profile-message\\\">Message</button>\\n                                    </form>\\n                                </div>\\n                            </div>\\n                            \";\n                }\n            }\n\n            $userWrapper.html(userhtml);\n            $sidebarHeading.children().remove();\n        } else {\n\n            var _$sidebarHeading = $('.sidebar__heading');\n\n            var html = \"\\n                        <h1>No users are currently reading this book</h1>\\n                    \";\n\n            $bookWrapper.children().remove();\n            $userWrapper.children().remove();\n            _$sidebarHeading.html(html);\n        }\n    });\n}\n\nfunction openSidebar() {\n    $('.main__books').addClass('main__books--active');\n    $('.sidebar__users').addClass('sidebar__users--active');\n    $('.sidebar__button-close').addClass('sidebar__button-close--visible');\n}\n\nfunction closeSidebar() {\n    $('.main__books').removeClass('main__books--active');\n    $('.sidebar__users').removeClass('sidebar__users--active');\n    $('.sidebar__button-close').removeClass('sidebar__button-close--visible');\n\n    $('.sidebar__heading').children().remove();\n    $('.sidebar__book-wrapper').children().remove();\n    $('.sidebar__user-wrapper').children().remove();\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3ByaXZhdGUvanMvZGFzaGJvYXJkLmpzP2EzYTUiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vPT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQlVUVE9OIEhBTkRMRVJTXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT1cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAkKGRvY3VtZW50KS5vbihcImNsaWNrXCIsIFwiLmJvb2tzX19pbWFnZVwiLCBldmVudCwgZ2V0VXNlcnMpO1xuICAgICQoZG9jdW1lbnQpLm9uKFwiY2xpY2tcIiwgXCIuYm9va3NfX2ltYWdlXCIsIGV2ZW50LCBvcGVuU2lkZWJhcik7XG4gICAgJCgnLnNpZGViYXJfX2J1dHRvbi1jbG9zZScpLm9uKFwiY2xpY2tcIiwgZXZlbnQsIGNsb3NlU2lkZWJhcik7XG59KTtcblxuLy89PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBHRVQgVE8gU0VSVkVSXG4vLz09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vc2VuZCBib29raWQgdG8gdGhlIEFQSVxuZnVuY3Rpb24gZ2V0VXNlcnModEJvb2tJZCkge1xuICAgIGNvbnNvbGUubG9nKFwiaXZlIGJlZW4gY2xpY2tlZFwiKTtcbiAgICB2YXIgJHRoaXMgPSB0aGlzO1xuXG4gICAgdmFyIGlkID0gJCgkdGhpcykuYXR0cignZGF0YS1pZCcpO1xuICAgIHZhciB0aXRsZSA9ICQoJHRoaXMpLmF0dHIoJ2RhdGEtdGl0bGUnKTtcbiAgICB2YXIgYXV0aG9yID0gJCgkdGhpcykuYXR0cignZGF0YS1hdXRob3InKTtcbiAgICB2YXIgaW1ndXJsID0gJCgkdGhpcykuYXR0cignZGF0YS1pbWd1cmwnKTtcblxuICAgICQuZ2V0KHsgdXJsOiBcIi9hcGkvdjEvdXNlcnMvXCIgKyBpZCB9KS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdHMpO1xuXG4gICAgICAgIHZhciAkdXNlcklkID0gJCgnLnByb2ZpbGVfX21haW4tbmFtZScpLmF0dHIoJ2RhdGEtaWQnKTtcblxuICAgICAgICB2YXIgJHNpZGViYXJIZWFkaW5nID0gJCgnLnNpZGViYXJfX2hlYWRpbmcnKTtcbiAgICAgICAgdmFyICRib29rV3JhcHBlciA9ICQoJy5zaWRlYmFyX19ib29rLXdyYXBwZXInKTtcbiAgICAgICAgdmFyICR1c2VyV3JhcHBlciA9ICQoJy5zaWRlYmFyX191c2VyLXdyYXBwZXInKTtcblxuICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGggPiAwKSB7XG5cbiAgICAgICAgICAgIHZhciBib29raHRtbCA9ICcnO1xuICAgICAgICAgICAgdmFyIHVzZXJodG1sID0gJyc7XG5cbiAgICAgICAgICAgIHVzZXJodG1sICs9IFwiXFxuICAgICAgICAgICAgICAgICAgICBcXG4gICAgICAgICAgICAgICAgICAgIFwiO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgcmVzdWx0cy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHJlc3VsdHNbaW5kZXhdO1xuXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuaWQgIT0gJHVzZXJJZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHVzZXJodG1sICs9IFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInNpZGViYXJfX3Byb2ZpbGUtd3JhcHBlclxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJzaWRlYmFyX19wcm9maWxlLWF2YXRhclxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9J2h0dHA6Ly92aWEucGxhY2Vob2xkZXIuY29tLzE1MHgyMDAnIGFsdD1cXFwicHJvZmlsZSBpbWFnZVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcInNpZGViYXJfX3Byb2ZpbGUtaW5mb1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzPVxcXCJzaWRlYmFyX19wcm9maWxlLW5hbWVcXFwiPlwiICsgZWxlbWVudC51c2VyX25hbWUgKyBcIjwvaDM+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGZvcm0gYWN0aW9uPVxcXCIvbWVzc2FnZXMvXCIgKyBlbGVtZW50LmlkICsgXCJcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVxcXCJzaWRlYmFyX19wcm9maWxlLW1lc3NhZ2VcXFwiPk1lc3NhZ2U8L2J1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Zvcm0+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJHVzZXJXcmFwcGVyLmh0bWwodXNlcmh0bWwpO1xuICAgICAgICAgICAgJHNpZGViYXJIZWFkaW5nLmNoaWxkcmVuKCkucmVtb3ZlKCk7XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIHZhciBfJHNpZGViYXJIZWFkaW5nID0gJCgnLnNpZGViYXJfX2hlYWRpbmcnKTtcblxuICAgICAgICAgICAgdmFyIGh0bWwgPSBcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxoMT5ObyB1c2VycyBhcmUgY3VycmVudGx5IHJlYWRpbmcgdGhpcyBib29rPC9oMT5cXG4gICAgICAgICAgICAgICAgICAgIFwiO1xuXG4gICAgICAgICAgICAkYm9va1dyYXBwZXIuY2hpbGRyZW4oKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICR1c2VyV3JhcHBlci5jaGlsZHJlbigpLnJlbW92ZSgpO1xuICAgICAgICAgICAgXyRzaWRlYmFySGVhZGluZy5odG1sKGh0bWwpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIG9wZW5TaWRlYmFyKCkge1xuICAgICQoJy5tYWluX19ib29rcycpLmFkZENsYXNzKCdtYWluX19ib29rcy0tYWN0aXZlJyk7XG4gICAgJCgnLnNpZGViYXJfX3VzZXJzJykuYWRkQ2xhc3MoJ3NpZGViYXJfX3VzZXJzLS1hY3RpdmUnKTtcbiAgICAkKCcuc2lkZWJhcl9fYnV0dG9uLWNsb3NlJykuYWRkQ2xhc3MoJ3NpZGViYXJfX2J1dHRvbi1jbG9zZS0tdmlzaWJsZScpO1xufVxuXG5mdW5jdGlvbiBjbG9zZVNpZGViYXIoKSB7XG4gICAgJCgnLm1haW5fX2Jvb2tzJykucmVtb3ZlQ2xhc3MoJ21haW5fX2Jvb2tzLS1hY3RpdmUnKTtcbiAgICAkKCcuc2lkZWJhcl9fdXNlcnMnKS5yZW1vdmVDbGFzcygnc2lkZWJhcl9fdXNlcnMtLWFjdGl2ZScpO1xuICAgICQoJy5zaWRlYmFyX19idXR0b24tY2xvc2UnKS5yZW1vdmVDbGFzcygnc2lkZWJhcl9fYnV0dG9uLWNsb3NlLS12aXNpYmxlJyk7XG5cbiAgICAkKCcuc2lkZWJhcl9faGVhZGluZycpLmNoaWxkcmVuKCkucmVtb3ZlKCk7XG4gICAgJCgnLnNpZGViYXJfX2Jvb2std3JhcHBlcicpLmNoaWxkcmVuKCkucmVtb3ZlKCk7XG4gICAgJCgnLnNpZGViYXJfX3VzZXItd3JhcHBlcicpLmNoaWxkcmVuKCkucmVtb3ZlKCk7XG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9wcml2YXRlL2pzL2Rhc2hib2FyZC5qc1xuLy8gbW9kdWxlIGlkID0gNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///5\n")}]);